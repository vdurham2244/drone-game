{"version":3,"file":"index-legacy-2437a3bb.js","sources":["../index.html?html-proxy&index=1.js"],"sourcesContent":["\n        import * as THREE from 'three';\n        \n        let gameLoaded = false;\n        let loadingErrors = [];\n        let resourcesLoaded = 0;\n        let totalResources = 4;\n\n        function updateLoadingProgress(progress) {\n            const loadingStatus = document.getElementById('loadingStatus');\n            if (loadingStatus) {\n                loadingStatus.textContent = Math.round(progress * 100) + '%';\n            }\n        }\n\n        function showError(title, details) {\n            const errorContainer = document.getElementById('errorContainer');\n            const errorTitle = document.getElementById('errorTitle');\n            const errorDetails = document.getElementById('errorDetails');\n            \n            loadingErrors.push({ title, details, time: new Date().toISOString() });\n            errorContainer.style.display = 'block';\n            errorTitle.textContent = title;\n            errorDetails.textContent = loadingErrors\n                .map(err => `[${err.time}]\\n${err.title}\\n${err.details}\\n`)\n                .join('\\n---\\n\\n');\n\n            const loadingProgress = document.getElementById('loadingProgress');\n            if (loadingProgress) {\n                loadingProgress.style.display = 'none';\n            }\n        }\n\n        window.retryLoading = function() {\n            if (!gameLoaded) {\n                loadingErrors = [];\n                document.getElementById('errorContainer').style.display = 'none';\n                document.getElementById('loadingProgress').style.display = 'block';\n                loadGame();\n            }\n        }\n\n        window.clearAndRetry = function() {\n            localStorage.clear();\n            sessionStorage.clear();\n            const cookies = document.cookie.split(\";\");\n            for (let i = 0; i < cookies.length; i++) {\n                const cookie = cookies[i];\n                const eqPos = cookie.indexOf(\"=\");\n                const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;\n                document.cookie = name + \"=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";\n            }\n            window.location.reload();\n        }\n\n        function checkWebGL() {\n            const canvas = document.createElement('canvas');\n            try {\n                const gl = canvas.getContext('webgl', { \n                    powerPreference: \"default\",\n                    failIfMajorPerformanceCaveat: false,\n                    antialias: false\n                });\n                if (!gl) return false;\n                return true;\n            } catch (e) {\n                return false;\n            }\n        }\n\n        async function loadGame() {\n            try {\n                if (!checkWebGL()) {\n                    showError('WebGL Error', 'WebGL is not supported or disabled in your browser');\n                    return;\n                }\n\n                // Load game script\n                const gameScript = document.createElement('script');\n                gameScript.type = 'module';\n                gameScript.src = import.meta.env.BASE_URL + 'main.js';\n                \n                gameScript.onerror = (error) => {\n                    console.error('Failed to load game script:', error);\n                    showError('Game Loading Error', 'Failed to load game script. Please check console for details.');\n                };\n                \n                gameScript.onload = () => {\n                    gameLoaded = true;\n                    document.getElementById('loadingProgress').style.display = 'none';\n                };\n                \n                document.body.appendChild(gameScript);\n            } catch (error) {\n                showError('Loading Error', error.message || 'Unknown error occurred');\n            }\n        }\n\n        // Start loading when everything is ready\n        window.addEventListener('load', () => {\n            try {\n                // Verify Three.js is available\n                if (typeof THREE === 'undefined') {\n                    throw new Error('Three.js failed t load');\n                }\n                loadGame();\n            } catch (error) {\n                showError('Loading Error', error.message || 'Failed to initialize game');\n            }\n        });\n\n        // Global error handlers\n        window.addEventListener('error', function(event) {\n            if (!gameLoaded) {\n                showError('JavaScript Error', `${event.message}\\nFile: ${event.filename}\\nLine: ${event.lineno}\\nColumn: ${event.colno}`);\n            }\n            return false;\n        });\n\n        window.addEventListener('unhandledrejection', function(event) {\n            if (!gameLoaded) {\n                showError('Loading Error', event.reason?.message || 'Unknown error occurred');\n            }\n        });\n    "],"names":["gameLoaded","loadingErrors","showError","title","details","errorContainer","document","getElementById","errorTitle","errorDetails","push","time","Date","toISOString","style","display","textContent","map","err","join","loadingProgress","async","loadGame","canvas","createElement","getContext","powerPreference","failIfMajorPerformanceCaveat","antialias","e","checkWebGL","gameScript","type","src","onerror","error","console","onload","body","appendChild","message","window","retryLoading","clearAndRetry","localStorage","clear","sessionStorage","cookies","cookie","split","i","length","eqPos","indexOf","name","substr","location","reload","addEventListener","THREE","Error","event","filename","lineno","colno","reason"],"mappings":"gIAGQ,IAAIA,GAAa,EACbC,EAAgB,GAWpB,SAASC,EAAUC,EAAOC,GACtB,MAAMC,EAAiBC,SAASC,eAAe,kBACzCC,EAAaF,SAASC,eAAe,cACrCE,EAAeH,SAASC,eAAe,gBAE7CN,EAAcS,KAAK,CAAEP,QAAOC,UAASO,MAAM,IAAIC,MAAOC,gBACtDR,EAAeS,MAAMC,QAAU,QAC/BP,EAAWQ,YAAcb,EACzBM,EAAaO,YAAcf,EACtBgB,KAAIC,GAAO,IAAIA,EAAIP,UAAUO,EAAIf,UAAUe,EAAId,cAC/Ce,KAAK,aAEV,MAAMC,EAAkBd,SAASC,eAAe,mBAC5Ca,IACAA,EAAgBN,MAAMC,QAAU,OAEvC,CAuCDM,eAAeC,IACX,IACI,IAjBR,WACI,MAAMC,EAASjB,SAASkB,cAAc,UACtC,IAMI,QALWD,EAAOE,WAAW,QAAS,CAClCC,gBAAiB,UACjBC,8BAA8B,EAC9BC,WAAW,GAMlB,CAFC,MAAOC,GACL,OAAO,CACV,CACJ,CAIYC,GAED,YADA5B,EAAU,cAAe,sDAK7B,MAAM6B,EAAazB,SAASkB,cAAc,UAC1CO,EAAWC,KAAO,SAClBD,EAAWE,IAAM,sBAEjBF,EAAWG,QAAWC,IAClBC,QAAQD,MAAM,8BAA+BA,GAC7CjC,EAAU,qBAAsB,gEAAgE,EAGpG6B,EAAWM,OAAS,KAChBrC,GAAa,EACbM,SAASC,eAAe,mBAAmBO,MAAMC,QAAU,MAAM,EAGrET,SAASgC,KAAKC,YAAYR,EAG7B,CAFC,MAAOI,GACLjC,EAAU,gBAAiBiC,EAAMK,SAAW,yBAC/C,CACJ,CA/DDC,OAAOC,aAAe,WACb1C,IACDC,EAAgB,GAChBK,SAASC,eAAe,kBAAkBO,MAAMC,QAAU,OAC1DT,SAASC,eAAe,mBAAmBO,MAAMC,QAAU,QAC3DO,IAEP,EAEDmB,OAAOE,cAAgB,WACnBC,aAAaC,QACbC,eAAeD,QACf,MAAME,EAAUzC,SAAS0C,OAAOC,MAAM,KACtC,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAQI,OAAQD,IAAK,CACrC,MAAMF,EAASD,EAAQG,GACjBE,EAAQJ,EAAOK,QAAQ,KACvBC,EAAOF,GAAS,EAAIJ,EAAOO,OAAO,EAAGH,GAASJ,EACpD1C,SAAS0C,OAASM,EAAO,yCAC5B,CACDb,OAAOe,SAASC,QACnB,EA8CDhB,OAAOiB,iBAAiB,QAAQ,KAC5B,IAEI,QAAqB,IAAVC,EACP,MAAU,IAAAC,MAAM,0BAEpBtC,GAGH,CAFC,MAAOa,GACLjC,EAAU,gBAAiBiC,EAAMK,SAAW,4BAC/C,KAILC,OAAOiB,iBAAiB,SAAS,SAASG,GAItC,OAHK7D,GACDE,EAAU,mBAAoB,GAAG2D,EAAMrB,kBAAkBqB,EAAMC,mBAAmBD,EAAME,mBAAmBF,EAAMG,UAE9G,CACnB,IAEQvB,OAAOiB,iBAAiB,sBAAsB,SAASG,GAC9C7D,GACDE,EAAU,gBAAiB2D,EAAMI,QAAQzB,SAAW,yBAEpE"}