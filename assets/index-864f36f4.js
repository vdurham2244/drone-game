var se=Object.defineProperty;var ie=(x,e,t)=>e in x?se(x,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):x[e]=t;var y=(x,e,t)=>(ie(x,typeof e!="symbol"?e+"":e,t),t);import{w as r,p as ne,G as W,ai as p,aj as d,ak as L,al as X,am as Z,an as K,s as z,ao as V,ap as re,C as ae,E as j,aq as le,ar as de,e as ce,as as pe,at as he,D as me,au as ye,O as U,S as we,P as Y,h as M,av as ue,aa as _,a9 as $,u as N,o as Q,aw as J,B as ee,A as te,ax as fe,j as ge,m as oe,r as be}from"./three-b237c980.js";import{O as Ce,D as Me,G as xe}from"./three-examples-3c8e45a0.js";function Ge(){import.meta.url,import("_").catch(()=>1);async function*x(){}}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();class A{constructor(e){y(this,"mesh");y(this,"dirtyLevel",100);y(this,"position");this.position=e}getMesh(){return this.mesh}clean(e){this.dirtyLevel=Math.max(0,this.dirtyLevel-e),this.mesh.traverse(t=>{t instanceof r&&t.material instanceof ne&&t.material.transparent&&(t.material.opacity=.3+this.dirtyLevel/100*.7)})}getDirtLevel(){return this.dirtyLevel}isClean(){return this.dirtyLevel===0}}class Se extends A{createMesh(){const e=new W,t=new r(new p(20,15,15),new d({color:16115411,transparent:!1,opacity:1})),n=new r(new p(21,1,16),new d({color:8092539}));n.position.y=-7.5;const o=new r(new p(8,8,12),new d({color:16115411,transparent:!1,opacity:1}));o.position.set(-14,-2,0);const s=o.clone();s.position.set(14,-2,0);const i=new r(new p(21,2,16),new d({color:0,transparent:!1,opacity:1}));i.position.y=7.5;const a=new d({color:16777215,transparent:!1,opacity:1}),l=new r(new p(.8,2,.5),a);l.position.set(-3,7,8.1),l.rotation.z=Math.PI*.1;const w=new r(new p(.8,2,.5),a);w.position.set(-2,7,8.1),w.rotation.z=-Math.PI*.1;const c=new r(new p(.8,2.5,.5),a);c.position.set(-.8,7,8.1),c.rotation.z=Math.PI*.1;const h=new r(new p(.8,1.5,.5),a);h.position.set(.2,6.5,8.1),h.rotation.z=-Math.PI*.1;const u=new r(new p(.8,1.5,.5),a);u.position.set(1.2,6.5,8.1),u.rotation.z=Math.PI*.1;const m=new r(new p(.8,2.5,.5),a);m.position.set(2.2,7,8.1),m.rotation.z=-Math.PI*.1;const b=new r(new p(.8,2.5,.5),a);b.position.set(3.8,7,8.1);const P=new r(new L(1,1.5,.5,16,1,!1,-Math.PI/2,Math.PI),a);P.rotation.x=Math.PI/2,P.rotation.y=Math.PI/2,P.position.set(3.8,7,8.1);const E=new p(9,2,13),k=new d({color:0}),v=new r(E,k);v.position.set(-14,2,0);const C=v.clone();C.position.set(14,2,0);const S=new p(2.5,4,.2),G=new d({color:11393254,transparent:!0,opacity:.7}),T=new p(3,4.5,.3),B=new d({color:16777215});[[-7,0,7.6],[-2.3,0,7.6],[2.3,0,7.6],[7,0,7.6],[-7,5,7.6],[-2.3,5,7.6],[2.3,5,7.6],[7,5,7.6],[-10.1,0,0],[-10.1,5,0],[10.1,0,0],[10.1,5,0],[-14,0,4],[-14,0,-4],[14,0,4],[14,0,-4]].forEach((I,R)=>{const D=new r(T,B),f=new r(S,G);D.position.set(I[0],I[1],I[2]),f.position.set(I[0],I[1],I[2]+.1),R>=8&&R<12&&(D.rotation.y=Math.PI/2,f.rotation.y=Math.PI/2),e.add(D),e.add(f)});const O=new r(new p(6,8,1),new d({color:16777215}));O.position.set(0,-2,7.6),e.add(t),e.add(n),e.add(o),e.add(s),e.add(i),e.add(v),e.add(C),e.add(O),e.add(l),e.add(w),e.add(c),e.add(h),e.add(u),e.add(m),e.add(b),e.add(P),e.position.copy(this.position),this.mesh=e}}class Pe extends A{createMesh(){const e=new W,t=new r(new p(10,8,16),new d({color:16119260,transparent:!0,opacity:1})),n=new r(new p(4,12,4),new d({color:15263976,transparent:!0,opacity:1}));n.position.set(0,10,-4);const o=new X(3,6,4),s=new r(o,new d({color:9127187,transparent:!0,opacity:1}));s.position.set(0,19,-4);const i=new r(new p(.4,2,.4),new d({color:16766720})),a=new r(new p(1.2,.4,.4),new d({color:16766720})),l=new W;l.add(i),l.add(a),l.position.set(0,23,-4);const w=new p(1.2,4,.2),c=new d({color:8900331,transparent:!0,opacity:.8});for(let v=-5;v<=5;v+=5){const C=new r(w,c);C.position.set(-5.1,0,v),C.rotation.y=Math.PI/2,e.add(C);const S=new r(w,c);S.position.set(5.1,0,v),S.rotation.y=Math.PI/2,e.add(S)}const h=new L(2,2,.2,16),u=new r(h,new d({color:8900331,transparent:!0,opacity:.8}));u.rotation.x=Math.PI/2,u.position.set(0,4,8.1);const m=new r(new p(4,6,.5),new d({color:9127187}));m.position.set(0,-1,8.1);const b=new r(new p(3.6,5.6,.2),new d({color:4863264}));b.position.set(0,-1,8.3);const P=new r(new p(6,1,2),new d({color:8421504}));P.position.set(0,-4,9);const E=new p(11,.5,17),k=new r(E,new d({color:9127187}));k.position.y=4.25,e.add(t),e.add(n),e.add(s),e.add(l),e.add(m),e.add(b),e.add(P),e.add(k),e.add(u),e.position.copy(this.position),this.mesh=e}}class ve extends A{createMesh(){const e=new W,t=new L(3,3,15,32),n=new r(t,new d({color:12632256,transparent:!0,opacity:1,shininess:100})),o=new X(3,4,32),s=new r(o,new d({color:12105912,transparent:!0,opacity:1,shininess:100}));s.position.y=9.5;const i=new Z(3.2,.3,16,32),a=new r(i,new d({color:8421504}));a.rotation.x=Math.PI/2,a.position.y=-7.5;const l=a.clone();l.position.y=7.5;const w=new L(3.5,4.5,2,8),c=new r(w,new d({color:6316128}));c.position.y=-8;for(let h=0;h<8;h++){const u=h/8*Math.PI*2,m=new p(.2,15,.2),b=new r(m,new d({color:11053224}));b.position.set(Math.cos(u)*3.1,0,Math.sin(u)*3.1),e.add(b)}e.add(n),e.add(s),e.add(a),e.add(l),e.add(c),e.position.copy(this.position),this.mesh=e}}class Le extends A{createMesh(){const e=new W,t=new p(12,40,12),n=new d({color:3100495,transparent:!0,opacity:1,shininess:100}),o=new r(t,n),s=new K(11,38),i=new d({color:4620980,transparent:!0,opacity:.6,shininess:100,side:z}),a=new r(s,i);a.position.set(0,0,6.01);const l=new r(s,i);l.position.set(0,0,-6.01),l.rotation.y=Math.PI;const w=new r(s,i);w.position.set(-6.01,0,0),w.rotation.y=-Math.PI/2;const c=new r(s,i);c.position.set(6.01,0,0),c.rotation.y=Math.PI/2;const h=12,u=3;for(let C=0;C<h;C++){const S=-18+C*u,G=new r(new p(12.1,.2,12.1),new d({color:4868682}));G.position.y=S,e.add(G)}[[-5.5,0,6],[5.5,0,6],[-5.5,0,-6],[5.5,0,-6],[-6,0,-5.5],[-6,0,5.5],[6,0,-5.5],[6,0,5.5]].forEach(C=>{const S=new r(new p(.3,40,.3),new d({color:3100495}));S.position.set(C[0],0,C[1]),e.add(S)});const b=new r(new p(13,1,13),new d({color:4868682,shininess:50}));b.position.y=20.5;const P=new r(new p(8,3,8),new d({color:3100495}));P.position.y=22;const E=new r(new p(8,4,2),new d({color:4868682}));E.position.set(0,-18,7);const k=new r(new p(8,.3,3),new d({color:3100495}));k.position.set(0,-16,7.5);const v=new r(new K(6,3.5),new d({color:4620980,transparent:!0,opacity:.8,side:z}));v.position.set(0,-18,8.1),e.add(o),e.add(a),e.add(l),e.add(w),e.add(c),e.add(b),e.add(P),e.add(E),e.add(k),e.add(v),e.position.copy(this.position),this.mesh=e}}class ke extends A{createMesh(){const e=new W,t=new L(4,4,6,32),n=new d({color:5263440,transparent:!0,opacity:1,shininess:60}),o=new r(t,n);o.position.y=15;const s=new V(4,32,16,0,Math.PI*2,0,Math.PI/2),i=new r(s,n);i.position.y=12;const a=new V(4,32,16,0,Math.PI*2,Math.PI/2,Math.PI/2),l=new r(a,n);l.position.y=18;const w=new X(4.5,2.5,32),c=new d({color:9109504,shininess:30}),h=new r(w,c);h.position.y=19.5;const u=new L(.8,.8,24,12),m=new d({color:3092271,shininess:30}),b=new r(u,m);b.position.y=0,[[-2.5,0,-2.5],[2.5,0,-2.5],[-2.5,0,2.5],[2.5,0,2.5]].forEach(f=>{const g=new r(new L(.4,.4,24,8),m);g.position.set(f[0],0,f[1]),e.add(g)}),[-6,-2,2,6,10].forEach(f=>{const g=new r(new Z(3.5,.2,16,32),m);g.rotation.x=Math.PI/2,g.position.y=f,e.add(g)});const k=new L(.15,.15,7.5,8);[-4,0,4,8].forEach(f=>{for(let g=0;g<Math.PI*2;g+=Math.PI/2){const H=new r(k,m);H.position.y=f,H.rotation.z=Math.PI/4,H.rotation.y=g,e.add(H);const q=new r(k,m);q.position.y=f,q.rotation.z=-Math.PI/4,q.rotation.y=g,e.add(q)}});const C=new L(4.5,4.5,.3,32),S=new r(C,m);S.position.y=11;const G=new Z(4.5,.05,8,32),T=new r(G,m);T.rotation.x=Math.PI/2,T.position.y=12;for(let f=0;f<Math.PI*2;f+=Math.PI/8){const g=new r(new L(.05,.05,1,4),m);g.position.set(4.5*Math.cos(f),11.5,4.5*Math.sin(f)),e.add(g)}const B=24,F=.6,O=1,I=new L(.05,.05,B,4),R=new r(I,m),D=new r(I,m);R.position.set(-F/2,B/2-12,4.2),D.position.set(F/2,B/2-12,4.2),e.add(R),e.add(D);for(let f=0;f<B;f+=O){const g=new r(new L(.025,.025,F,4),m);g.rotation.x=Math.PI/2,g.position.set(0,f-12,4.2),e.add(g)}e.add(o),e.add(i),e.add(l),e.add(h),e.add(b),e.add(S),e.add(T),e.position.copy(this.position),this.mesh=e}}class Ie{constructor(){y(this,"scene");y(this,"camera");y(this,"fpvCamera");y(this,"followCamera");y(this,"activeCamera");y(this,"renderer");y(this,"drone",null);y(this,"buildings",[]);y(this,"controls");y(this,"cleaningRadius",2);y(this,"cleaningPower",1);y(this,"isSprayOn",!1);y(this,"spraySystem",null);y(this,"propellers",[]);y(this,"propellerSpeed",1.1);y(this,"warningTimeout",null);y(this,"cameraMode","follow");y(this,"keysPressed",{});y(this,"lastFrameTime",performance.now());y(this,"logos",[]);y(this,"score",0);y(this,"hasWon",!1);y(this,"gameStarted",!1);y(this,"gameMode",null);y(this,"startScreenContainer",null);this.scene=new re,this.scene.background=new ae(8900331),this.camera=new j(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,15,30),this.fpvCamera=new j(90,window.innerWidth/window.innerHeight,.1,1e3),this.followCamera=new j(75,window.innerWidth/window.innerHeight,.1,1e3),this.activeCamera=this.followCamera,this.renderer=new le({antialias:!0,alpha:!0,powerPreference:"default"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=de,this.renderer.outputColorSpace=ce,this.renderer.toneMapping=pe,this.renderer.toneMappingExposure=1,document.body.appendChild(this.renderer.domElement),this.createStartScreen(),this.controls=new Ce(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.maxPolarAngle=Math.PI/2,this.controls.minDistance=5,this.controls.maxDistance=100,this.controls.enabled=!1,this.animate()}createStartScreen(){this.startScreenContainer=document.createElement("div"),this.startScreenContainer.style.position="fixed",this.startScreenContainer.style.top="0",this.startScreenContainer.style.left="0",this.startScreenContainer.style.width="100%",this.startScreenContainer.style.height="100%",this.startScreenContainer.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.startScreenContainer.style.display="flex",this.startScreenContainer.style.flexDirection="column",this.startScreenContainer.style.alignItems="center",this.startScreenContainer.style.justifyContent="center",this.startScreenContainer.style.zIndex="1000";const e=document.createElement("img");e.src="/drone-game/start.png",e.style.width="400px",e.style.marginBottom="40px",this.startScreenContainer.appendChild(e);const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="20px";const n=this.createModeButton("Learning Mode","Learn about Lucid Bots while flying the drone","learning");t.appendChild(n);const o=this.createModeButton("Speed Mode","Test your drone piloting skills","speed");t.appendChild(o),this.startScreenContainer.appendChild(t),document.body.appendChild(this.startScreenContainer)}createModeButton(e,t,n){const o=document.createElement("div");o.style.backgroundColor="#00B4D8",o.style.padding="20px 40px",o.style.borderRadius="10px",o.style.cursor="pointer",o.style.textAlign="center",o.style.transition="transform 0.2s, background-color 0.2s",o.style.width="400px";const s=document.createElement("h2");s.textContent=e,s.style.color="white",s.style.margin="0 0 10px 0",s.style.fontFamily="Arial, sans-serif";const i=document.createElement("p");return i.textContent=t,i.style.color="white",i.style.margin="0",i.style.fontFamily="Arial, sans-serif",o.appendChild(s),o.appendChild(i),o.onmouseover=()=>{o.style.backgroundColor="#0096B4",o.style.transform="scale(1.05)"},o.onmouseout=()=>{o.style.backgroundColor="#00B4D8",o.style.transform="scale(1)"},o.onclick=()=>this.startGame(n),o}startGame(e){this.gameMode=e,this.gameStarted=!0,this.startScreenContainer&&(document.body.removeChild(this.startScreenContainer),this.startScreenContainer=null),this.setupLighting(),this.setupControlsUI(),this.loadDroneModel(),this.addBuildings(),this.addGround(),this.addLogos(),this.updateScoreDisplay(),this.createWarningPopup(),window.addEventListener("resize",this.onWindowResize.bind(this)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),this.updateUIForGameMode()}updateUIForGameMode(){const e=document.getElementById("info");e&&(this.gameMode==="learning"?e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Learning Mode: Collect logos to learn about Lucid Bots!</p>\n                </div>\n            ':(e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Speed Mode: Collect all logos as fast as you can!</p>\n                    <p id="timer" style="margin: 5px 0 0 0;">Time: 0:00</p>\n                </div>\n            ',this.startSpeedModeTimer()))}startSpeedModeTimer(){if(this.gameMode!=="speed")return;const e=Date.now(),t=document.getElementById("timer"),n=()=>{if(!this.hasWon&&t){const o=Math.floor((Date.now()-e)/1e3),s=Math.floor(o/60),i=o%60;t.textContent="Time: ".concat(s,":").concat(i.toString().padStart(2,"0")),requestAnimationFrame(n)}};n()}setupLighting(){const e=new he(16777215,.6);this.scene.add(e);const t=new me(16777215,1);t.position.set(50,50,50),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.5,t.shadow.camera.far=500,this.scene.add(t);const n=new ye(16777215,4473924,.6);this.scene.add(n)}setupControlsUI(){let e=document.getElementById("info");e||(e=document.createElement("div"),e.id="info",document.body.appendChild(e)),e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.backgroundColor="rgba(0, 0, 0, 0.7)",e.style.color="white",e.style.padding="10px",e.style.borderRadius="8px",e.style.fontFamily="Arial, sans-serif",e.innerHTML='\n            <h3 style="margin:0; font-size:18px;">Game Controls</h3>\n            <ul style="list-style:none; padding:0; margin:5px 0;">\n                <li>Arrow Keys: Move Drone</li>\n                <li>A/D: Yaw Left/Right</li>\n                <li>W/S: Up/Down</li>\n                <li>Space: Toggle Sprayer</li>\n                <li>C: Clean (when sprayer is on)</li>\n                <li>V: Toggle Camera</li>\n                <li>Mouse: Orbit Camera (if enabled)</li>\n            </ul>\n            <p id="score-display" style="margin:0; font-weight:bold;">Score: 0/5 Logos Collected!</p>\n        '}loadDroneModel(){const e=new Me;e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/");const t=new xe;t.setDRACOLoader(e),console.log("Attempting to load drone model..."),t.load("/drone-game/sherpaModel.glb",n=>{if(console.log("Drone model loaded successfully:",n),n.scene){const o=new U,s=n.scene;s.rotation.x=-Math.PI/2,s.scale.set(.5,.5,.5),s.traverse(l=>{l instanceof r&&(l.castShadow=!0,l.receiveShadow=!0,l.material&&l.material.transparent&&(l.material.opacity=.9,l.material.side=z),(l.name.toLowerCase().includes("propeller")||l.name.toLowerCase().includes("prop")||l.name.toLowerCase().includes("rotor"))&&(console.log("Found propeller:",l.name),this.propellers.push(l)))}),o.add(s),o.position.set(0,5,0);const i=new we(16777215,1);i.position.set(0,.5,0),i.angle=Math.PI/6,i.penumbra=.5,i.decay=2,i.distance=10,o.add(i);const a=new Y(16777215,.5,5);o.add(a),this.drone=o,this.scene.add(this.drone),console.log("Drone added to scene at position:",this.drone.position),e.dispose()}else console.error("No scene found in the loaded model")},n=>{const o=Math.round(n.loaded/n.total*100);console.log("Loading progress: ".concat(o,"%"))},n=>{console.error("Error loading drone model:",n);const o=new U,s=new p(2,1,2),i=new d({color:3368703,transparent:!0,opacity:.8}),a=new r(s,i);o.add(a),o.position.set(0,5,0);const l=new Y(16777215,.5,10);o.add(l),this.drone=o,this.scene.add(this.drone),console.log("Fallback drone cube added to scene")})}addBuildings(){const e=new Se(new M(-20,3,-15));e.createMesh(),this.scene.add(e.getMesh()),this.buildings.push(e);const t=new Pe(new M(20,4,-15));t.createMesh(),this.scene.add(t.getMesh()),this.buildings.push(t);const n=new ve(new M(-20,8,15));n.createMesh(),this.scene.add(n.getMesh()),this.buildings.push(n);const o=new Le(new M(20,20,15));o.createMesh(),this.scene.add(o.getMesh()),this.buildings.push(o);const s=new ke(new M(-40,12,-35));s.createMesh(),this.scene.add(s.getMesh()),this.buildings.push(s)}addGround(){const e=new K(100,100),t=new d({color:9498256,side:z}),n=new r(e,t);n.rotation.x=-Math.PI/2,n.receiveShadow=!0,this.scene.add(n)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.fpvCamera.aspect=window.innerWidth/window.innerHeight,this.fpvCamera.updateProjectionMatrix(),this.followCamera.aspect=window.innerWidth/window.innerHeight,this.followCamera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(e){switch(this.keysPressed[e.key.toLowerCase()]=!0,e.key.toLowerCase()){case" ":this.isSprayOn=!this.isSprayOn,this.isSprayOn&&!this.spraySystem&&this.createSpraySystem();break;case"c":this.isSprayOn&&this.clean();break;case"v":this.toggleCamera();break}}onKeyUp(e){this.keysPressed[e.key.toLowerCase()]=!1}updateDroneMovement(e){if(!this.drone)return;const t=5,n=1.5,o=.8;this.keysPressed.a&&(this.drone.rotation.y+=n*e),this.keysPressed.d&&(this.drone.rotation.y-=n*e);let s=0,i=0;this.keysPressed.arrowdown&&(i-=1),this.keysPressed.arrowup&&(i+=1),this.keysPressed.arrowleft&&(s+=1),this.keysPressed.arrowright&&(s-=1),this.keysPressed.q&&(s-=1),this.keysPressed.e&&(s+=1);let a=0;this.keysPressed.w&&(a+=1),this.keysPressed.s&&(a-=1);const l=new M(s,0,i);l.length()>0&&(l.normalize(),l.multiplyScalar(t*e),l.applyEuler(new ue(0,this.drone.rotation.y,0)));const w=a*t*e,c=this.drone.position.clone();c.add(l),c.y=Math.max(2,c.y+w);const h=new _(c,o);let u=!1;for(const m of this.buildings){const b=m.getMesh();if(new $().setFromObject(b).intersectsSphere(h)){u=!0,this.showCollisionWarning();break}}u||this.drone.position.copy(c)}createSpraySystem(){if(!this.drone)return;const e=1500,t=new Float32Array(e*3),n=new N,o=new Q({color:35071,size:.12,transparent:!0,opacity:.8,blending:J});for(let i=0;i<e;i++){const a=i*3,l=i/e*25;t[a]=(Math.random()-.5)*(.4+l*.15),t[a+1]=(Math.random()-.5)*(.4+l*.15),t[a+2]=-l}n.setAttribute("position",new ee(t,3)),this.spraySystem=new te(n,o);const s=new U;s.rotation.x=-Math.PI,s.add(this.spraySystem),this.drone.add(s),this.spraySystem.position.set(-.15,0,0)}updateSpraySystem(){var n;if(!this.spraySystem)return;if(!this.isSprayOn){this.spraySystem.parent&&((n=this.drone)==null||n.remove(this.spraySystem.parent)),this.spraySystem.geometry.dispose(),this.spraySystem.material.dispose(),this.spraySystem=null;return}const e=this.spraySystem.geometry.attributes.position.array,t=e.length/3;for(let o=0;o<t;o++){const s=o*3;e[s+2]-=.3,e[s+2]<-10&&(e[s]=(Math.random()-.5)*.05,e[s+1]=(Math.random()-.5)*.05,e[s+2]=0),e[s]*=.99,e[s+1]*=.99}this.spraySystem.geometry.attributes.position.needsUpdate=!0}updateCameras(){if(this.drone){if(this.cameraMode==="fpv"){const e=new M;this.drone.getWorldPosition(e),this.fpvCamera.position.copy(e);const t=new M(-.15,.2,.15);t.applyQuaternion(this.drone.quaternion),this.fpvCamera.position.add(t),this.fpvCamera.rotation.set(0,this.drone.rotation.y+Math.PI,0)}if(this.cameraMode==="follow"){const e=new M;this.drone.getWorldPosition(e);const t=new M(0,1.5,-2);t.applyQuaternion(this.drone.quaternion),this.followCamera.position.copy(e).add(t);const n=new M(0,0,1);n.applyQuaternion(this.drone.quaternion);const o=e.clone().add(n);this.followCamera.lookAt(o)}}}checkCollisions(){if(!this.drone)return;const e=new M;this.drone.getWorldPosition(e);const t=new _(e,.5);for(const n of this.buildings){const o=n.getMesh();if(new $().setFromObject(o).intersectsSphere(t)){this.showCollisionWarning();break}}}animate(){if(requestAnimationFrame(this.animate.bind(this)),!this.gameStarted){this.renderer.render(this.scene,this.camera);return}const e=performance.now(),t=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e,this.propellers.length>0&&this.propellers.forEach((n,o)=>{const s=o%2===0?1:-1;n.rotation.y+=this.propellerSpeed*s}),this.updateDroneMovement(t),this.spraySystem&&this.updateSpraySystem(),this.updateCameras(),this.checkCollisions(),this.checkLogoCollection(),this.logos.forEach(n=>{if(!n.userData.collected){n.quaternion.copy(this.activeCamera.quaternion),n.rotateZ(n.userData.rotationSpeed);const o=Math.sin(e*.002)*.5;n.position.y=n.userData.initialY+o}}),this.controls.update(),this.renderer.render(this.scene,this.activeCamera)}clean(){!this.drone||!this.isSprayOn||this.buildings.forEach(e=>{const t=e.getMesh().position,n=this.drone.position;new M(t.x,t.y,t.z).distanceTo(n)<this.cleaningRadius&&e.clean(this.cleaningPower)})}toggleCamera(){switch(this.cameraMode){case"orbit":this.cameraMode="fpv",this.activeCamera=this.fpvCamera,this.controls.enabled=!1;break;case"fpv":this.cameraMode="follow",this.activeCamera=this.followCamera,this.controls.enabled=!1;break;case"follow":this.cameraMode="orbit",this.activeCamera=this.camera,this.controls.enabled=!0;break}}createWarningPopup(){if(!document.getElementById("warning-popup")){const e=document.createElement("div");e.id="warning-popup",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="rgba(255, 200, 200, 0.95)",e.style.padding="20px",e.style.borderRadius="10px",e.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",e.style.display="none",e.style.zIndex="1000",e.style.fontFamily="Arial, sans-serif",e.style.fontSize="16px",e.style.color="#333",e.style.border="2px solid #ff6b6b",e.style.maxWidth="400px",e.style.textAlign="center",document.body.appendChild(e)}}showCollisionWarning(){const e=document.getElementById("warning-popup");e&&e.style.display!=="block"&&(e.textContent="The Sherpa drone is built with a forward facing collision radar to prevent the drone from drifting into buildings",e.style.display="block",this.warningTimeout!==null&&window.clearTimeout(this.warningTimeout),this.warningTimeout=window.setTimeout(()=>{e&&(e.style.display="none"),this.warningTimeout=null},3e3))}checkLogoCollection(){if(!this.drone||!this.spraySystem||!this.isSprayOn||this.hasWon)return;const e=this.spraySystem.parent;if(!e)return;e.updateMatrixWorld();const t=e.matrixWorld,n=this.spraySystem.geometry.attributes.position.array,o=n.length/3,s=.5;this.logos.forEach(i=>{if(!i.userData.collected){const a=i.position.clone();for(let l=0;l<o;l++){const w=l*3;if(new M(n[w],n[w+1],n[w+2]).applyMatrix4(t).distanceTo(a)<s){i.userData.collected=!0,this.scene.remove(i),i.geometry.dispose(),i.material instanceof ne&&i.material.dispose(),this.score++,this.playCollectionEffect(i.position.clone()),this.updateScoreDisplay(),this.gameMode==="learning"&&i.userData.info&&this.showLearningPopup(i.userData.info),this.score>=5&&this.showWinMessage();break}}}})}playCollectionEffect(e){const n=new N,o=new Float32Array(50*3),s=[];for(let c=0;c<50;c++){const h=c*3;o[h]=e.x,o[h+1]=e.y,o[h+2]=e.z,s.push(new M((Math.random()-.5)*2,Math.random()*2,(Math.random()-.5)*2))}n.setAttribute("position",new ee(o,3));const i=new Q({color:16776960,size:.1,transparent:!0,opacity:1,blending:J}),a=new te(n,i);this.scene.add(a);let l=0;const w=()=>{if(l>1){this.scene.remove(a),n.dispose(),i.dispose();return}const c=n.attributes.position.array;for(let h=0;h<50;h++){const u=h*3;c[u]+=s[h].x*.1,c[u+1]+=s[h].y*.1,c[u+2]+=s[h].z*.1}n.attributes.position.needsUpdate=!0,i.opacity=1-l,l+=.05,requestAnimationFrame(w)};w()}updateScoreDisplay(){const e=document.getElementById("score-display");e&&(e.textContent="Score: ".concat(this.score,"/5 Logos Collected!"))}showWinMessage(){var l;this.hasWon=!0;const e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#00B4D8",e.style.padding="30px",e.style.borderRadius="15px",e.style.color="white",e.style.fontSize="24px",e.style.fontWeight="bold",e.style.textAlign="center",e.style.zIndex="1000",e.style.maxWidth="500px";const t=document.createElement("img");t.src="/drone-game/logo.png",t.style.width="120px",t.style.marginBottom="20px",e.appendChild(t);const n=document.createElement("div");n.style.marginBottom="20px";let o="Congratulations! You've collected all logos!";if(this.gameMode==="speed"){const w=document.getElementById("timer"),c=w?(l=w.textContent)==null?void 0:l.replace("Time: ",""):"0:00";o+="\nYour time: ".concat(c)}else this.gameMode==="learning"&&(o+="\n\nRemember:",n.innerHTML=o+'<br><br>"We believe in responsible robotics, paving the way to better lives for everyone.');n.style.lineHeight="1.4",this.gameMode==="speed"&&(n.textContent=o),e.appendChild(n);const s=document.createElement("div");s.style.fontSize="18px",s.style.marginTop="20px";const i=document.createElement("a");i.href="https://lucidbots.com",i.textContent="Visit lucidbots.com to learn more!",i.style.color="white",i.style.textDecoration="underline",i.target="_blank",s.appendChild(i),e.appendChild(s);const a=document.createElement("button");a.textContent="Play Again",a.style.marginTop="20px",a.style.padding="10px 20px",a.style.fontSize="18px",a.style.borderRadius="5px",a.style.border="none",a.style.backgroundColor="white",a.style.color="#00B4D8",a.style.cursor="pointer",a.style.transition="transform 0.2s",a.onmouseover=()=>a.style.transform="scale(1.05)",a.onmouseout=()=>a.style.transform="scale(1)",a.onclick=()=>window.location.reload(),e.appendChild(a),document.body.appendChild(e),setTimeout(()=>{document.body.removeChild(e)},1e4)}createLogo(){const e=new fe(1.5,32),n=new ge().load("/drone-game/logo.png");n.minFilter=oe,n.magFilter=oe;const o=new be({map:n,side:z,transparent:!0,opacity:1,emissive:16777215,emissiveMap:n,emissiveIntensity:.8}),s=new r(e,o),i=new Y(16777215,1,5);i.position.set(0,0,.1),s.add(i);const a=new Y(16777215,1,5);return a.position.set(0,0,-.1),s.add(a),s.userData={collected:!1,initialY:0,rotationSpeed:.02},s}addLogos(){const e=this.buildings[0],t=this.buildings[1],n=this.buildings[2],o=this.buildings[3],s=this.buildings[4];[{building:e,offsetY:18,offsetX:0,offsetZ:0,info:"Lucid Bots Inc. is an AI robotics company that builds productive and responsible robots for the exterior cleaning, concrete, and construction industries."},{building:t,offsetY:25,offsetX:0,offsetZ:0,info:"Our drones use advanced AI to learn and navigate complex environments safely."},{building:n,offsetY:16,offsetX:0,offsetZ:0,info:"Lucid Bots' Sherpa drone could clean any of these buildings in reality as well!"},{building:o,offsetY:30,offsetX:0,offsetZ:4,info:"Our mission at Lucid Bots is to elevate efficiency, safety, and humanity by creating the world's most productive drones."},{building:s,offsetY:22,offsetX:0,offsetZ:0,info:"We also have a surface cleaning robot, known as the Lavobot"}].forEach(({building:a,offsetY:l,offsetX:w,offsetZ:c,info:h})=>{const u=a.getMesh().position,m=this.createLogo();m.position.set(u.x+w,u.y+l,u.z+c),m.userData.initialY=u.y+l,m.userData.info=h,this.logos.push(m),this.scene.add(m)})}showLearningPopup(e){const t=document.createElement("div");t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(0, 180, 216, 0.95)",t.style.padding="20px",t.style.borderRadius="10px",t.style.boxShadow="0 0 20px rgba(0,0,0,0.3)",t.style.color="white",t.style.fontSize="18px",t.style.fontFamily="Arial, sans-serif",t.style.textAlign="center",t.style.maxWidth="400px",t.style.zIndex="1000",t.style.animation="fadeIn 0.3s ease-in-out";const n=document.createElement("style");n.textContent="\n            @keyframes fadeIn {\n                from { opacity: 0; transform: translate(-50%, -60%); }\n                to { opacity: 1; transform: translate(-50%, -50%); }\n            }\n        ",document.head.appendChild(n);const o=document.createElement("img");o.src="/drone-game/logo.png",o.style.width="100px",o.style.marginBottom="15px",t.appendChild(o);const s=document.createElement("p");s.textContent=e,s.style.margin="0",s.style.lineHeight="1.5",t.appendChild(s);const i=document.createElement("button");i.textContent="Continue",i.style.marginTop="15px",i.style.padding="8px 20px",i.style.fontSize="16px",i.style.backgroundColor="white",i.style.color="#00B4D8",i.style.border="none",i.style.borderRadius="5px",i.style.cursor="pointer",i.style.transition="transform 0.2s",i.onmouseover=()=>i.style.transform="scale(1.05)",i.onmouseout=()=>i.style.transform="scale(1)",i.onclick=()=>document.body.removeChild(t),t.appendChild(i),document.body.appendChild(t)}}new Ie;export{Ge as __vite_legacy_guard};
//# sourceMappingURL=index-864f36f4.js.map
