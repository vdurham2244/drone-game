!function(){function e(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./three-legacy-995be470.js","./three-examples-legacy-c4db359c.js"],(function(t,n){"use strict";var o,s,i,a,r,d,l,c,h,p,y,w,m,u,g,f,b,M,C,x,v,S,P,I,k,E,L,D,z,W,T,B,A,F,O,R,H,j,Y,q;return{setters:[e=>{o=e.w,s=e.p,i=e.G,a=e.ai,r=e.aj,d=e.ak,l=e.al,c=e.am,h=e.an,p=e.s,y=e.ao,w=e.ap,m=e.C,u=e.E,g=e.aq,f=e.ar,b=e.e,M=e.as,C=e.at,x=e.D,v=e.au,S=e.O,P=e.S,I=e.P,k=e.h,E=e.av,L=e.aa,D=e.a9,z=e.u,W=e.o,T=e.aw,B=e.B,A=e.A,F=e.ax,O=e.j,R=e.m,H=e.r},e=>{j=e.O,Y=e.D,q=e.G}],execute:function(){class t{constructor(t){e(this,"mesh",void 0),e(this,"dirtyLevel",100),e(this,"position",void 0),this.position=t}getMesh(){return this.mesh}clean(e){this.dirtyLevel=Math.max(0,this.dirtyLevel-e),this.mesh.traverse((e=>{e instanceof o&&e.material instanceof s&&e.material.transparent&&(e.material.opacity=.3+this.dirtyLevel/100*.7)}))}getDirtLevel(){return this.dirtyLevel}isClean(){return 0===this.dirtyLevel}}class n extends t{createMesh(){const e=new i,t=new o(new a(20,15,15),new r({color:16115411,transparent:!1,opacity:1})),n=new o(new a(21,1,16),new r({color:8092539}));n.position.y=-7.5;const s=new o(new a(8,8,12),new r({color:16115411,transparent:!1,opacity:1}));s.position.set(-14,-2,0);const l=s.clone();l.position.set(14,-2,0);const c=new o(new a(21,2,16),new r({color:0,transparent:!1,opacity:1}));c.position.y=7.5;const h=new r({color:16777215,transparent:!1,opacity:1}),p=new o(new a(.8,2,.5),h);p.position.set(-3,7,8.1),p.rotation.z=.1*Math.PI;const y=new o(new a(.8,2,.5),h);y.position.set(-2,7,8.1),y.rotation.z=.1*-Math.PI;const w=new o(new a(.8,2.5,.5),h);w.position.set(-.8,7,8.1),w.rotation.z=.1*Math.PI;const m=new o(new a(.8,1.5,.5),h);m.position.set(.2,6.5,8.1),m.rotation.z=.1*-Math.PI;const u=new o(new a(.8,1.5,.5),h);u.position.set(1.2,6.5,8.1),u.rotation.z=.1*Math.PI;const g=new o(new a(.8,2.5,.5),h);g.position.set(2.2,7,8.1),g.rotation.z=.1*-Math.PI;const f=new o(new a(.8,2.5,.5),h);f.position.set(3.8,7,8.1);const b=new o(new d(1,1.5,.5,16,1,!1,-Math.PI/2,Math.PI),h);b.rotation.x=Math.PI/2,b.rotation.y=Math.PI/2,b.position.set(3.8,7,8.1);const M=new a(9,2,13),C=new r({color:0}),x=new o(M,C);x.position.set(-14,2,0);const v=x.clone();v.position.set(14,2,0);const S=new a(2.5,4,.2),P=new r({color:11393254,transparent:!0,opacity:.7}),I=new a(3,4.5,.3),k=new r({color:16777215});[[-7,0,7.6],[-2.3,0,7.6],[2.3,0,7.6],[7,0,7.6],[-7,5,7.6],[-2.3,5,7.6],[2.3,5,7.6],[7,5,7.6],[-10.1,0,0],[-10.1,5,0],[10.1,0,0],[10.1,5,0],[-14,0,4],[-14,0,-4],[14,0,4],[14,0,-4]].forEach(((t,n)=>{const s=new o(I,k),i=new o(S,P);s.position.set(t[0],t[1],t[2]),i.position.set(t[0],t[1],t[2]+.1),n>=8&&n<12&&(s.rotation.y=Math.PI/2,i.rotation.y=Math.PI/2),e.add(s),e.add(i)}));const E=new o(new a(6,8,1),new r({color:16777215}));E.position.set(0,-2,7.6),e.add(t),e.add(n),e.add(s),e.add(l),e.add(c),e.add(x),e.add(v),e.add(E),e.add(p),e.add(y),e.add(w),e.add(m),e.add(u),e.add(g),e.add(f),e.add(b),e.position.copy(this.position),this.mesh=e}}class G extends t{createMesh(){const e=new i,t=new o(new a(10,8,16),new r({color:16119260,transparent:!0,opacity:1})),n=new o(new a(4,12,4),new r({color:15263976,transparent:!0,opacity:1}));n.position.set(0,10,-4);const s=new l(3,6,4),c=new o(s,new r({color:9127187,transparent:!0,opacity:1}));c.position.set(0,19,-4);const h=new o(new a(.4,2,.4),new r({color:16766720})),p=new o(new a(1.2,.4,.4),new r({color:16766720})),y=new i;y.add(h),y.add(p),y.position.set(0,23,-4);const w=new a(1.2,4,.2),m=new r({color:8900331,transparent:!0,opacity:.8});for(let i=-5;i<=5;i+=5){const t=new o(w,m);t.position.set(-5.1,0,i),t.rotation.y=Math.PI/2,e.add(t);const n=new o(w,m);n.position.set(5.1,0,i),n.rotation.y=Math.PI/2,e.add(n)}const u=new d(2,2,.2,16),g=new o(u,new r({color:8900331,transparent:!0,opacity:.8}));g.rotation.x=Math.PI/2,g.position.set(0,4,8.1);const f=new o(new a(4,6,.5),new r({color:9127187}));f.position.set(0,-1,8.1);const b=new o(new a(3.6,5.6,.2),new r({color:4863264}));b.position.set(0,-1,8.3);const M=new o(new a(6,1,2),new r({color:8421504}));M.position.set(0,-4,9);const C=new a(11,.5,17),x=new o(C,new r({color:9127187}));x.position.y=4.25,e.add(t),e.add(n),e.add(c),e.add(y),e.add(f),e.add(b),e.add(M),e.add(x),e.add(g),e.position.copy(this.position),this.mesh=e}}class U extends t{createMesh(){const e=new i,t=new d(3,3,15,32),n=new o(t,new r({color:12632256,transparent:!0,opacity:1,shininess:100})),s=new l(3,4,32),h=new o(s,new r({color:12105912,transparent:!0,opacity:1,shininess:100}));h.position.y=9.5;const p=new c(3.2,.3,16,32),y=new o(p,new r({color:8421504}));y.rotation.x=Math.PI/2,y.position.y=-7.5;const w=y.clone();w.position.y=7.5;const m=new d(3.5,4.5,2,8),u=new o(m,new r({color:6316128}));u.position.y=-8;for(let i=0;i<8;i++){const t=i/8*Math.PI*2,n=new a(.2,15,.2),s=new o(n,new r({color:11053224}));s.position.set(3.1*Math.cos(t),0,3.1*Math.sin(t)),e.add(s)}e.add(n),e.add(h),e.add(y),e.add(w),e.add(u),e.position.copy(this.position),this.mesh=e}}class Z extends t{createMesh(){const e=new i,t=new a(12,40,12),n=new r({color:3100495,transparent:!0,opacity:1,shininess:100}),s=new o(t,n),d=new h(11,38),l=new r({color:4620980,transparent:!0,opacity:.6,shininess:100,side:p}),c=new o(d,l);c.position.set(0,0,6.01);const y=new o(d,l);y.position.set(0,0,-6.01),y.rotation.y=Math.PI;const w=new o(d,l);w.position.set(-6.01,0,0),w.rotation.y=-Math.PI/2;const m=new o(d,l);m.position.set(6.01,0,0),m.rotation.y=Math.PI/2;for(let i=0;i<12;i++){const t=3*i-18,n=new o(new a(12.1,.2,12.1),new r({color:4868682}));n.position.y=t,e.add(n)}[[-5.5,0,6],[5.5,0,6],[-5.5,0,-6],[5.5,0,-6],[-6,0,-5.5],[-6,0,5.5],[6,0,-5.5],[6,0,5.5]].forEach((t=>{const n=new o(new a(.3,40,.3),new r({color:3100495}));n.position.set(t[0],0,t[1]),e.add(n)}));const u=new o(new a(13,1,13),new r({color:4868682,shininess:50}));u.position.y=20.5;const g=new o(new a(8,3,8),new r({color:3100495}));g.position.y=22;const f=new o(new a(8,4,2),new r({color:4868682}));f.position.set(0,-18,7);const b=new o(new a(8,.3,3),new r({color:3100495}));b.position.set(0,-16,7.5);const M=new o(new h(6,3.5),new r({color:4620980,transparent:!0,opacity:.8,side:p}));M.position.set(0,-18,8.1),e.add(s),e.add(c),e.add(y),e.add(w),e.add(m),e.add(u),e.add(g),e.add(f),e.add(b),e.add(M),e.position.copy(this.position),this.mesh=e}}class X extends t{createMesh(){const e=new i,t=new d(4,4,6,32),n=new r({color:5263440,transparent:!0,opacity:1,shininess:60}),s=new o(t,n);s.position.y=15;const a=new y(4,32,16,0,2*Math.PI,0,Math.PI/2),h=new o(a,n);h.position.y=12;const p=new y(4,32,16,0,2*Math.PI,Math.PI/2,Math.PI/2),w=new o(p,n);w.position.y=18;const m=new l(4.5,2.5,32),u=new r({color:9109504,shininess:30}),g=new o(m,u);g.position.y=19.5;const f=new d(.8,.8,24,12),b=new r({color:3092271,shininess:30}),M=new o(f,b);M.position.y=0;[[-2.5,0,-2.5],[2.5,0,-2.5],[-2.5,0,2.5],[2.5,0,2.5]].forEach((t=>{const n=new o(new d(.4,.4,24,8),b);n.position.set(t[0],0,t[1]),e.add(n)}));[-6,-2,2,6,10].forEach((t=>{const n=new o(new c(3.5,.2,16,32),b);n.rotation.x=Math.PI/2,n.position.y=t,e.add(n)}));const C=new d(.15,.15,7.5,8);[-4,0,4,8].forEach((t=>{for(let n=0;n<2*Math.PI;n+=Math.PI/2){const s=new o(C,b);s.position.y=t,s.rotation.z=Math.PI/4,s.rotation.y=n,e.add(s);const i=new o(C,b);i.position.y=t,i.rotation.z=-Math.PI/4,i.rotation.y=n,e.add(i)}}));const x=new d(4.5,4.5,.3,32),v=new o(x,b);v.position.y=11;const S=new c(4.5,.05,8,32),P=new o(S,b);P.rotation.x=Math.PI/2,P.position.y=12;for(let i=0;i<2*Math.PI;i+=Math.PI/8){const t=new o(new d(.05,.05,1,4),b);t.position.set(4.5*Math.cos(i),11.5,4.5*Math.sin(i)),e.add(t)}const I=new d(.05,.05,24,4),k=new o(I,b),E=new o(I,b);k.position.set(-.3,0,4.2),E.position.set(.3,0,4.2),e.add(k),e.add(E);for(let i=0;i<24;i+=1){const t=new o(new d(.025,.025,.6,4),b);t.rotation.x=Math.PI/2,t.position.set(0,i-12,4.2),e.add(t)}e.add(s),e.add(h),e.add(w),e.add(g),e.add(M),e.add(v),e.add(P),e.position.copy(this.position),this.mesh=e}}new class{constructor(){e(this,"scene",void 0),e(this,"camera",void 0),e(this,"fpvCamera",void 0),e(this,"followCamera",void 0),e(this,"activeCamera",void 0),e(this,"renderer",void 0),e(this,"drone",null),e(this,"buildings",[]),e(this,"controls",void 0),e(this,"cleaningRadius",2),e(this,"cleaningPower",1),e(this,"isSprayOn",!1),e(this,"spraySystem",null),e(this,"propellers",[]),e(this,"propellerSpeed",1.1),e(this,"warningTimeout",null),e(this,"cameraMode","follow"),e(this,"keysPressed",{}),e(this,"lastFrameTime",performance.now()),e(this,"logos",[]),e(this,"score",0),e(this,"hasWon",!1),e(this,"gameStarted",!1),e(this,"gameMode",null),e(this,"startScreenContainer",null),this.scene=new w,this.scene.background=new m(8900331),this.camera=new u(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,15,30),this.fpvCamera=new u(90,window.innerWidth/window.innerHeight,.1,1e3),this.followCamera=new u(75,window.innerWidth/window.innerHeight,.1,1e3),this.activeCamera=this.followCamera,this.renderer=new g({antialias:!0,alpha:!0,powerPreference:"default"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=f,this.renderer.outputColorSpace=b,this.renderer.toneMapping=M,this.renderer.toneMappingExposure=1,document.body.appendChild(this.renderer.domElement),this.createStartScreen(),this.controls=new j(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.maxPolarAngle=Math.PI/2,this.controls.minDistance=5,this.controls.maxDistance=100,this.controls.enabled=!1,this.animate()}createStartScreen(){this.startScreenContainer=document.createElement("div"),this.startScreenContainer.style.position="fixed",this.startScreenContainer.style.top="0",this.startScreenContainer.style.left="0",this.startScreenContainer.style.width="100%",this.startScreenContainer.style.height="100%",this.startScreenContainer.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.startScreenContainer.style.display="flex",this.startScreenContainer.style.flexDirection="column",this.startScreenContainer.style.alignItems="center",this.startScreenContainer.style.justifyContent="center",this.startScreenContainer.style.zIndex="1000";const e=document.createElement("img");e.src="/drone-game/start.png",e.style.width="400px",e.style.marginBottom="40px",this.startScreenContainer.appendChild(e);const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="20px";const n=this.createModeButton("Learning Mode","Learn about Lucid Bots while flying the drone","learning");t.appendChild(n);const o=this.createModeButton("Speed Mode","Test your drone piloting skills","speed");t.appendChild(o),this.startScreenContainer.appendChild(t),document.body.appendChild(this.startScreenContainer)}createModeButton(e,t,n){const o=document.createElement("div");o.style.backgroundColor="#00B4D8",o.style.padding="20px 40px",o.style.borderRadius="10px",o.style.cursor="pointer",o.style.textAlign="center",o.style.transition="transform 0.2s, background-color 0.2s",o.style.width="400px";const s=document.createElement("h2");s.textContent=e,s.style.color="white",s.style.margin="0 0 10px 0",s.style.fontFamily="Arial, sans-serif";const i=document.createElement("p");return i.textContent=t,i.style.color="white",i.style.margin="0",i.style.fontFamily="Arial, sans-serif",o.appendChild(s),o.appendChild(i),o.onmouseover=()=>{o.style.backgroundColor="#0096B4",o.style.transform="scale(1.05)"},o.onmouseout=()=>{o.style.backgroundColor="#00B4D8",o.style.transform="scale(1)"},o.onclick=()=>this.startGame(n),o}startGame(e){this.gameMode=e,this.gameStarted=!0,this.startScreenContainer&&(document.body.removeChild(this.startScreenContainer),this.startScreenContainer=null),this.setupLighting(),this.setupControlsUI(),this.loadDroneModel(),this.addBuildings(),this.addGround(),this.addLogos(),this.updateScoreDisplay(),this.createWarningPopup(),window.addEventListener("resize",this.onWindowResize.bind(this)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),this.updateUIForGameMode()}updateUIForGameMode(){const e=document.getElementById("info");e&&("learning"===this.gameMode?e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Learning Mode: Collect logos to learn about Lucid Bots!</p>\n                </div>\n            ':(e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Speed Mode: Collect all logos as fast as you can!</p>\n                    <p id="timer" style="margin: 5px 0 0 0;">Time: 0:00</p>\n                </div>\n            ',this.startSpeedModeTimer()))}startSpeedModeTimer(){if("speed"!==this.gameMode)return;const e=Date.now(),t=document.getElementById("timer"),n=()=>{if(!this.hasWon&&t){const o=Math.floor((Date.now()-e)/1e3),s=Math.floor(o/60),i=o%60;t.textContent=`Time: ${s}:${i.toString().padStart(2,"0")}`,requestAnimationFrame(n)}};n()}setupLighting(){const e=new C(16777215,.6);this.scene.add(e);const t=new x(16777215,1);t.position.set(50,50,50),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.5,t.shadow.camera.far=500,this.scene.add(t);const n=new v(16777215,4473924,.6);this.scene.add(n)}setupControlsUI(){let e=document.getElementById("info");e||(e=document.createElement("div"),e.id="info",document.body.appendChild(e)),e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.backgroundColor="rgba(0, 0, 0, 0.7)",e.style.color="white",e.style.padding="10px",e.style.borderRadius="8px",e.style.fontFamily="Arial, sans-serif",e.innerHTML='\n            <h3 style="margin:0; font-size:18px;">Game Controls</h3>\n            <ul style="list-style:none; padding:0; margin:5px 0;">\n                <li>Arrow Keys: Move Drone</li>\n                <li>A/D: Yaw Left/Right</li>\n                <li>W/S: Up/Down</li>\n                <li>Space: Toggle Sprayer</li>\n                <li>C: Clean (when sprayer is on)</li>\n                <li>V: Toggle Camera</li>\n                <li>Mouse: Orbit Camera (if enabled)</li>\n            </ul>\n            <p id="score-display" style="margin:0; font-weight:bold;">Score: 0/5 Logos Collected!</p>\n        '}loadDroneModel(){const e=new Y;e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/");const t=new q;t.setDRACOLoader(e),console.log("Attempting to load drone model..."),t.load("/drone-game/sherpaModel.glb",(t=>{if(console.log("Drone model loaded successfully:",t),t.scene){const n=new S,s=t.scene;s.rotation.x=-Math.PI/2,s.scale.set(.5,.5,.5),s.traverse((e=>{e instanceof o&&(e.castShadow=!0,e.receiveShadow=!0,e.material&&e.material.transparent&&(e.material.opacity=.9,e.material.side=p),(e.name.toLowerCase().includes("propeller")||e.name.toLowerCase().includes("prop")||e.name.toLowerCase().includes("rotor"))&&(console.log("Found propeller:",e.name),this.propellers.push(e)))})),n.add(s),n.position.set(0,5,0);const i=new P(16777215,1);i.position.set(0,.5,0),i.angle=Math.PI/6,i.penumbra=.5,i.decay=2,i.distance=10,n.add(i);const a=new I(16777215,.5,5);n.add(a),this.drone=n,this.scene.add(this.drone),console.log("Drone added to scene at position:",this.drone.position),e.dispose()}else console.error("No scene found in the loaded model")}),(e=>{const t=Math.round(e.loaded/e.total*100);console.log(`Loading progress: ${t}%`)}),(e=>{console.error("Error loading drone model:",e);const t=new S,n=new a(2,1,2),s=new r({color:3368703,transparent:!0,opacity:.8}),i=new o(n,s);t.add(i),t.position.set(0,5,0);const d=new I(16777215,.5,10);t.add(d),this.drone=t,this.scene.add(this.drone),console.log("Fallback drone cube added to scene")}))}addBuildings(){const e=new n(new k(-20,3,-15));e.createMesh(),this.scene.add(e.getMesh()),this.buildings.push(e);const t=new G(new k(20,4,-15));t.createMesh(),this.scene.add(t.getMesh()),this.buildings.push(t);const o=new U(new k(-20,8,15));o.createMesh(),this.scene.add(o.getMesh()),this.buildings.push(o);const s=new Z(new k(20,20,15));s.createMesh(),this.scene.add(s.getMesh()),this.buildings.push(s);const i=new X(new k(-40,12,-35));i.createMesh(),this.scene.add(i.getMesh()),this.buildings.push(i)}addGround(){const e=new h(100,100),t=new r({color:9498256,side:p}),n=new o(e,t);n.rotation.x=-Math.PI/2,n.receiveShadow=!0,this.scene.add(n)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.fpvCamera.aspect=window.innerWidth/window.innerHeight,this.fpvCamera.updateProjectionMatrix(),this.followCamera.aspect=window.innerWidth/window.innerHeight,this.followCamera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(e){switch(this.keysPressed[e.key.toLowerCase()]=!0,e.key.toLowerCase()){case" ":this.isSprayOn=!this.isSprayOn,this.isSprayOn&&!this.spraySystem&&this.createSpraySystem();break;case"c":this.isSprayOn&&this.clean();break;case"v":this.toggleCamera()}}onKeyUp(e){this.keysPressed[e.key.toLowerCase()]=!1}updateDroneMovement(e){if(!this.drone)return;this.keysPressed.a&&(this.drone.rotation.y+=1.5*e),this.keysPressed.d&&(this.drone.rotation.y-=1.5*e);let t=0,n=0;this.keysPressed.arrowdown&&(n-=1),this.keysPressed.arrowup&&(n+=1),this.keysPressed.arrowleft&&(t+=1),this.keysPressed.arrowright&&(t-=1),this.keysPressed.q&&(t-=1),this.keysPressed.e&&(t+=1);let o=0;this.keysPressed.w&&(o+=1),this.keysPressed.s&&(o-=1);const s=new k(t,0,n);s.length()>0&&(s.normalize(),s.multiplyScalar(5*e),s.applyEuler(new E(0,this.drone.rotation.y,0)));const i=5*o*e,a=this.drone.position.clone();a.add(s),a.y=Math.max(2,a.y+i);const r=new L(a,.8);let d=!1;for(const l of this.buildings){const e=l.getMesh();if((new D).setFromObject(e).intersectsSphere(r)){d=!0,this.showCollisionWarning();break}}d||this.drone.position.copy(a)}createSpraySystem(){if(!this.drone)return;const e=1500,t=new Float32Array(4500),n=new z,o=new W({color:35071,size:.12,transparent:!0,opacity:.8,blending:T});for(let i=0;i<e;i++){const n=3*i,o=i/e*25;t[n]=(Math.random()-.5)*(.4+.15*o),t[n+1]=(Math.random()-.5)*(.4+.15*o),t[n+2]=-o}n.setAttribute("position",new B(t,3)),this.spraySystem=new A(n,o);const s=new S;s.rotation.x=-Math.PI,s.add(this.spraySystem),this.drone.add(s),this.spraySystem.position.set(-.15,0,0)}updateSpraySystem(){if(!this.spraySystem)return;if(!this.isSprayOn){var e;if(this.spraySystem.parent)null===(e=this.drone)||void 0===e||e.remove(this.spraySystem.parent);return this.spraySystem.geometry.dispose(),this.spraySystem.material.dispose(),void(this.spraySystem=null)}const t=this.spraySystem.geometry.attributes.position.array,n=t.length/3;for(let o=0;o<n;o++){const e=3*o;t[e+2]-=.3,t[e+2]<-10&&(t[e]=.05*(Math.random()-.5),t[e+1]=.05*(Math.random()-.5),t[e+2]=0),t[e]*=.99,t[e+1]*=.99}this.spraySystem.geometry.attributes.position.needsUpdate=!0}updateCameras(){if(this.drone){if("fpv"===this.cameraMode){const e=new k;this.drone.getWorldPosition(e),this.fpvCamera.position.copy(e);const t=new k(-.15,.2,.15);t.applyQuaternion(this.drone.quaternion),this.fpvCamera.position.add(t),this.fpvCamera.rotation.set(0,this.drone.rotation.y+Math.PI,0)}if("follow"===this.cameraMode){const e=new k;this.drone.getWorldPosition(e);const t=new k(0,1.5,-2);t.applyQuaternion(this.drone.quaternion),this.followCamera.position.copy(e).add(t);const n=new k(0,0,1);n.applyQuaternion(this.drone.quaternion);const o=e.clone().add(n);this.followCamera.lookAt(o)}}}checkCollisions(){if(!this.drone)return;const e=new k;this.drone.getWorldPosition(e);const t=new L(e,.5);for(const n of this.buildings){const e=n.getMesh();if((new D).setFromObject(e).intersectsSphere(t)){this.showCollisionWarning();break}}}animate(){if(requestAnimationFrame(this.animate.bind(this)),!this.gameStarted)return void this.renderer.render(this.scene,this.camera);const e=performance.now(),t=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e,this.propellers.length>0&&this.propellers.forEach(((e,t)=>{const n=t%2==0?1:-1;e.rotation.y+=this.propellerSpeed*n})),this.updateDroneMovement(t),this.spraySystem&&this.updateSpraySystem(),this.updateCameras(),this.checkCollisions(),this.checkLogoCollection(),this.logos.forEach((t=>{if(!t.userData.collected){t.quaternion.copy(this.activeCamera.quaternion),t.rotateZ(t.userData.rotationSpeed);const n=.5*Math.sin(.002*e);t.position.y=t.userData.initialY+n}})),this.controls.update(),this.renderer.render(this.scene,this.activeCamera)}clean(){this.drone&&this.isSprayOn&&this.buildings.forEach((e=>{const t=e.getMesh().position,n=this.drone.position;new k(t.x,t.y,t.z).distanceTo(n)<this.cleaningRadius&&e.clean(this.cleaningPower)}))}toggleCamera(){switch(this.cameraMode){case"orbit":this.cameraMode="fpv",this.activeCamera=this.fpvCamera,this.controls.enabled=!1;break;case"fpv":this.cameraMode="follow",this.activeCamera=this.followCamera,this.controls.enabled=!1;break;case"follow":this.cameraMode="orbit",this.activeCamera=this.camera,this.controls.enabled=!0}}createWarningPopup(){if(!document.getElementById("warning-popup")){const e=document.createElement("div");e.id="warning-popup",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="rgba(255, 200, 200, 0.95)",e.style.padding="20px",e.style.borderRadius="10px",e.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",e.style.display="none",e.style.zIndex="1000",e.style.fontFamily="Arial, sans-serif",e.style.fontSize="16px",e.style.color="#333",e.style.border="2px solid #ff6b6b",e.style.maxWidth="400px",e.style.textAlign="center",document.body.appendChild(e)}}showCollisionWarning(){const e=document.getElementById("warning-popup");e&&"block"!==e.style.display&&(e.textContent="The Sherpa drone is built with a forward facing collision radar to prevent the drone from drifting into buildings",e.style.display="block",null!==this.warningTimeout&&window.clearTimeout(this.warningTimeout),this.warningTimeout=window.setTimeout((()=>{e&&(e.style.display="none"),this.warningTimeout=null}),3e3))}checkLogoCollection(){if(!this.drone||!this.spraySystem||!this.isSprayOn||this.hasWon)return;const e=this.spraySystem.parent;if(!e)return;e.updateMatrixWorld();const t=e.matrixWorld,n=this.spraySystem.geometry.attributes.position.array,o=n.length/3;this.logos.forEach((e=>{if(!e.userData.collected){const i=e.position.clone();for(let a=0;a<o;a++){const o=3*a;if(new k(n[o],n[o+1],n[o+2]).applyMatrix4(t).distanceTo(i)<.5){e.userData.collected=!0,this.scene.remove(e),e.geometry.dispose(),e.material instanceof s&&e.material.dispose(),this.score++,this.playCollectionEffect(e.position.clone()),this.updateScoreDisplay(),"learning"===this.gameMode&&e.userData.info&&this.showLearningPopup(e.userData.info),this.score>=5&&this.showWinMessage();break}}}}))}playCollectionEffect(e){const t=new z,n=new Float32Array(150),o=[];for(let d=0;d<50;d++){const t=3*d;n[t]=e.x,n[t+1]=e.y,n[t+2]=e.z,o.push(new k(2*(Math.random()-.5),2*Math.random(),2*(Math.random()-.5)))}t.setAttribute("position",new B(n,3));const s=new W({color:16776960,size:.1,transparent:!0,opacity:1,blending:T}),i=new A(t,s);this.scene.add(i);let a=0;const r=()=>{if(a>1)return this.scene.remove(i),t.dispose(),void s.dispose();const e=t.attributes.position.array;for(let t=0;t<50;t++){const n=3*t;e[n]+=.1*o[t].x,e[n+1]+=.1*o[t].y,e[n+2]+=.1*o[t].z}t.attributes.position.needsUpdate=!0,s.opacity=1-a,a+=.05,requestAnimationFrame(r)};r()}updateScoreDisplay(){const e=document.getElementById("score-display");e&&(e.textContent=`Score: ${this.score}/5 Logos Collected!`)}showWinMessage(){this.hasWon=!0;const e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#00B4D8",e.style.padding="30px",e.style.borderRadius="15px",e.style.color="white",e.style.fontSize="24px",e.style.fontWeight="bold",e.style.textAlign="center",e.style.zIndex="1000",e.style.maxWidth="500px";const t=document.createElement("img");t.src="/drone-game/logo.png",t.style.width="120px",t.style.marginBottom="20px",e.appendChild(t);const n=document.createElement("div");n.style.marginBottom="20px";let o="Congratulations! You've collected all logos!";if("speed"===this.gameMode){var s;const e=document.getElementById("timer");o+=`\nYour time: ${e?null===(s=e.textContent)||void 0===s?void 0:s.replace("Time: ",""):"0:00"}`}else"learning"===this.gameMode&&(o+="\n\nRemember:",n.innerHTML=o+'<br><br>"We believe in responsible robotics, paving the way to better lives for everyone.');n.style.lineHeight="1.4","speed"===this.gameMode&&(n.textContent=o),e.appendChild(n);const i=document.createElement("div");i.style.fontSize="18px",i.style.marginTop="20px";const a=document.createElement("a");a.href="https://lucidbots.com",a.textContent="Visit lucidbots.com to learn more!",a.style.color="white",a.style.textDecoration="underline",a.target="_blank",i.appendChild(a),e.appendChild(i);const r=document.createElement("button");r.textContent="Play Again",r.style.marginTop="20px",r.style.padding="10px 20px",r.style.fontSize="18px",r.style.borderRadius="5px",r.style.border="none",r.style.backgroundColor="white",r.style.color="#00B4D8",r.style.cursor="pointer",r.style.transition="transform 0.2s",r.onmouseover=()=>r.style.transform="scale(1.05)",r.onmouseout=()=>r.style.transform="scale(1)",r.onclick=()=>window.location.reload(),e.appendChild(r),document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e)}),1e4)}createLogo(){const e=new F(1.5,32),t=(new O).load("/drone-game/logo.png");t.minFilter=R,t.magFilter=R;const n=new H({map:t,side:p,transparent:!0,opacity:1,emissive:16777215,emissiveMap:t,emissiveIntensity:.8}),s=new o(e,n),i=new I(16777215,1,5);i.position.set(0,0,.1),s.add(i);const a=new I(16777215,1,5);return a.position.set(0,0,-.1),s.add(a),s.userData={collected:!1,initialY:0,rotationSpeed:.02},s}addLogos(){[{building:this.buildings[0],offsetY:18,offsetX:0,offsetZ:0,info:"Lucid Bots Inc. is an AI robotics company that builds productive and responsible robots for the exterior cleaning, concrete, and construction industries."},{building:this.buildings[1],offsetY:25,offsetX:0,offsetZ:0,info:"Our drones use advanced AI to learn and navigate complex environments safely."},{building:this.buildings[2],offsetY:16,offsetX:0,offsetZ:0,info:"Lucid Bots' Sherpa drone could clean any of these buildings in reality as well!"},{building:this.buildings[3],offsetY:30,offsetX:0,offsetZ:4,info:"Our mission at Lucid Bots is to elevate efficiency, safety, and humanity by creating the world's most productive drones."},{building:this.buildings[4],offsetY:22,offsetX:0,offsetZ:0,info:"We also have a surface cleaning robot, known as the Lavobot"}].forEach((({building:e,offsetY:t,offsetX:n,offsetZ:o,info:s})=>{const i=e.getMesh().position,a=this.createLogo();a.position.set(i.x+n,i.y+t,i.z+o),a.userData.initialY=i.y+t,a.userData.info=s,this.logos.push(a),this.scene.add(a)}))}showLearningPopup(e){const t=document.createElement("div");t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(0, 180, 216, 0.95)",t.style.padding="20px",t.style.borderRadius="10px",t.style.boxShadow="0 0 20px rgba(0,0,0,0.3)",t.style.color="white",t.style.fontSize="18px",t.style.fontFamily="Arial, sans-serif",t.style.textAlign="center",t.style.maxWidth="400px",t.style.zIndex="1000",t.style.animation="fadeIn 0.3s ease-in-out";const n=document.createElement("style");n.textContent="\n            @keyframes fadeIn {\n                from { opacity: 0; transform: translate(-50%, -60%); }\n                to { opacity: 1; transform: translate(-50%, -50%); }\n            }\n        ",document.head.appendChild(n);const o=document.createElement("img");o.src="/drone-game/logo.png",o.style.width="100px",o.style.marginBottom="15px",t.appendChild(o);const s=document.createElement("p");s.textContent=e,s.style.margin="0",s.style.lineHeight="1.5",t.appendChild(s);const i=document.createElement("button");i.textContent="Continue",i.style.marginTop="15px",i.style.padding="8px 20px",i.style.fontSize="16px",i.style.backgroundColor="white",i.style.color="#00B4D8",i.style.border="none",i.style.borderRadius="5px",i.style.cursor="pointer",i.style.transition="transform 0.2s",i.onmouseover=()=>i.style.transform="scale(1.05)",i.onmouseout=()=>i.style.transform="scale(1)",i.onclick=()=>document.body.removeChild(t),t.appendChild(i),document.body.appendChild(t)}}}}}))}();
//# sourceMappingURL=index-legacy-ce10887e.js.map
