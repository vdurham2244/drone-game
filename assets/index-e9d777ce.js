var Gt=Object.defineProperty;var vt=(m,e,n)=>e in m?Gt(m,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[e]=n;var L=(m,e,n)=>(vt(m,typeof e!="symbol"?e+"":e,n),n);import*as c from"three";import{TrianglesDrawMode as Bt,TriangleFanDrawMode as Ce,TriangleStripDrawMode as ct,Loader as lt,LoaderUtils as le,FileLoader as fe,Color as Q,LinearSRGBColorSpace as V,SpotLight as Ft,PointLight as Ht,DirectionalLight as jt,MeshBasicMaterial as ce,SRGBColorSpace as $,MeshPhysicalMaterial as W,Vector2 as B,Matrix4 as me,Vector3 as k,Quaternion as ge,InstancedMesh as Ut,InstancedBufferAttribute as Kt,Object3D as dt,TextureLoader as zt,ImageBitmapLoader as Vt,BufferAttribute as de,InterleavedBuffer as Wt,InterleavedBufferAttribute as Xt,LinearFilter as ut,LinearMipmapLinearFilter as ht,RepeatWrapping as _e,PointsMaterial as Yt,Material as be,LineBasicMaterial as qt,MeshStandardMaterial as pt,DoubleSide as Zt,PropertyBinding as Qt,BufferGeometry as ft,SkinnedMesh as Jt,Mesh as $t,LineSegments as en,Line as tn,LineLoop as nn,Points as sn,Group as xe,PerspectiveCamera as on,MathUtils as mt,OrthographicCamera as rn,Skeleton as an,AnimationClip as cn,Bone as ln,InterpolateLinear as gt,ColorManagement as Ye,NearestFilter as dn,NearestMipmapNearestFilter as un,LinearMipmapNearestFilter as hn,NearestMipmapLinearFilter as pn,ClampToEdgeWrapping as fn,MirroredRepeatWrapping as mn,InterpolateDiscrete as gn,FrontSide as yn,Texture as qe,VectorKeyframeTrack as Ze,NumberKeyframeTrack as Qe,QuaternionKeyframeTrack as Je,Box3 as wn,Sphere as Tn,Interpolant as An,Ray as Mn,Plane as bn,EventDispatcher as xn,MOUSE as te,TOUCH as ne,Spherical as $e}from"three";function gs(){import.meta.url,import("_").catch(()=>1);async function*m(){}}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function et(m,e){if(e===Bt)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),m;if(e===Ce||e===ct){let n=m.getIndex();if(n===null){const i=[],r=m.getAttribute("position");if(r!==void 0){for(let a=0;a<r.count;a++)i.push(a);m.setIndex(i),n=m.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),m}const t=n.count-2,s=[];if(e===Ce)for(let i=1;i<=t;i++)s.push(n.getX(0)),s.push(n.getX(i)),s.push(n.getX(i+1));else for(let i=0;i<t;i++)i%2===0?(s.push(n.getX(i)),s.push(n.getX(i+1)),s.push(n.getX(i+2))):(s.push(n.getX(i+2)),s.push(n.getX(i+1)),s.push(n.getX(i)));s.length/3!==t&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=m.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),m}class En extends lt{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Cn(n)}),this.register(function(n){return new Bn(n)}),this.register(function(n){return new Fn(n)}),this.register(function(n){return new Hn(n)}),this.register(function(n){return new In(n)}),this.register(function(n){return new On(n)}),this.register(function(n){return new kn(n)}),this.register(function(n){return new Dn(n)}),this.register(function(n){return new Pn(n)}),this.register(function(n){return new Nn(n)}),this.register(function(n){return new _n(n)}),this.register(function(n){return new vn(n)}),this.register(function(n){return new Gn(n)}),this.register(function(n){return new Ln(n)}),this.register(function(n){return new jn(n)}),this.register(function(n){return new Un(n)})}load(e,n,t,s){const o=this;let i;if(this.resourcePath!=="")i=this.resourcePath;else if(this.path!==""){const l=le.extractUrlBase(e);i=le.resolveURL(l,this.path)}else i=le.extractUrlBase(e);this.manager.itemStart(e);const r=function(l){s?s(l):console.error(l),o.manager.itemError(e),o.manager.itemEnd(e)},a=new fe(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{o.parse(l,i,function(u){n(u),o.manager.itemEnd(e)},r)}catch(u){r(u)}},t,r)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,t,s){let o;const i={},r={},a=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===yt){try{i[S.KHR_BINARY_GLTF]=new Kn(e)}catch(d){s&&s(d);return}o=JSON.parse(i[S.KHR_BINARY_GLTF].content)}else o=JSON.parse(a.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new ns(o,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](l);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),r[d.name]=d,i[d.name]=!0}if(o.extensionsUsed)for(let u=0;u<o.extensionsUsed.length;++u){const d=o.extensionsUsed[u],p=o.extensionsRequired||[];switch(d){case S.KHR_MATERIALS_UNLIT:i[d]=new Rn;break;case S.KHR_DRACO_MESH_COMPRESSION:i[d]=new zn(o,this.dracoLoader);break;case S.KHR_TEXTURE_TRANSFORM:i[d]=new Vn;break;case S.KHR_MESH_QUANTIZATION:i[d]=new Wn;break;default:p.indexOf(d)>=0&&r[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(i),l.setPlugins(r),l.parse(t,s)}parseAsync(e,n){const t=this;return new Promise(function(s,o){t.parse(e,n,s,o)})}}function Sn(){let m={};return{get:function(e){return m[e]},add:function(e,n){m[e]=n},remove:function(e){delete m[e]},removeAll:function(){m={}}}}const S={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Ln{constructor(e){this.parser=e,this.name=S.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let t=0,s=n.length;t<s;t++){const o=n[t];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const n=this.parser,t="light:"+e;let s=n.cache.get(t);if(s)return s;const o=n.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let l;const u=new Q(16777215);a.color!==void 0&&u.setRGB(a.color[0],a.color[1],a.color[2],V);const d=a.range!==void 0?a.range:0;switch(a.type){case"directional":l=new jt(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Ht(u),l.distance=d;break;case"spot":l=new Ft(u),l.distance=d,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,Z(l,a),a.intensity!==void 0&&(l.intensity=a.intensity),l.name=n.createUniqueName(a.name||"light_"+e),s=Promise.resolve(l),n.cache.add(t,s),s}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,t=this.parser,o=t.json.nodes[e],r=(o.extensions&&o.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(a){return t._getNodeRef(n.cache,r,a)})}}class Rn{constructor(){this.name=S.KHR_MATERIALS_UNLIT}getMaterialType(){return ce}extendParams(e,n,t){const s=[];e.color=new Q(1,1,1),e.opacity=1;const o=n.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const i=o.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],V),e.opacity=i[3]}o.baseColorTexture!==void 0&&s.push(t.assignTexture(e,"map",o.baseColorTexture,$))}return Promise.all(s)}}class Pn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(n.emissiveIntensity=o),Promise.resolve()}}class Cn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];if(i.clearcoatFactor!==void 0&&(n.clearcoat=i.clearcoatFactor),i.clearcoatTexture!==void 0&&o.push(t.assignTexture(n,"clearcoatMap",i.clearcoatTexture)),i.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=i.clearcoatRoughnessFactor),i.clearcoatRoughnessTexture!==void 0&&o.push(t.assignTexture(n,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),i.clearcoatNormalTexture!==void 0&&(o.push(t.assignTexture(n,"clearcoatNormalMap",i.clearcoatNormalTexture)),i.clearcoatNormalTexture.scale!==void 0)){const r=i.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new B(r,r)}return Promise.all(o)}}class _n{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];return i.iridescenceFactor!==void 0&&(n.iridescence=i.iridescenceFactor),i.iridescenceTexture!==void 0&&o.push(t.assignTexture(n,"iridescenceMap",i.iridescenceTexture)),i.iridescenceIor!==void 0&&(n.iridescenceIOR=i.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),i.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),i.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),i.iridescenceThicknessTexture!==void 0&&o.push(t.assignTexture(n,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(o)}}class In{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];n.sheenColor=new Q(0,0,0),n.sheenRoughness=0,n.sheen=1;const i=s.extensions[this.name];if(i.sheenColorFactor!==void 0){const r=i.sheenColorFactor;n.sheenColor.setRGB(r[0],r[1],r[2],V)}return i.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=i.sheenRoughnessFactor),i.sheenColorTexture!==void 0&&o.push(t.assignTexture(n,"sheenColorMap",i.sheenColorTexture,$)),i.sheenRoughnessTexture!==void 0&&o.push(t.assignTexture(n,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(o)}}class On{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];return i.transmissionFactor!==void 0&&(n.transmission=i.transmissionFactor),i.transmissionTexture!==void 0&&o.push(t.assignTexture(n,"transmissionMap",i.transmissionTexture)),Promise.all(o)}}class kn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];n.thickness=i.thicknessFactor!==void 0?i.thicknessFactor:0,i.thicknessTexture!==void 0&&o.push(t.assignTexture(n,"thicknessMap",i.thicknessTexture)),n.attenuationDistance=i.attenuationDistance||1/0;const r=i.attenuationColor||[1,1,1];return n.attenuationColor=new Q().setRGB(r[0],r[1],r[2],V),Promise.all(o)}}class Dn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return n.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class Nn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];n.specularIntensity=i.specularFactor!==void 0?i.specularFactor:1,i.specularTexture!==void 0&&o.push(t.assignTexture(n,"specularIntensityMap",i.specularTexture));const r=i.specularColorFactor||[1,1,1];return n.specularColor=new Q().setRGB(r[0],r[1],r[2],V),i.specularColorTexture!==void 0&&o.push(t.assignTexture(n,"specularColorMap",i.specularColorTexture,$)),Promise.all(o)}}class Gn{constructor(e){this.parser=e,this.name=S.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];return n.bumpScale=i.bumpFactor!==void 0?i.bumpFactor:1,i.bumpTexture!==void 0&&o.push(t.assignTexture(n,"bumpMap",i.bumpTexture)),Promise.all(o)}}class vn{constructor(e){this.parser=e,this.name=S.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:W}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],i=s.extensions[this.name];return i.anisotropyStrength!==void 0&&(n.anisotropy=i.anisotropyStrength),i.anisotropyRotation!==void 0&&(n.anisotropyRotation=i.anisotropyRotation),i.anisotropyTexture!==void 0&&o.push(t.assignTexture(n,"anisotropyMap",i.anisotropyTexture)),Promise.all(o)}}class Bn{constructor(e){this.parser=e,this.name=S.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,t=n.json,s=t.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const o=s.extensions[this.name],i=n.options.ktx2Loader;if(!i){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,o.source,i)}}class Fn{constructor(e){this.parser=e,this.name=S.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,s=t.json,o=s.textures[e];if(!o.extensions||!o.extensions[n])return null;const i=o.extensions[n],r=s.images[i.source];let a=t.textureLoader;if(r.uri){const l=t.options.manager.getHandler(r.uri);l!==null&&(a=l)}return this.detectSupport().then(function(l){if(l)return t.loadTextureImage(e,i.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Hn{constructor(e){this.parser=e,this.name=S.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,s=t.json,o=s.textures[e];if(!o.extensions||!o.extensions[n])return null;const i=o.extensions[n],r=s.images[i.source];let a=t.textureLoader;if(r.uri){const l=t.options.manager.getHandler(r.uri);l!==null&&(a=l)}return this.detectSupport().then(function(l){if(l)return t.loadTextureImage(e,i.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class jn{constructor(e){this.name=S.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,t=n.bufferViews[e];if(t.extensions&&t.extensions[this.name]){const s=t.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(r){const a=s.byteOffset||0,l=s.byteLength||0,u=s.count,d=s.byteStride,p=new Uint8Array(r,a,l);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(u,d,p,s.mode,s.filter).then(function(f){return f.buffer}):i.ready.then(function(){const f=new ArrayBuffer(u*d);return i.decodeGltfBuffer(new Uint8Array(f),u,d,p,s.mode,s.filter),f})})}else return null}}class Un{constructor(e){this.name=S.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,t=n.nodes[e];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;const s=n.meshes[t.mesh];for(const l of s.primitives)if(l.mode!==F.TRIANGLES&&l.mode!==F.TRIANGLE_STRIP&&l.mode!==F.TRIANGLE_FAN&&l.mode!==void 0)return null;const i=t.extensions[this.name].attributes,r=[],a={};for(const l in i)r.push(this.parser.getDependency("accessor",i[l]).then(u=>(a[l]=u,a[l])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(l=>{const u=l.pop(),d=u.isGroup?u.children:[u],p=l[0].count,f=[];for(const g of d){const w=new me,y=new k,T=new ge,M=new k(1,1,1),E=new Ut(g.geometry,g.material,p);for(let b=0;b<p;b++)a.TRANSLATION&&y.fromBufferAttribute(a.TRANSLATION,b),a.ROTATION&&T.fromBufferAttribute(a.ROTATION,b),a.SCALE&&M.fromBufferAttribute(a.SCALE,b),E.setMatrixAt(b,w.compose(y,T,M));for(const b in a)if(b==="_COLOR_0"){const R=a[b];E.instanceColor=new Kt(R.array,R.itemSize,R.normalized)}else b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&g.geometry.setAttribute(b,a[b]);dt.prototype.copy.call(E,g),this.parser.assignFinalMaterial(E),f.push(E)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const yt="glTF",ae=12,tt={JSON:1313821514,BIN:5130562};class Kn{constructor(e){this.name=S.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,ae),t=new TextDecoder;if(this.header={magic:t.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==yt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-ae,o=new DataView(e,ae);let i=0;for(;i<s;){const r=o.getUint32(i,!0);i+=4;const a=o.getUint32(i,!0);if(i+=4,a===tt.JSON){const l=new Uint8Array(e,ae+i,r);this.content=t.decode(l)}else if(a===tt.BIN){const l=ae+i;this.body=e.slice(l,l+r)}i+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class zn{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=S.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const t=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,r={},a={},l={};for(const u in i){const d=Ie[u]||u.toLowerCase();r[d]=i[u]}for(const u in e.attributes){const d=Ie[u]||u.toLowerCase();if(i[u]!==void 0){const p=t.accessors[e.attributes[u]],f=se[p.componentType];l[d]=f.name,a[d]=p.normalized===!0}}return n.getDependency("bufferView",o).then(function(u){return new Promise(function(d){s.decodeDracoFile(u,function(p){for(const f in p.attributes){const g=p.attributes[f],w=a[f];w!==void 0&&(g.normalized=w)}d(p)},r,l)})})}}class Vn{constructor(){this.name=S.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class Wn{constructor(){this.name=S.KHR_MESH_QUANTIZATION}}class wt extends An{constructor(e,n,t,s){super(e,n,t,s)}copySampleValue_(e){const n=this.resultBuffer,t=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let i=0;i!==s;i++)n[i]=t[o+i];return n}interpolate_(e,n,t,s){const o=this.resultBuffer,i=this.sampleValues,r=this.valueSize,a=r*2,l=r*3,u=s-n,d=(t-n)/u,p=d*d,f=p*d,g=e*l,w=g-l,y=-2*f+3*p,T=f-p,M=1-y,E=T-p+d;for(let b=0;b!==r;b++){const R=i[w+b+r],I=i[w+b+a]*u,x=i[g+b+r],N=i[g+b]*u;o[b]=M*R+E*I+y*x+T*N}return o}}const Xn=new ge;class Yn extends wt{interpolate_(e,n,t,s){const o=super.interpolate_(e,n,t,s);return Xn.fromArray(o).normalize().toArray(o),o}}const F={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},se={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nt={9728:dn,9729:ut,9984:un,9985:hn,9986:pn,9987:ht},st={33071:fn,33648:mn,10497:_e},Ee={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ie={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},q={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qn={CUBICSPLINE:void 0,LINEAR:gt,STEP:gn},Se={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Zn(m){return m.DefaultMaterial===void 0&&(m.DefaultMaterial=new pt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:yn})),m.DefaultMaterial}function J(m,e,n){for(const t in n.extensions)m[t]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[t]=n.extensions[t])}function Z(m,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(m.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Qn(m,e,n){let t=!1,s=!1,o=!1;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(d.POSITION!==void 0&&(t=!0),d.NORMAL!==void 0&&(s=!0),d.COLOR_0!==void 0&&(o=!0),t&&s&&o)break}if(!t&&!s&&!o)return Promise.resolve(m);const i=[],r=[],a=[];for(let l=0,u=e.length;l<u;l++){const d=e[l];if(t){const p=d.POSITION!==void 0?n.getDependency("accessor",d.POSITION):m.attributes.position;i.push(p)}if(s){const p=d.NORMAL!==void 0?n.getDependency("accessor",d.NORMAL):m.attributes.normal;r.push(p)}if(o){const p=d.COLOR_0!==void 0?n.getDependency("accessor",d.COLOR_0):m.attributes.color;a.push(p)}}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(a)]).then(function(l){const u=l[0],d=l[1],p=l[2];return t&&(m.morphAttributes.position=u),s&&(m.morphAttributes.normal=d),o&&(m.morphAttributes.color=p),m.morphTargetsRelative=!0,m})}function Jn(m,e){if(m.updateMorphTargets(),e.weights!==void 0)for(let n=0,t=e.weights.length;n<t;n++)m.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(m.morphTargetInfluences.length===n.length){m.morphTargetDictionary={};for(let t=0,s=n.length;t<s;t++)m.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function $n(m){let e;const n=m.extensions&&m.extensions[S.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+Le(n.attributes):e=m.indices+":"+Le(m.attributes)+":"+m.mode,m.targets!==void 0)for(let t=0,s=m.targets.length;t<s;t++)e+=":"+Le(m.targets[t]);return e}function Le(m){let e="";const n=Object.keys(m).sort();for(let t=0,s=n.length;t<s;t++)e+=n[t]+":"+m[n[t]]+";";return e}function Oe(m){switch(m){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function es(m){return m.search(/\.jpe?g($|\?)/i)>0||m.search(/^data\:image\/jpeg/)===0?"image/jpeg":m.search(/\.webp($|\?)/i)>0||m.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const ts=new me;class ns{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Sn,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,s=!1,o=-1;typeof navigator<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,o=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||s&&o<98?this.textureLoader=new zt(this.options.manager):this.textureLoader=new Vt(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new fe(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const t=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(i){return i._markDefs&&i._markDefs()}),Promise.all(this._invokeAll(function(i){return i.beforeRoot&&i.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(i){const r={scene:i[0][s.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:s.asset,parser:t,userData:{}};return J(o,r,s),Z(r,s),Promise.all(t._invokeAll(function(a){return a.afterRoot&&a.afterRoot(r)})).then(function(){e(r)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],t=this.json.meshes||[];for(let s=0,o=n.length;s<o;s++){const i=n[s].joints;for(let r=0,a=i.length;r<a;r++)e[i[r]].isBone=!0}for(let s=0,o=e.length;s<o;s++){const i=e[s];i.mesh!==void 0&&(this._addNodeRef(this.meshCache,i.mesh),i.skin!==void 0&&(t[i.mesh].isSkinnedMesh=!0)),i.camera!==void 0&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,t){if(e.refs[n]<=1)return t;const s=t.clone(),o=(i,r)=>{const a=this.associations.get(i);a!=null&&this.associations.set(r,a);for(const[l,u]of i.children.entries())o(u,r.children[l])};return o(t,s),s.name+="_instance_"+e.uses[n]++,s}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let t=0;t<n.length;t++){const s=e(n[t]);if(s)return s}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const t=[];for(let s=0;s<n.length;s++){const o=e(n[s]);o&&t.push(o)}return t}getDependency(e,n){const t=e+":"+n;let s=this.cache.get(t);if(!s){switch(e){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(n)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,n)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(t,s)}return s}getDependencies(e){let n=this.cache.get(e);if(!n){const t=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(o,i){return t.getDependency(e,i)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],t=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[S.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(o,i){t.load(le.resolveURL(n.uri,s.path),o,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(t){const s=n.byteLength||0,o=n.byteOffset||0;return t.slice(o,o+s)})}loadAccessor(e){const n=this,t=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const i=Ee[s.type],r=se[s.componentType],a=s.normalized===!0,l=new r(s.count*i);return Promise.resolve(new de(l,i,a))}const o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(i){const r=i[0],a=Ee[s.type],l=se[s.componentType],u=l.BYTES_PER_ELEMENT,d=u*a,p=s.byteOffset||0,f=s.bufferView!==void 0?t.bufferViews[s.bufferView].byteStride:void 0,g=s.normalized===!0;let w,y;if(f&&f!==d){const T=Math.floor(p/f),M="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+T+":"+s.count;let E=n.cache.get(M);E||(w=new l(r,T*f,s.count*f/u),E=new Wt(w,f/u),n.cache.add(M,E)),y=new Xt(E,a,p%f/u,g)}else r===null?w=new l(s.count*a):w=new l(r,p,s.count*a),y=new de(w,a,g);if(s.sparse!==void 0){const T=Ee.SCALAR,M=se[s.sparse.indices.componentType],E=s.sparse.indices.byteOffset||0,b=s.sparse.values.byteOffset||0,R=new M(i[1],E,s.sparse.count*T),I=new l(i[2],b,s.sparse.count*a);r!==null&&(y=new de(y.array.slice(),y.itemSize,y.normalized));for(let x=0,N=R.length;x<N;x++){const G=R[x];if(y.setX(G,I[x*a]),a>=2&&y.setY(G,I[x*a+1]),a>=3&&y.setZ(G,I[x*a+2]),a>=4&&y.setW(G,I[x*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return y})}loadTexture(e){const n=this.json,t=this.options,o=n.textures[e].source,i=n.images[o];let r=this.textureLoader;if(i.uri){const a=t.manager.getHandler(i.uri);a!==null&&(r=a)}return this.loadTextureImage(e,o,r)}loadTextureImage(e,n,t){const s=this,o=this.json,i=o.textures[e],r=o.images[n],a=(r.uri||r.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(n,t).then(function(u){u.flipY=!1,u.name=i.name||r.name||"",u.name===""&&typeof r.uri=="string"&&r.uri.startsWith("data:image/")===!1&&(u.name=r.uri);const p=(o.samplers||{})[i.sampler]||{};return u.magFilter=nt[p.magFilter]||ut,u.minFilter=nt[p.minFilter]||ht,u.wrapS=st[p.wrapS]||_e,u.wrapT=st[p.wrapT]||_e,s.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[a]=l,l}loadImageSource(e,n){const t=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const i=s.images[e],r=self.URL||self.webkitURL;let a=i.uri||"",l=!1;if(i.bufferView!==void 0)a=t.getDependency("bufferView",i.bufferView).then(function(d){l=!0;const p=new Blob([d],{type:i.mimeType});return a=r.createObjectURL(p),a});else if(i.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(a).then(function(d){return new Promise(function(p,f){let g=p;n.isImageBitmapLoader===!0&&(g=function(w){const y=new qe(w);y.needsUpdate=!0,p(y)}),n.load(le.resolveURL(d,o.path),g,void 0,f)})}).then(function(d){return l===!0&&r.revokeObjectURL(a),d.userData.mimeType=i.mimeType||es(i.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),d});return this.sourceCache[e]=u,u}assignTexture(e,n,t,s){const o=this;return this.getDependency("texture",t.index).then(function(i){if(!i)return null;if(t.texCoord!==void 0&&t.texCoord>0&&(i=i.clone(),i.channel=t.texCoord),o.extensions[S.KHR_TEXTURE_TRANSFORM]){const r=t.extensions!==void 0?t.extensions[S.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const a=o.associations.get(i);i=o.extensions[S.KHR_TEXTURE_TRANSFORM].extendTexture(i,r),o.associations.set(i,a)}}return s!==void 0&&(i.colorSpace=s),e[n]=i,i})}assignFinalMaterial(e){const n=e.geometry;let t=e.material;const s=n.attributes.tangent===void 0,o=n.attributes.color!==void 0,i=n.attributes.normal===void 0;if(e.isPoints){const r="PointsMaterial:"+t.uuid;let a=this.cache.get(r);a||(a=new Yt,be.prototype.copy.call(a,t),a.color.copy(t.color),a.map=t.map,a.sizeAttenuation=!1,this.cache.add(r,a)),t=a}else if(e.isLine){const r="LineBasicMaterial:"+t.uuid;let a=this.cache.get(r);a||(a=new qt,be.prototype.copy.call(a,t),a.color.copy(t.color),a.map=t.map,this.cache.add(r,a)),t=a}if(s||o||i){let r="ClonedMaterial:"+t.uuid+":";s&&(r+="derivative-tangents:"),o&&(r+="vertex-colors:"),i&&(r+="flat-shading:");let a=this.cache.get(r);a||(a=t.clone(),o&&(a.vertexColors=!0),i&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(r,a),this.associations.set(a,this.associations.get(t))),t=a}e.material=t}getMaterialType(){return pt}loadMaterial(e){const n=this,t=this.json,s=this.extensions,o=t.materials[e];let i;const r={},a=o.extensions||{},l=[];if(a[S.KHR_MATERIALS_UNLIT]){const d=s[S.KHR_MATERIALS_UNLIT];i=d.getMaterialType(),l.push(d.extendParams(r,o,n))}else{const d=o.pbrMetallicRoughness||{};if(r.color=new Q(1,1,1),r.opacity=1,Array.isArray(d.baseColorFactor)){const p=d.baseColorFactor;r.color.setRGB(p[0],p[1],p[2],V),r.opacity=p[3]}d.baseColorTexture!==void 0&&l.push(n.assignTexture(r,"map",d.baseColorTexture,$)),r.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,r.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(l.push(n.assignTexture(r,"metalnessMap",d.metallicRoughnessTexture)),l.push(n.assignTexture(r,"roughnessMap",d.metallicRoughnessTexture))),i=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,r)})))}o.doubleSided===!0&&(r.side=Zt);const u=o.alphaMode||Se.OPAQUE;if(u===Se.BLEND?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,u===Se.MASK&&(r.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&i!==ce&&(l.push(n.assignTexture(r,"normalMap",o.normalTexture)),r.normalScale=new B(1,1),o.normalTexture.scale!==void 0)){const d=o.normalTexture.scale;r.normalScale.set(d,d)}if(o.occlusionTexture!==void 0&&i!==ce&&(l.push(n.assignTexture(r,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(r.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&i!==ce){const d=o.emissiveFactor;r.emissive=new Q().setRGB(d[0],d[1],d[2],V)}return o.emissiveTexture!==void 0&&i!==ce&&l.push(n.assignTexture(r,"emissiveMap",o.emissiveTexture,$)),Promise.all(l).then(function(){const d=new i(r);return o.name&&(d.name=o.name),Z(d,o),n.associations.set(d,{materials:e}),o.extensions&&J(s,d,o),d})}createUniqueName(e){const n=Qt.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,t=this.extensions,s=this.primitiveCache;function o(r){return t[S.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,n).then(function(a){return ot(a,r,n)})}const i=[];for(let r=0,a=e.length;r<a;r++){const l=e[r],u=$n(l),d=s[u];if(d)i.push(d.promise);else{let p;l.extensions&&l.extensions[S.KHR_DRACO_MESH_COMPRESSION]?p=o(l):p=ot(new ft,l,n),s[u]={primitive:l,promise:p},i.push(p)}}return Promise.all(i)}loadMesh(e){const n=this,t=this.json,s=this.extensions,o=t.meshes[e],i=o.primitives,r=[];for(let a=0,l=i.length;a<l;a++){const u=i[a].material===void 0?Zn(this.cache):this.getDependency("material",i[a].material);r.push(u)}return r.push(n.loadGeometries(i)),Promise.all(r).then(function(a){const l=a.slice(0,a.length-1),u=a[a.length-1],d=[];for(let f=0,g=u.length;f<g;f++){const w=u[f],y=i[f];let T;const M=l[f];if(y.mode===F.TRIANGLES||y.mode===F.TRIANGLE_STRIP||y.mode===F.TRIANGLE_FAN||y.mode===void 0)T=o.isSkinnedMesh===!0?new Jt(w,M):new $t(w,M),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),y.mode===F.TRIANGLE_STRIP?T.geometry=et(T.geometry,ct):y.mode===F.TRIANGLE_FAN&&(T.geometry=et(T.geometry,Ce));else if(y.mode===F.LINES)T=new en(w,M);else if(y.mode===F.LINE_STRIP)T=new tn(w,M);else if(y.mode===F.LINE_LOOP)T=new nn(w,M);else if(y.mode===F.POINTS)T=new sn(w,M);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);Object.keys(T.geometry.morphAttributes).length>0&&Jn(T,o),T.name=n.createUniqueName(o.name||"mesh_"+e),Z(T,o),y.extensions&&J(s,T,y),n.assignFinalMaterial(T),d.push(T)}for(let f=0,g=d.length;f<g;f++)n.associations.set(d[f],{meshes:e,primitives:f});if(d.length===1)return o.extensions&&J(s,d[0],o),d[0];const p=new xe;o.extensions&&J(s,p,o),n.associations.set(p,{meshes:e});for(let f=0,g=d.length;f<g;f++)p.add(d[f]);return p})}loadCamera(e){let n;const t=this.json.cameras[e],s=t[t.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?n=new on(mt.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):t.type==="orthographic"&&(n=new rn(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),t.name&&(n.name=this.createUniqueName(t.name)),Z(n,t),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],t=[];for(let s=0,o=n.joints.length;s<o;s++)t.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",n.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(s){const o=s.pop(),i=s,r=[],a=[];for(let l=0,u=i.length;l<u;l++){const d=i[l];if(d){r.push(d);const p=new me;o!==null&&p.fromArray(o.array,l*16),a.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[l])}return new an(r,a)})}loadAnimation(e){const n=this.json,t=this,s=n.animations[e],o=s.name?s.name:"animation_"+e,i=[],r=[],a=[],l=[],u=[];for(let d=0,p=s.channels.length;d<p;d++){const f=s.channels[d],g=s.samplers[f.sampler],w=f.target,y=w.node,T=s.parameters!==void 0?s.parameters[g.input]:g.input,M=s.parameters!==void 0?s.parameters[g.output]:g.output;w.node!==void 0&&(i.push(this.getDependency("node",y)),r.push(this.getDependency("accessor",T)),a.push(this.getDependency("accessor",M)),l.push(g),u.push(w))}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(a),Promise.all(l),Promise.all(u)]).then(function(d){const p=d[0],f=d[1],g=d[2],w=d[3],y=d[4],T=[];for(let M=0,E=p.length;M<E;M++){const b=p[M],R=f[M],I=g[M],x=w[M],N=y[M];if(b===void 0)continue;b.updateMatrix&&b.updateMatrix();const G=t._createAnimationTracks(b,R,I,x,N);if(G)for(let D=0;D<G.length;D++)T.push(G[D])}return new cn(o,void 0,T)})}createNodeMesh(e){const n=this.json,t=this,s=n.nodes[e];return s.mesh===void 0?null:t.getDependency("mesh",s.mesh).then(function(o){const i=t._getNodeRef(t.meshCache,s.mesh,o);return s.weights!==void 0&&i.traverse(function(r){if(r.isMesh)for(let a=0,l=s.weights.length;a<l;a++)r.morphTargetInfluences[a]=s.weights[a]}),i})}loadNode(e){const n=this.json,t=this,s=n.nodes[e],o=t._loadNodeShallow(e),i=[],r=s.children||[];for(let l=0,u=r.length;l<u;l++)i.push(t.getDependency("node",r[l]));const a=s.skin===void 0?Promise.resolve(null):t.getDependency("skin",s.skin);return Promise.all([o,Promise.all(i),a]).then(function(l){const u=l[0],d=l[1],p=l[2];p!==null&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(p,ts)});for(let f=0,g=d.length;f<g;f++)u.add(d[f]);return u})}_loadNodeShallow(e){const n=this.json,t=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=n.nodes[e],i=o.name?s.createUniqueName(o.name):"",r=[],a=s._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return a&&r.push(a),o.camera!==void 0&&r.push(s.getDependency("camera",o.camera).then(function(l){return s._getNodeRef(s.cameraCache,o.camera,l)})),s._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){r.push(l)}),this.nodeCache[e]=Promise.all(r).then(function(l){let u;if(o.isBone===!0?u=new ln:l.length>1?u=new xe:l.length===1?u=l[0]:u=new dt,u!==l[0])for(let d=0,p=l.length;d<p;d++)u.add(l[d]);if(o.name&&(u.userData.name=o.name,u.name=i),Z(u,o),o.extensions&&J(t,u,o),o.matrix!==void 0){const d=new me;d.fromArray(o.matrix),u.applyMatrix4(d)}else o.translation!==void 0&&u.position.fromArray(o.translation),o.rotation!==void 0&&u.quaternion.fromArray(o.rotation),o.scale!==void 0&&u.scale.fromArray(o.scale);return s.associations.has(u)||s.associations.set(u,{}),s.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const n=this.extensions,t=this.json.scenes[e],s=this,o=new xe;t.name&&(o.name=s.createUniqueName(t.name)),Z(o,t),t.extensions&&J(n,o,t);const i=t.nodes||[],r=[];for(let a=0,l=i.length;a<l;a++)r.push(s.getDependency("node",i[a]));return Promise.all(r).then(function(a){for(let u=0,d=a.length;u<d;u++)o.add(a[u]);const l=u=>{const d=new Map;for(const[p,f]of s.associations)(p instanceof be||p instanceof qe)&&d.set(p,f);return u.traverse(p=>{const f=s.associations.get(p);f!=null&&d.set(p,f)}),d};return s.associations=l(o),o})}_createAnimationTracks(e,n,t,s,o){const i=[],r=e.name?e.name:e.uuid,a=[];q[o.path]===q.weights?e.traverse(function(p){p.morphTargetInfluences&&a.push(p.name?p.name:p.uuid)}):a.push(r);let l;switch(q[o.path]){case q.weights:l=Qe;break;case q.rotation:l=Je;break;case q.position:case q.scale:l=Ze;break;default:switch(t.itemSize){case 1:l=Qe;break;case 2:case 3:default:l=Ze;break}break}const u=s.interpolation!==void 0?qn[s.interpolation]:gt,d=this._getArrayFromAccessor(t);for(let p=0,f=a.length;p<f;p++){const g=new l(a[p]+"."+q[o.path],n.array,d,u);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),i.push(g)}return i}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const t=Oe(n.constructor),s=new Float32Array(n.length);for(let o=0,i=n.length;o<i;o++)s[o]=n[o]*t;n=s}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const s=this instanceof Je?Yn:wt;return new s(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ss(m,e,n){const t=e.attributes,s=new wn;if(t.POSITION!==void 0){const r=n.json.accessors[t.POSITION],a=r.min,l=r.max;if(a!==void 0&&l!==void 0){if(s.set(new k(a[0],a[1],a[2]),new k(l[0],l[1],l[2])),r.normalized){const u=Oe(se[r.componentType]);s.min.multiplyScalar(u),s.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const r=new k,a=new k;for(let l=0,u=o.length;l<u;l++){const d=o[l];if(d.POSITION!==void 0){const p=n.json.accessors[d.POSITION],f=p.min,g=p.max;if(f!==void 0&&g!==void 0){if(a.setX(Math.max(Math.abs(f[0]),Math.abs(g[0]))),a.setY(Math.max(Math.abs(f[1]),Math.abs(g[1]))),a.setZ(Math.max(Math.abs(f[2]),Math.abs(g[2]))),p.normalized){const w=Oe(se[p.componentType]);a.multiplyScalar(w)}r.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(r)}m.boundingBox=s;const i=new Tn;s.getCenter(i.center),i.radius=s.min.distanceTo(s.max)/2,m.boundingSphere=i}function ot(m,e,n){const t=e.attributes,s=[];function o(i,r){return n.getDependency("accessor",i).then(function(a){m.setAttribute(r,a)})}for(const i in t){const r=Ie[i]||i.toLowerCase();r in m.attributes||s.push(o(t[i],r))}if(e.indices!==void 0&&!m.index){const i=n.getDependency("accessor",e.indices).then(function(r){m.setIndex(r)});s.push(i)}return Ye.workingColorSpace!==V&&"COLOR_0"in t&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(Ye.workingColorSpace,'" not supported.')),Z(m,e),ss(m,e,n),Promise.all(s).then(function(){return e.targets!==void 0?Qn(m,e.targets,n):m})}const Re=new WeakMap;class os extends lt{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,t,s){const o=new fe(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,i=>{this.parse(i,n,s)},t,s)}parse(e,n,t){this.decodeDracoFile(e,n,null,null,$).catch(t)}decodeDracoFile(e,n,t,s,o=V){const i={attributeIDs:t||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!t,vertexColorSpace:o};return this.decodeGeometry(e,i).then(n)}decodeGeometry(e,n){const t=JSON.stringify(n);if(Re.has(e)){const a=Re.get(e);if(a.key===t)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const o=this.workerNextTaskID++,i=e.byteLength,r=this._getWorker(o,i).then(a=>(s=a,new Promise((l,u)=>{s._callbacks[o]={resolve:l,reject:u},s.postMessage({type:"decode",id:o,taskConfig:n,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return r.catch(()=>!0).then(()=>{s&&o&&this._releaseTask(s,o)}),Re.set(e,{key:t,promise:r}),r}_createGeometry(e){const n=new ft;e.index&&n.setIndex(new de(e.index.array,1));for(let t=0;t<e.attributes.length;t++){const s=e.attributes[t],o=s.name,i=s.array,r=s.itemSize,a=new de(i,r);o==="color"&&(this._assignVertexColorSpace(a,s.vertexColorSpace),a.normalized=!(i instanceof Float32Array)),n.setAttribute(o,a)}return n}_assignVertexColorSpace(e,n){if(n!==$)return;const t=new Q;for(let s=0,o=e.count;s<o;s++)t.fromBufferAttribute(e,s).convertSRGBToLinear(),e.setXYZ(s,t.r,t.g,t.b)}_loadLibrary(e,n){const t=new fe(this.manager);return t.setPath(this.decoderPath),t.setResponseType(n),t.setWithCredentials(this.withCredentials),new Promise((s,o)=>{t.load(e,s,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(t=>{const s=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const o=is.toString(),i=["/* draco decoder */",s,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(o){const i=o.data;switch(i.type){case"decode":s._callbacks[i.id].resolve(i);break;case"error":s._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,o){return s._taskLoad>o._taskLoad?-1:1});const t=this.workerPool[this.workerPool.length-1];return t._taskCosts[e]=n,t._taskLoad+=n,t})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function is(){let m,e;onmessage=function(i){const r=i.data;switch(r.type){case"init":m=r.decoderConfig,e=new Promise(function(u){m.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(m)});break;case"decode":const a=r.buffer,l=r.taskConfig;e.then(u=>{const d=u.draco,p=new d.Decoder;try{const f=n(d,p,new Int8Array(a),l),g=f.attributes.map(w=>w.array.buffer);f.index&&g.push(f.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:f},g)}catch(f){console.error(f),self.postMessage({type:"error",id:r.id,error:f.message})}finally{d.destroy(p)}});break}};function n(i,r,a,l){const u=l.attributeIDs,d=l.attributeTypes;let p,f;const g=r.GetEncodedGeometryType(a);if(g===i.TRIANGULAR_MESH)p=new i.Mesh,f=r.DecodeArrayToMesh(a,a.byteLength,p);else if(g===i.POINT_CLOUD)p=new i.PointCloud,f=r.DecodeArrayToPointCloud(a,a.byteLength,p);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||p.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const w={index:null,attributes:[]};for(const y in u){const T=self[d[y]];let M,E;if(l.useUniqueIDs)E=u[y],M=r.GetAttributeByUniqueId(p,E);else{if(E=r.GetAttributeId(p,i[u[y]]),E===-1)continue;M=r.GetAttribute(p,E)}const b=s(i,r,p,y,T,M);y==="color"&&(b.vertexColorSpace=l.vertexColorSpace),w.attributes.push(b)}return g===i.TRIANGULAR_MESH&&(w.index=t(i,r,p)),i.destroy(p),w}function t(i,r,a){const u=a.num_faces()*3,d=u*4,p=i._malloc(d);r.GetTrianglesUInt32Array(a,d,p);const f=new Uint32Array(i.HEAPF32.buffer,p,u).slice();return i._free(p),{array:f,itemSize:1}}function s(i,r,a,l,u,d){const p=d.num_components(),g=a.num_points()*p,w=g*u.BYTES_PER_ELEMENT,y=o(i,u),T=i._malloc(w);r.GetAttributeDataArrayForAllPoints(a,d,y,w,T);const M=new u(i.HEAPF32.buffer,T,g).slice();return i._free(T),{name:l,array:M,itemSize:p}}function o(i,r){switch(r){case Float32Array:return i.DT_FLOAT32;case Int8Array:return i.DT_INT8;case Int16Array:return i.DT_INT16;case Int32Array:return i.DT_INT32;case Uint8Array:return i.DT_UINT8;case Uint16Array:return i.DT_UINT16;case Uint32Array:return i.DT_UINT32}}}const it={type:"change"},Pe={type:"start"},rt={type:"end"},pe=new Mn,at=new bn,rs=Math.cos(70*mt.DEG2RAD);class as extends xn{constructor(e,n){super(),this.object=e,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new k,this.cursor=new k,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:te.ROTATE,MIDDLE:te.DOLLY,RIGHT:te.PAN},this.touches={ONE:ne.ROTATE,TWO:ne.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(h){h.addEventListener("keydown",Te),this._domElementKeyEvents=h},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Te),this._domElementKeyEvents=null},this.saveState=function(){t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=function(){t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(it),t.update(),o=s.NONE},this.update=function(){const h=new k,A=new ge().setFromUnitVectors(e.up,new k(0,1,0)),_=A.clone().invert(),O=new k,v=new ge,ee=new k,Y=2*Math.PI;return function(Nt=null){const Xe=t.object.position;h.copy(Xe).sub(t.target),h.applyQuaternion(A),r.setFromVector3(h),t.autoRotate&&o===s.NONE&&H(G(Nt)),t.enableDamping?(r.theta+=a.theta*t.dampingFactor,r.phi+=a.phi*t.dampingFactor):(r.theta+=a.theta,r.phi+=a.phi);let K=t.minAzimuthAngle,z=t.maxAzimuthAngle;isFinite(K)&&isFinite(z)&&(K<-Math.PI?K+=Y:K>Math.PI&&(K-=Y),z<-Math.PI?z+=Y:z>Math.PI&&(z-=Y),K<=z?r.theta=Math.max(K,Math.min(z,r.theta)):r.theta=r.theta>(K+z)/2?Math.max(K,r.theta):Math.min(z,r.theta)),r.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,r.phi)),r.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(u,t.dampingFactor):t.target.add(u),t.target.sub(t.cursor),t.target.clampLength(t.minTargetRadius,t.maxTargetRadius),t.target.add(t.cursor),t.zoomToCursor&&I||t.object.isOrthographicCamera?r.radius=ye(r.radius):r.radius=ye(r.radius*l),h.setFromSpherical(r),h.applyQuaternion(_),Xe.copy(t.target).add(h),t.object.lookAt(t.target),t.enableDamping===!0?(a.theta*=1-t.dampingFactor,a.phi*=1-t.dampingFactor,u.multiplyScalar(1-t.dampingFactor)):(a.set(0,0,0),u.set(0,0,0));let Me=!1;if(t.zoomToCursor&&I){let ie=null;if(t.object.isPerspectiveCamera){const re=h.length();ie=ye(re*l);const he=re-ie;t.object.position.addScaledVector(b,he),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const re=new k(R.x,R.y,0);re.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/l)),t.object.updateProjectionMatrix(),Me=!0;const he=new k(R.x,R.y,0);he.unproject(t.object),t.object.position.sub(he).add(re),t.object.updateMatrixWorld(),ie=h.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;ie!==null&&(this.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(ie).add(t.object.position):(pe.origin.copy(t.object.position),pe.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(pe.direction))<rs?e.lookAt(t.target):(at.setFromNormalAndCoplanarPoint(t.object.up,t.target),pe.intersectPlane(at,t.target))))}else t.object.isOrthographicCamera&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/l)),t.object.updateProjectionMatrix(),Me=!0);return l=1,I=!1,Me||O.distanceToSquared(t.object.position)>i||8*(1-v.dot(t.object.quaternion))>i||ee.distanceToSquared(t.target)>0?(t.dispatchEvent(it),O.copy(t.object.position),v.copy(t.object.quaternion),ee.copy(t.target),!0):!1}}(),this.dispose=function(){t.domElement.removeEventListener("contextmenu",Ve),t.domElement.removeEventListener("pointerdown",Ke),t.domElement.removeEventListener("pointercancel",oe),t.domElement.removeEventListener("wheel",ze),t.domElement.removeEventListener("pointermove",we),t.domElement.removeEventListener("pointerup",oe),t._domElementKeyEvents!==null&&(t._domElementKeyEvents.removeEventListener("keydown",Te),t._domElementKeyEvents=null)};const t=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=s.NONE;const i=1e-6,r=new $e,a=new $e;let l=1;const u=new k,d=new B,p=new B,f=new B,g=new B,w=new B,y=new B,T=new B,M=new B,E=new B,b=new k,R=new B;let I=!1;const x=[],N={};function G(h){return h!==null?2*Math.PI/60*t.autoRotateSpeed*h:2*Math.PI/60/60*t.autoRotateSpeed}function D(){return Math.pow(.95,t.zoomSpeed)}function H(h){a.theta-=h}function j(h){a.phi-=h}const P=function(){const h=new k;return function(_,O){h.setFromMatrixColumn(O,0),h.multiplyScalar(-_),u.add(h)}}(),C=function(){const h=new k;return function(_,O){t.screenSpacePanning===!0?h.setFromMatrixColumn(O,1):(h.setFromMatrixColumn(O,0),h.crossVectors(t.object.up,h)),h.multiplyScalar(_),u.add(h)}}(),U=function(){const h=new k;return function(_,O){const v=t.domElement;if(t.object.isPerspectiveCamera){const ee=t.object.position;h.copy(ee).sub(t.target);let Y=h.length();Y*=Math.tan(t.object.fov/2*Math.PI/180),P(2*_*Y/v.clientHeight,t.object.matrix),C(2*O*Y/v.clientHeight,t.object.matrix)}else t.object.isOrthographicCamera?(P(_*(t.object.right-t.object.left)/t.object.zoom/v.clientWidth,t.object.matrix),C(O*(t.object.top-t.object.bottom)/t.object.zoom/v.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}}();function X(h){t.object.isPerspectiveCamera||t.object.isOrthographicCamera?l/=h:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function ke(h){t.object.isPerspectiveCamera||t.object.isOrthographicCamera?l*=h:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function De(h){if(!t.zoomToCursor)return;I=!0;const A=t.domElement.getBoundingClientRect(),_=h.clientX-A.left,O=h.clientY-A.top,v=A.width,ee=A.height;R.x=_/v*2-1,R.y=-(O/ee)*2+1,b.set(R.x,R.y,1).unproject(t.object).sub(t.object.position).normalize()}function ye(h){return Math.max(t.minDistance,Math.min(t.maxDistance,h))}function Ne(h){d.set(h.clientX,h.clientY)}function Tt(h){De(h),T.set(h.clientX,h.clientY)}function Ge(h){g.set(h.clientX,h.clientY)}function At(h){p.set(h.clientX,h.clientY),f.subVectors(p,d).multiplyScalar(t.rotateSpeed);const A=t.domElement;H(2*Math.PI*f.x/A.clientHeight),j(2*Math.PI*f.y/A.clientHeight),d.copy(p),t.update()}function Mt(h){M.set(h.clientX,h.clientY),E.subVectors(M,T),E.y>0?X(D()):E.y<0&&ke(D()),T.copy(M),t.update()}function bt(h){w.set(h.clientX,h.clientY),y.subVectors(w,g).multiplyScalar(t.panSpeed),U(y.x,y.y),g.copy(w),t.update()}function xt(h){De(h),h.deltaY<0?ke(D()):h.deltaY>0&&X(D()),t.update()}function Et(h){let A=!1;switch(h.code){case t.keys.UP:h.ctrlKey||h.metaKey||h.shiftKey?j(2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):U(0,t.keyPanSpeed),A=!0;break;case t.keys.BOTTOM:h.ctrlKey||h.metaKey||h.shiftKey?j(-2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):U(0,-t.keyPanSpeed),A=!0;break;case t.keys.LEFT:h.ctrlKey||h.metaKey||h.shiftKey?H(2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):U(t.keyPanSpeed,0),A=!0;break;case t.keys.RIGHT:h.ctrlKey||h.metaKey||h.shiftKey?H(-2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):U(-t.keyPanSpeed,0),A=!0;break}A&&(h.preventDefault(),t.update())}function ve(){if(x.length===1)d.set(x[0].pageX,x[0].pageY);else{const h=.5*(x[0].pageX+x[1].pageX),A=.5*(x[0].pageY+x[1].pageY);d.set(h,A)}}function Be(){if(x.length===1)g.set(x[0].pageX,x[0].pageY);else{const h=.5*(x[0].pageX+x[1].pageX),A=.5*(x[0].pageY+x[1].pageY);g.set(h,A)}}function Fe(){const h=x[0].pageX-x[1].pageX,A=x[0].pageY-x[1].pageY,_=Math.sqrt(h*h+A*A);T.set(0,_)}function St(){t.enableZoom&&Fe(),t.enablePan&&Be()}function Lt(){t.enableZoom&&Fe(),t.enableRotate&&ve()}function He(h){if(x.length==1)p.set(h.pageX,h.pageY);else{const _=Ae(h),O=.5*(h.pageX+_.x),v=.5*(h.pageY+_.y);p.set(O,v)}f.subVectors(p,d).multiplyScalar(t.rotateSpeed);const A=t.domElement;H(2*Math.PI*f.x/A.clientHeight),j(2*Math.PI*f.y/A.clientHeight),d.copy(p)}function je(h){if(x.length===1)w.set(h.pageX,h.pageY);else{const A=Ae(h),_=.5*(h.pageX+A.x),O=.5*(h.pageY+A.y);w.set(_,O)}y.subVectors(w,g).multiplyScalar(t.panSpeed),U(y.x,y.y),g.copy(w)}function Ue(h){const A=Ae(h),_=h.pageX-A.x,O=h.pageY-A.y,v=Math.sqrt(_*_+O*O);M.set(0,v),E.set(0,Math.pow(M.y/T.y,t.zoomSpeed)),X(E.y),T.copy(M)}function Rt(h){t.enableZoom&&Ue(h),t.enablePan&&je(h)}function Pt(h){t.enableZoom&&Ue(h),t.enableRotate&&He(h)}function Ke(h){t.enabled!==!1&&(x.length===0&&(t.domElement.setPointerCapture(h.pointerId),t.domElement.addEventListener("pointermove",we),t.domElement.addEventListener("pointerup",oe)),kt(h),h.pointerType==="touch"?It(h):Ct(h))}function we(h){t.enabled!==!1&&(h.pointerType==="touch"?Ot(h):_t(h))}function oe(h){Dt(h),x.length===0&&(t.domElement.releasePointerCapture(h.pointerId),t.domElement.removeEventListener("pointermove",we),t.domElement.removeEventListener("pointerup",oe)),t.dispatchEvent(rt),o=s.NONE}function Ct(h){let A;switch(h.button){case 0:A=t.mouseButtons.LEFT;break;case 1:A=t.mouseButtons.MIDDLE;break;case 2:A=t.mouseButtons.RIGHT;break;default:A=-1}switch(A){case te.DOLLY:if(t.enableZoom===!1)return;Tt(h),o=s.DOLLY;break;case te.ROTATE:if(h.ctrlKey||h.metaKey||h.shiftKey){if(t.enablePan===!1)return;Ge(h),o=s.PAN}else{if(t.enableRotate===!1)return;Ne(h),o=s.ROTATE}break;case te.PAN:if(h.ctrlKey||h.metaKey||h.shiftKey){if(t.enableRotate===!1)return;Ne(h),o=s.ROTATE}else{if(t.enablePan===!1)return;Ge(h),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&t.dispatchEvent(Pe)}function _t(h){switch(o){case s.ROTATE:if(t.enableRotate===!1)return;At(h);break;case s.DOLLY:if(t.enableZoom===!1)return;Mt(h);break;case s.PAN:if(t.enablePan===!1)return;bt(h);break}}function ze(h){t.enabled===!1||t.enableZoom===!1||o!==s.NONE||(h.preventDefault(),t.dispatchEvent(Pe),xt(h),t.dispatchEvent(rt))}function Te(h){t.enabled===!1||t.enablePan===!1||Et(h)}function It(h){switch(We(h),x.length){case 1:switch(t.touches.ONE){case ne.ROTATE:if(t.enableRotate===!1)return;ve(),o=s.TOUCH_ROTATE;break;case ne.PAN:if(t.enablePan===!1)return;Be(),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(t.touches.TWO){case ne.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;St(),o=s.TOUCH_DOLLY_PAN;break;case ne.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Lt(),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&t.dispatchEvent(Pe)}function Ot(h){switch(We(h),o){case s.TOUCH_ROTATE:if(t.enableRotate===!1)return;He(h),t.update();break;case s.TOUCH_PAN:if(t.enablePan===!1)return;je(h),t.update();break;case s.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Rt(h),t.update();break;case s.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Pt(h),t.update();break;default:o=s.NONE}}function Ve(h){t.enabled!==!1&&h.preventDefault()}function kt(h){x.push(h)}function Dt(h){delete N[h.pointerId];for(let A=0;A<x.length;A++)if(x[A].pointerId==h.pointerId){x.splice(A,1);return}}function We(h){let A=N[h.pointerId];A===void 0&&(A=new B,N[h.pointerId]=A),A.set(h.pageX,h.pageY)}function Ae(h){const A=h.pointerId===x[0].pointerId?x[1]:x[0];return N[A.pointerId]}t.domElement.addEventListener("contextmenu",Ve),t.domElement.addEventListener("pointerdown",Ke),t.domElement.addEventListener("pointercancel",oe),t.domElement.addEventListener("wheel",ze,{passive:!1}),this.update()}}class ue{constructor(e){L(this,"mesh");L(this,"dirtyLevel",100);L(this,"position");this.position=e}getMesh(){return this.mesh}clean(e){this.dirtyLevel=Math.max(0,this.dirtyLevel-e),this.mesh.traverse(n=>{n instanceof c.Mesh&&n.material instanceof c.Material&&n.material.transparent&&(n.material.opacity=.3+this.dirtyLevel/100*.7)})}getDirtLevel(){return this.dirtyLevel}isClean(){return this.dirtyLevel===0}}class cs extends ue{createMesh(){const e=new c.Group,n=new c.Mesh(new c.BoxGeometry(20,15,15),new c.MeshPhongMaterial({color:16115411,transparent:!1,opacity:1})),t=new c.Mesh(new c.BoxGeometry(21,1,16),new c.MeshPhongMaterial({color:8092539}));t.position.y=-7.5;const s=new c.Mesh(new c.BoxGeometry(8,8,12),new c.MeshPhongMaterial({color:16115411,transparent:!1,opacity:1}));s.position.set(-14,-2,0);const o=s.clone();o.position.set(14,-2,0);const i=new c.Mesh(new c.BoxGeometry(21,2,16),new c.MeshPhongMaterial({color:0,transparent:!1,opacity:1}));i.position.y=7.5;const r=new c.MeshPhongMaterial({color:16777215,transparent:!1,opacity:1}),a=new c.Mesh(new c.BoxGeometry(.8,2,.5),r);a.position.set(-3,7,8.1),a.rotation.z=Math.PI*.1;const l=new c.Mesh(new c.BoxGeometry(.8,2,.5),r);l.position.set(-2,7,8.1),l.rotation.z=-Math.PI*.1;const u=new c.Mesh(new c.BoxGeometry(.8,2.5,.5),r);u.position.set(-.8,7,8.1),u.rotation.z=Math.PI*.1;const d=new c.Mesh(new c.BoxGeometry(.8,1.5,.5),r);d.position.set(.2,6.5,8.1),d.rotation.z=-Math.PI*.1;const p=new c.Mesh(new c.BoxGeometry(.8,1.5,.5),r);p.position.set(1.2,6.5,8.1),p.rotation.z=Math.PI*.1;const f=new c.Mesh(new c.BoxGeometry(.8,2.5,.5),r);f.position.set(2.2,7,8.1),f.rotation.z=-Math.PI*.1;const g=new c.Mesh(new c.BoxGeometry(.8,2.5,.5),r);g.position.set(3.8,7,8.1);const w=new c.Mesh(new c.CylinderGeometry(1,1.5,.5,16,1,!1,-Math.PI/2,Math.PI),r);w.rotation.x=Math.PI/2,w.rotation.y=Math.PI/2,w.position.set(3.8,7,8.1);const y=new c.BoxGeometry(9,2,13),T=new c.MeshPhongMaterial({color:0}),M=new c.Mesh(y,T);M.position.set(-14,2,0);const E=M.clone();E.position.set(14,2,0);const b=new c.BoxGeometry(2.5,4,.2),R=new c.MeshPhongMaterial({color:11393254,transparent:!0,opacity:.7}),I=new c.BoxGeometry(3,4.5,.3),x=new c.MeshPhongMaterial({color:16777215});[[-7,0,7.6],[-2.3,0,7.6],[2.3,0,7.6],[7,0,7.6],[-7,5,7.6],[-2.3,5,7.6],[2.3,5,7.6],[7,5,7.6],[-10.1,0,0],[-10.1,5,0],[10.1,0,0],[10.1,5,0],[-14,0,4],[-14,0,-4],[14,0,4],[14,0,-4]].forEach((D,H)=>{const j=new c.Mesh(I,x),P=new c.Mesh(b,R);j.position.set(D[0],D[1],D[2]),P.position.set(D[0],D[1],D[2]+.1),H>=8&&H<12&&(j.rotation.y=Math.PI/2,P.rotation.y=Math.PI/2),e.add(j),e.add(P)});const G=new c.Mesh(new c.BoxGeometry(6,8,1),new c.MeshPhongMaterial({color:16777215}));G.position.set(0,-2,7.6),e.add(n),e.add(t),e.add(s),e.add(o),e.add(i),e.add(M),e.add(E),e.add(G),e.add(a),e.add(l),e.add(u),e.add(d),e.add(p),e.add(f),e.add(g),e.add(w),e.position.copy(this.position),this.mesh=e}}class ls extends ue{createMesh(){const e=new c.Group,n=new c.Mesh(new c.BoxGeometry(10,8,16),new c.MeshPhongMaterial({color:16119260,transparent:!0,opacity:1})),t=new c.Mesh(new c.BoxGeometry(4,12,4),new c.MeshPhongMaterial({color:15263976,transparent:!0,opacity:1}));t.position.set(0,10,-4);const s=new c.ConeGeometry(3,6,4),o=new c.Mesh(s,new c.MeshPhongMaterial({color:9127187,transparent:!0,opacity:1}));o.position.set(0,19,-4);const i=new c.Mesh(new c.BoxGeometry(.4,2,.4),new c.MeshPhongMaterial({color:16766720})),r=new c.Mesh(new c.BoxGeometry(1.2,.4,.4),new c.MeshPhongMaterial({color:16766720})),a=new c.Group;a.add(i),a.add(r),a.position.set(0,23,-4);const l=new c.BoxGeometry(1.2,4,.2),u=new c.MeshPhongMaterial({color:8900331,transparent:!0,opacity:.8});for(let M=-5;M<=5;M+=5){const E=new c.Mesh(l,u);E.position.set(-5.1,0,M),E.rotation.y=Math.PI/2,e.add(E);const b=new c.Mesh(l,u);b.position.set(5.1,0,M),b.rotation.y=Math.PI/2,e.add(b)}const d=new c.CylinderGeometry(2,2,.2,16),p=new c.Mesh(d,new c.MeshPhongMaterial({color:8900331,transparent:!0,opacity:.8}));p.rotation.x=Math.PI/2,p.position.set(0,4,8.1);const f=new c.Mesh(new c.BoxGeometry(4,6,.5),new c.MeshPhongMaterial({color:9127187}));f.position.set(0,-1,8.1);const g=new c.Mesh(new c.BoxGeometry(3.6,5.6,.2),new c.MeshPhongMaterial({color:4863264}));g.position.set(0,-1,8.3);const w=new c.Mesh(new c.BoxGeometry(6,1,2),new c.MeshPhongMaterial({color:8421504}));w.position.set(0,-4,9);const y=new c.BoxGeometry(11,.5,17),T=new c.Mesh(y,new c.MeshPhongMaterial({color:9127187}));T.position.y=4.25,e.add(n),e.add(t),e.add(o),e.add(a),e.add(f),e.add(g),e.add(w),e.add(T),e.add(p),e.position.copy(this.position),this.mesh=e}}class ds extends ue{createMesh(){const e=new c.Group,n=new c.CylinderGeometry(3,3,15,32),t=new c.Mesh(n,new c.MeshPhongMaterial({color:12632256,transparent:!0,opacity:1,shininess:100})),s=new c.ConeGeometry(3,4,32),o=new c.Mesh(s,new c.MeshPhongMaterial({color:12105912,transparent:!0,opacity:1,shininess:100}));o.position.y=9.5;const i=new c.TorusGeometry(3.2,.3,16,32),r=new c.Mesh(i,new c.MeshPhongMaterial({color:8421504}));r.rotation.x=Math.PI/2,r.position.y=-7.5;const a=r.clone();a.position.y=7.5;const l=new c.CylinderGeometry(3.5,4.5,2,8),u=new c.Mesh(l,new c.MeshPhongMaterial({color:6316128}));u.position.y=-8;for(let d=0;d<8;d++){const p=d/8*Math.PI*2,f=new c.BoxGeometry(.2,15,.2),g=new c.Mesh(f,new c.MeshPhongMaterial({color:11053224}));g.position.set(Math.cos(p)*3.1,0,Math.sin(p)*3.1),e.add(g)}e.add(t),e.add(o),e.add(r),e.add(a),e.add(u),e.position.copy(this.position),this.mesh=e}}class us extends ue{createMesh(){const e=new c.Group,n=new c.BoxGeometry(12,40,12),t=new c.MeshPhongMaterial({color:3100495,transparent:!0,opacity:1,shininess:100}),s=new c.Mesh(n,t),o=new c.PlaneGeometry(11,38),i=new c.MeshPhongMaterial({color:4620980,transparent:!0,opacity:.6,shininess:100,side:c.DoubleSide}),r=new c.Mesh(o,i);r.position.set(0,0,6.01);const a=new c.Mesh(o,i);a.position.set(0,0,-6.01),a.rotation.y=Math.PI;const l=new c.Mesh(o,i);l.position.set(-6.01,0,0),l.rotation.y=-Math.PI/2;const u=new c.Mesh(o,i);u.position.set(6.01,0,0),u.rotation.y=Math.PI/2;const d=12,p=3;for(let E=0;E<d;E++){const b=-18+E*p,R=new c.Mesh(new c.BoxGeometry(12.1,.2,12.1),new c.MeshPhongMaterial({color:4868682}));R.position.y=b,e.add(R)}[[-5.5,0,6],[5.5,0,6],[-5.5,0,-6],[5.5,0,-6],[-6,0,-5.5],[-6,0,5.5],[6,0,-5.5],[6,0,5.5]].forEach(E=>{const b=new c.Mesh(new c.BoxGeometry(.3,40,.3),new c.MeshPhongMaterial({color:3100495}));b.position.set(E[0],0,E[1]),e.add(b)});const g=new c.Mesh(new c.BoxGeometry(13,1,13),new c.MeshPhongMaterial({color:4868682,shininess:50}));g.position.y=20.5;const w=new c.Mesh(new c.BoxGeometry(8,3,8),new c.MeshPhongMaterial({color:3100495}));w.position.y=22;const y=new c.Mesh(new c.BoxGeometry(8,4,2),new c.MeshPhongMaterial({color:4868682}));y.position.set(0,-18,7);const T=new c.Mesh(new c.BoxGeometry(8,.3,3),new c.MeshPhongMaterial({color:3100495}));T.position.set(0,-16,7.5);const M=new c.Mesh(new c.PlaneGeometry(6,3.5),new c.MeshPhongMaterial({color:4620980,transparent:!0,opacity:.8,side:c.DoubleSide}));M.position.set(0,-18,8.1),e.add(s),e.add(r),e.add(a),e.add(l),e.add(u),e.add(g),e.add(w),e.add(y),e.add(T),e.add(M),e.position.copy(this.position),this.mesh=e}}class hs extends ue{createMesh(){const e=new c.Group,n=new c.CylinderGeometry(4,4,6,32),t=new c.MeshPhongMaterial({color:5263440,transparent:!0,opacity:1,shininess:60}),s=new c.Mesh(n,t);s.position.y=15;const o=new c.SphereGeometry(4,32,16,0,Math.PI*2,0,Math.PI/2),i=new c.Mesh(o,t);i.position.y=12;const r=new c.SphereGeometry(4,32,16,0,Math.PI*2,Math.PI/2,Math.PI/2),a=new c.Mesh(r,t);a.position.y=18;const l=new c.ConeGeometry(4.5,2.5,32),u=new c.MeshPhongMaterial({color:9109504,shininess:30}),d=new c.Mesh(l,u);d.position.y=19.5;const p=new c.CylinderGeometry(.8,.8,24,12),f=new c.MeshPhongMaterial({color:3092271,shininess:30}),g=new c.Mesh(p,f);g.position.y=0,[[-2.5,0,-2.5],[2.5,0,-2.5],[-2.5,0,2.5],[2.5,0,2.5]].forEach(P=>{const C=new c.Mesh(new c.CylinderGeometry(.4,.4,24,8),f);C.position.set(P[0],0,P[1]),e.add(C)}),[-6,-2,2,6,10].forEach(P=>{const C=new c.Mesh(new c.TorusGeometry(3.5,.2,16,32),f);C.rotation.x=Math.PI/2,C.position.y=P,e.add(C)});const T=new c.CylinderGeometry(.15,.15,7.5,8);[-4,0,4,8].forEach(P=>{for(let C=0;C<Math.PI*2;C+=Math.PI/2){const U=new c.Mesh(T,f);U.position.y=P,U.rotation.z=Math.PI/4,U.rotation.y=C,e.add(U);const X=new c.Mesh(T,f);X.position.y=P,X.rotation.z=-Math.PI/4,X.rotation.y=C,e.add(X)}});const E=new c.CylinderGeometry(4.5,4.5,.3,32),b=new c.Mesh(E,f);b.position.y=11;const R=new c.TorusGeometry(4.5,.05,8,32),I=new c.Mesh(R,f);I.rotation.x=Math.PI/2,I.position.y=12;for(let P=0;P<Math.PI*2;P+=Math.PI/8){const C=new c.Mesh(new c.CylinderGeometry(.05,.05,1,4),f);C.position.set(4.5*Math.cos(P),11.5,4.5*Math.sin(P)),e.add(C)}const x=24,N=.6,G=1,D=new c.CylinderGeometry(.05,.05,x,4),H=new c.Mesh(D,f),j=new c.Mesh(D,f);H.position.set(-N/2,x/2-12,4.2),j.position.set(N/2,x/2-12,4.2),e.add(H),e.add(j);for(let P=0;P<x;P+=G){const C=new c.Mesh(new c.CylinderGeometry(.025,.025,N,4),f);C.rotation.x=Math.PI/2,C.position.set(0,P-12,4.2),e.add(C)}e.add(s),e.add(i),e.add(a),e.add(d),e.add(g),e.add(b),e.add(I),e.position.copy(this.position),this.mesh=e}}class ps{constructor(){L(this,"scene");L(this,"camera");L(this,"fpvCamera");L(this,"followCamera");L(this,"activeCamera");L(this,"renderer");L(this,"drone",null);L(this,"buildings",[]);L(this,"controls");L(this,"cleaningRadius",2);L(this,"cleaningPower",1);L(this,"isSprayOn",!1);L(this,"spraySystem",null);L(this,"propellers",[]);L(this,"propellerSpeed",1.1);L(this,"warningTimeout",null);L(this,"cameraMode","follow");L(this,"keysPressed",{});L(this,"lastFrameTime",performance.now());L(this,"logos",[]);L(this,"score",0);L(this,"hasWon",!1);L(this,"gameStarted",!1);L(this,"gameMode",null);L(this,"startScreenContainer",null);this.scene=new c.Scene,this.scene.background=new c.Color(8900331),this.camera=new c.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,15,30),this.fpvCamera=new c.PerspectiveCamera(90,window.innerWidth/window.innerHeight,.1,1e3),this.followCamera=new c.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.activeCamera=this.followCamera,this.renderer=new c.WebGLRenderer({antialias:!0,alpha:!0,powerPreference:"default"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=c.PCFSoftShadowMap,this.renderer.outputColorSpace=c.SRGBColorSpace,this.renderer.toneMapping=c.ACESFilmicToneMapping,this.renderer.toneMappingExposure=1,document.body.appendChild(this.renderer.domElement),this.createStartScreen(),this.controls=new as(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.maxPolarAngle=Math.PI/2,this.controls.minDistance=5,this.controls.maxDistance=100,this.controls.enabled=!1,this.animate()}createStartScreen(){this.startScreenContainer=document.createElement("div"),this.startScreenContainer.style.position="fixed",this.startScreenContainer.style.top="0",this.startScreenContainer.style.left="0",this.startScreenContainer.style.width="100%",this.startScreenContainer.style.height="100%",this.startScreenContainer.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.startScreenContainer.style.display="flex",this.startScreenContainer.style.flexDirection="column",this.startScreenContainer.style.alignItems="center",this.startScreenContainer.style.justifyContent="center",this.startScreenContainer.style.zIndex="1000";const e=document.createElement("img");e.src="/drone-game/start.png",e.style.width="400px",e.style.marginBottom="40px",this.startScreenContainer.appendChild(e);const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.gap="20px";const t=this.createModeButton("Learning Mode","Learn about Lucid Bots while flying the drone","learning");n.appendChild(t);const s=this.createModeButton("Speed Mode","Test your drone piloting skills","speed");n.appendChild(s),this.startScreenContainer.appendChild(n),document.body.appendChild(this.startScreenContainer)}createModeButton(e,n,t){const s=document.createElement("div");s.style.backgroundColor="#00B4D8",s.style.padding="20px 40px",s.style.borderRadius="10px",s.style.cursor="pointer",s.style.textAlign="center",s.style.transition="transform 0.2s, background-color 0.2s",s.style.width="400px";const o=document.createElement("h2");o.textContent=e,o.style.color="white",o.style.margin="0 0 10px 0",o.style.fontFamily="Arial, sans-serif";const i=document.createElement("p");return i.textContent=n,i.style.color="white",i.style.margin="0",i.style.fontFamily="Arial, sans-serif",s.appendChild(o),s.appendChild(i),s.onmouseover=()=>{s.style.backgroundColor="#0096B4",s.style.transform="scale(1.05)"},s.onmouseout=()=>{s.style.backgroundColor="#00B4D8",s.style.transform="scale(1)"},s.onclick=()=>this.startGame(t),s}startGame(e){this.gameMode=e,this.gameStarted=!0,this.startScreenContainer&&(document.body.removeChild(this.startScreenContainer),this.startScreenContainer=null),this.setupLighting(),this.setupControlsUI(),this.loadDroneModel(),this.addBuildings(),this.addGround(),this.addLogos(),this.updateScoreDisplay(),this.createWarningPopup(),window.addEventListener("resize",this.onWindowResize.bind(this)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),this.updateUIForGameMode()}updateUIForGameMode(){const e=document.getElementById("info");e&&(this.gameMode==="learning"?e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Learning Mode: Collect logos to learn about Lucid Bots!</p>\n                </div>\n            ':(e.innerHTML+='\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid white;">\n                    <p style="margin: 0;">Speed Mode: Collect all logos as fast as you can!</p>\n                    <p id="timer" style="margin: 5px 0 0 0;">Time: 0:00</p>\n                </div>\n            ',this.startSpeedModeTimer()))}startSpeedModeTimer(){if(this.gameMode!=="speed")return;const e=Date.now(),n=document.getElementById("timer"),t=()=>{if(!this.hasWon&&n){const s=Math.floor((Date.now()-e)/1e3),o=Math.floor(s/60),i=s%60;n.textContent="Time: ".concat(o,":").concat(i.toString().padStart(2,"0")),requestAnimationFrame(t)}};t()}setupLighting(){const e=new c.AmbientLight(16777215,.6);this.scene.add(e);const n=new c.DirectionalLight(16777215,1);n.position.set(50,50,50),n.castShadow=!0,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,n.shadow.camera.near=.5,n.shadow.camera.far=500,this.scene.add(n);const t=new c.HemisphereLight(16777215,4473924,.6);this.scene.add(t)}setupControlsUI(){let e=document.getElementById("info");e||(e=document.createElement("div"),e.id="info",document.body.appendChild(e)),e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.backgroundColor="rgba(0, 0, 0, 0.7)",e.style.color="white",e.style.padding="10px",e.style.borderRadius="8px",e.style.fontFamily="Arial, sans-serif",e.innerHTML='\n            <h3 style="margin:0; font-size:18px;">Game Controls</h3>\n            <ul style="list-style:none; padding:0; margin:5px 0;">\n                <li>Arrow Keys: Move Drone</li>\n                <li>A/D: Yaw Left/Right</li>\n                <li>W/S: Up/Down</li>\n                <li>Space: Toggle Sprayer</li>\n                <li>C: Clean (when sprayer is on)</li>\n                <li>V: Toggle Camera</li>\n                <li>Mouse: Orbit Camera (if enabled)</li>\n            </ul>\n            <p id="score-display" style="margin:0; font-weight:bold;">Score: 0/5 Logos Collected!</p>\n        '}loadDroneModel(){const e=new os;e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/");const n=new En;n.setDRACOLoader(e),console.log("Attempting to load drone model..."),n.load("/drone-game/sherpaModel.glb",t=>{if(console.log("Drone model loaded successfully:",t),t.scene){const s=new c.Object3D,o=t.scene;o.rotation.x=-Math.PI/2,o.scale.set(.5,.5,.5),o.traverse(a=>{a instanceof c.Mesh&&(a.castShadow=!0,a.receiveShadow=!0,a.material&&a.material.transparent&&(a.material.opacity=.9,a.material.side=c.DoubleSide),(a.name.toLowerCase().includes("propeller")||a.name.toLowerCase().includes("prop")||a.name.toLowerCase().includes("rotor"))&&(console.log("Found propeller:",a.name),this.propellers.push(a)))}),s.add(o),s.position.set(0,5,0);const i=new c.SpotLight(16777215,1);i.position.set(0,.5,0),i.angle=Math.PI/6,i.penumbra=.5,i.decay=2,i.distance=10,s.add(i);const r=new c.PointLight(16777215,.5,5);s.add(r),this.drone=s,this.scene.add(this.drone),console.log("Drone added to scene at position:",this.drone.position),e.dispose()}else console.error("No scene found in the loaded model")},t=>{const s=Math.round(t.loaded/t.total*100);console.log("Loading progress: ".concat(s,"%"))},t=>{console.error("Error loading drone model:",t);const s=new c.Object3D,o=new c.BoxGeometry(2,1,2),i=new c.MeshPhongMaterial({color:3368703,transparent:!0,opacity:.8}),r=new c.Mesh(o,i);s.add(r),s.position.set(0,5,0);const a=new c.PointLight(16777215,.5,10);s.add(a),this.drone=s,this.scene.add(this.drone),console.log("Fallback drone cube added to scene")})}addBuildings(){const e=new cs(new c.Vector3(-20,3,-15));e.createMesh(),this.scene.add(e.getMesh()),this.buildings.push(e);const n=new ls(new c.Vector3(20,4,-15));n.createMesh(),this.scene.add(n.getMesh()),this.buildings.push(n);const t=new ds(new c.Vector3(-20,8,15));t.createMesh(),this.scene.add(t.getMesh()),this.buildings.push(t);const s=new us(new c.Vector3(20,20,15));s.createMesh(),this.scene.add(s.getMesh()),this.buildings.push(s);const o=new hs(new c.Vector3(-40,12,-35));o.createMesh(),this.scene.add(o.getMesh()),this.buildings.push(o)}addGround(){const e=new c.PlaneGeometry(100,100),n=new c.MeshPhongMaterial({color:9498256,side:c.DoubleSide}),t=new c.Mesh(e,n);t.rotation.x=-Math.PI/2,t.receiveShadow=!0,this.scene.add(t)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.fpvCamera.aspect=window.innerWidth/window.innerHeight,this.fpvCamera.updateProjectionMatrix(),this.followCamera.aspect=window.innerWidth/window.innerHeight,this.followCamera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(e){switch(this.keysPressed[e.key.toLowerCase()]=!0,e.key.toLowerCase()){case" ":this.isSprayOn=!this.isSprayOn,this.isSprayOn&&!this.spraySystem&&this.createSpraySystem();break;case"c":this.isSprayOn&&this.clean();break;case"v":this.toggleCamera();break}}onKeyUp(e){this.keysPressed[e.key.toLowerCase()]=!1}updateDroneMovement(e){if(!this.drone)return;const n=5,t=1.5,s=.8;this.keysPressed.a&&(this.drone.rotation.y+=t*e),this.keysPressed.d&&(this.drone.rotation.y-=t*e);let o=0,i=0;this.keysPressed.arrowdown&&(i-=1),this.keysPressed.arrowup&&(i+=1),this.keysPressed.arrowleft&&(o+=1),this.keysPressed.arrowright&&(o-=1),this.keysPressed.q&&(o-=1),this.keysPressed.e&&(o+=1);let r=0;this.keysPressed.w&&(r+=1),this.keysPressed.s&&(r-=1);const a=new c.Vector3(o,0,i);a.length()>0&&(a.normalize(),a.multiplyScalar(n*e),a.applyEuler(new c.Euler(0,this.drone.rotation.y,0)));const l=r*n*e,u=this.drone.position.clone();u.add(a),u.y=Math.max(2,u.y+l);const d=new c.Sphere(u,s);let p=!1;for(const f of this.buildings){const g=f.getMesh();if(new c.Box3().setFromObject(g).intersectsSphere(d)){p=!0,this.showCollisionWarning();break}}p||this.drone.position.copy(u)}createSpraySystem(){if(!this.drone)return;const e=1500,n=new Float32Array(e*3),t=new c.BufferGeometry,s=new c.PointsMaterial({color:35071,size:.12,transparent:!0,opacity:.8,blending:c.AdditiveBlending});for(let i=0;i<e;i++){const r=i*3,a=i/e*25;n[r]=(Math.random()-.5)*(.4+a*.15),n[r+1]=(Math.random()-.5)*(.4+a*.15),n[r+2]=-a}t.setAttribute("position",new c.BufferAttribute(n,3)),this.spraySystem=new c.Points(t,s);const o=new c.Object3D;o.rotation.x=-Math.PI,o.add(this.spraySystem),this.drone.add(o),this.spraySystem.position.set(-.15,0,0)}updateSpraySystem(){var t;if(!this.spraySystem)return;if(!this.isSprayOn){this.spraySystem.parent&&((t=this.drone)==null||t.remove(this.spraySystem.parent)),this.spraySystem.geometry.dispose(),this.spraySystem.material.dispose(),this.spraySystem=null;return}const e=this.spraySystem.geometry.attributes.position.array,n=e.length/3;for(let s=0;s<n;s++){const o=s*3;e[o+2]-=.3,e[o+2]<-10&&(e[o]=(Math.random()-.5)*.05,e[o+1]=(Math.random()-.5)*.05,e[o+2]=0),e[o]*=.99,e[o+1]*=.99}this.spraySystem.geometry.attributes.position.needsUpdate=!0}updateCameras(){if(this.drone){if(this.cameraMode==="fpv"){const e=new c.Vector3;this.drone.getWorldPosition(e),this.fpvCamera.position.copy(e);const n=new c.Vector3(-.15,.2,.15);n.applyQuaternion(this.drone.quaternion),this.fpvCamera.position.add(n),this.fpvCamera.rotation.set(0,this.drone.rotation.y+Math.PI,0)}if(this.cameraMode==="follow"){const e=new c.Vector3;this.drone.getWorldPosition(e);const n=new c.Vector3(0,1.5,-2);n.applyQuaternion(this.drone.quaternion),this.followCamera.position.copy(e).add(n);const t=new c.Vector3(0,0,1);t.applyQuaternion(this.drone.quaternion);const s=e.clone().add(t);this.followCamera.lookAt(s)}}}checkCollisions(){if(!this.drone)return;const e=new c.Vector3;this.drone.getWorldPosition(e);const n=new c.Sphere(e,.5);for(const t of this.buildings){const s=t.getMesh();if(new c.Box3().setFromObject(s).intersectsSphere(n)){this.showCollisionWarning();break}}}animate(){if(requestAnimationFrame(this.animate.bind(this)),!this.gameStarted){this.renderer.render(this.scene,this.camera);return}const e=performance.now(),n=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e,this.propellers.length>0&&this.propellers.forEach((t,s)=>{const o=s%2===0?1:-1;t.rotation.y+=this.propellerSpeed*o}),this.updateDroneMovement(n),this.spraySystem&&this.updateSpraySystem(),this.updateCameras(),this.checkCollisions(),this.checkLogoCollection(),this.logos.forEach(t=>{if(!t.userData.collected){t.quaternion.copy(this.activeCamera.quaternion),t.rotateZ(t.userData.rotationSpeed);const s=Math.sin(e*.002)*.5;t.position.y=t.userData.initialY+s}}),this.controls.update(),this.renderer.render(this.scene,this.activeCamera)}clean(){!this.drone||!this.isSprayOn||this.buildings.forEach(e=>{const n=e.getMesh().position,t=this.drone.position;new c.Vector3(n.x,n.y,n.z).distanceTo(t)<this.cleaningRadius&&e.clean(this.cleaningPower)})}toggleCamera(){switch(this.cameraMode){case"orbit":this.cameraMode="fpv",this.activeCamera=this.fpvCamera,this.controls.enabled=!1;break;case"fpv":this.cameraMode="follow",this.activeCamera=this.followCamera,this.controls.enabled=!1;break;case"follow":this.cameraMode="orbit",this.activeCamera=this.camera,this.controls.enabled=!0;break}}createWarningPopup(){if(!document.getElementById("warning-popup")){const e=document.createElement("div");e.id="warning-popup",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="rgba(255, 200, 200, 0.95)",e.style.padding="20px",e.style.borderRadius="10px",e.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",e.style.display="none",e.style.zIndex="1000",e.style.fontFamily="Arial, sans-serif",e.style.fontSize="16px",e.style.color="#333",e.style.border="2px solid #ff6b6b",e.style.maxWidth="400px",e.style.textAlign="center",document.body.appendChild(e)}}showCollisionWarning(){const e=document.getElementById("warning-popup");e&&e.style.display!=="block"&&(e.textContent="The Sherpa drone is built with a forward facing collision radar to prevent the drone from drifting into buildings",e.style.display="block",this.warningTimeout!==null&&window.clearTimeout(this.warningTimeout),this.warningTimeout=window.setTimeout(()=>{e&&(e.style.display="none"),this.warningTimeout=null},3e3))}checkLogoCollection(){if(!this.drone||!this.spraySystem||!this.isSprayOn||this.hasWon)return;const e=this.spraySystem.parent;if(!e)return;e.updateMatrixWorld();const n=e.matrixWorld,t=this.spraySystem.geometry.attributes.position.array,s=t.length/3,o=.5;this.logos.forEach(i=>{if(!i.userData.collected){const r=i.position.clone();for(let a=0;a<s;a++){const l=a*3;if(new c.Vector3(t[l],t[l+1],t[l+2]).applyMatrix4(n).distanceTo(r)<o){i.userData.collected=!0,this.scene.remove(i),i.geometry.dispose(),i.material instanceof c.Material&&i.material.dispose(),this.score++,this.playCollectionEffect(i.position.clone()),this.updateScoreDisplay(),this.gameMode==="learning"&&i.userData.info&&this.showLearningPopup(i.userData.info),this.score>=5&&this.showWinMessage();break}}}})}playCollectionEffect(e){const t=new c.BufferGeometry,s=new Float32Array(50*3),o=[];for(let u=0;u<50;u++){const d=u*3;s[d]=e.x,s[d+1]=e.y,s[d+2]=e.z,o.push(new c.Vector3((Math.random()-.5)*2,Math.random()*2,(Math.random()-.5)*2))}t.setAttribute("position",new c.BufferAttribute(s,3));const i=new c.PointsMaterial({color:16776960,size:.1,transparent:!0,opacity:1,blending:c.AdditiveBlending}),r=new c.Points(t,i);this.scene.add(r);let a=0;const l=()=>{if(a>1){this.scene.remove(r),t.dispose(),i.dispose();return}const u=t.attributes.position.array;for(let d=0;d<50;d++){const p=d*3;u[p]+=o[d].x*.1,u[p+1]+=o[d].y*.1,u[p+2]+=o[d].z*.1}t.attributes.position.needsUpdate=!0,i.opacity=1-a,a+=.05,requestAnimationFrame(l)};l()}updateScoreDisplay(){const e=document.getElementById("score-display");e&&(e.textContent="Score: ".concat(this.score,"/5 Logos Collected!"))}showWinMessage(){var a;this.hasWon=!0;const e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#00B4D8",e.style.padding="30px",e.style.borderRadius="15px",e.style.color="white",e.style.fontSize="24px",e.style.fontWeight="bold",e.style.textAlign="center",e.style.zIndex="1000",e.style.maxWidth="500px";const n=document.createElement("img");n.src="/drone-game/logo.png",n.style.width="120px",n.style.marginBottom="20px",e.appendChild(n);const t=document.createElement("div");t.style.marginBottom="20px";let s="Congratulations! You've collected all logos!";if(this.gameMode==="speed"){const l=document.getElementById("timer"),u=l?(a=l.textContent)==null?void 0:a.replace("Time: ",""):"0:00";s+="\nYour time: ".concat(u)}else this.gameMode==="learning"&&(s+="\n\nRemember:",t.innerHTML=s+'<br><br>"We believe in responsible robotics, paving the way to better lives for everyone.');t.style.lineHeight="1.4",this.gameMode==="speed"&&(t.textContent=s),e.appendChild(t);const o=document.createElement("div");o.style.fontSize="18px",o.style.marginTop="20px";const i=document.createElement("a");i.href="https://lucidbots.com",i.textContent="Visit lucidbots.com to learn more!",i.style.color="white",i.style.textDecoration="underline",i.target="_blank",o.appendChild(i),e.appendChild(o);const r=document.createElement("button");r.textContent="Play Again",r.style.marginTop="20px",r.style.padding="10px 20px",r.style.fontSize="18px",r.style.borderRadius="5px",r.style.border="none",r.style.backgroundColor="white",r.style.color="#00B4D8",r.style.cursor="pointer",r.style.transition="transform 0.2s",r.onmouseover=()=>r.style.transform="scale(1.05)",r.onmouseout=()=>r.style.transform="scale(1)",r.onclick=()=>window.location.reload(),e.appendChild(r),document.body.appendChild(e),setTimeout(()=>{document.body.removeChild(e)},1e4)}createLogo(){const e=new c.CircleGeometry(1.5,32),t=new c.TextureLoader().load("/drone-game/logo.png");t.minFilter=c.LinearFilter,t.magFilter=c.LinearFilter;const s=new c.MeshStandardMaterial({map:t,side:c.DoubleSide,transparent:!0,opacity:1,emissive:16777215,emissiveMap:t,emissiveIntensity:.8}),o=new c.Mesh(e,s),i=new c.PointLight(16777215,1,5);i.position.set(0,0,.1),o.add(i);const r=new c.PointLight(16777215,1,5);return r.position.set(0,0,-.1),o.add(r),o.userData={collected:!1,initialY:0,rotationSpeed:.02},o}addLogos(){const e=this.buildings[0],n=this.buildings[1],t=this.buildings[2],s=this.buildings[3],o=this.buildings[4];[{building:e,offsetY:18,offsetX:0,offsetZ:0,info:"Lucid Bots Inc. is an AI robotics company that builds productive and responsible robots for the exterior cleaning, concrete, and construction industries."},{building:n,offsetY:25,offsetX:0,offsetZ:0,info:"Our drones use advanced AI to learn and navigate complex environments safely."},{building:t,offsetY:16,offsetX:0,offsetZ:0,info:"Lucid Bots' Sherpa drone could clean any of these buildings in reality as well!"},{building:s,offsetY:30,offsetX:0,offsetZ:4,info:"Our mission at Lucid Bots is to elevate efficiency, safety, and humanity by creating the world's most productive drones."},{building:o,offsetY:22,offsetX:0,offsetZ:0,info:"We also have a surface cleaning robot, known as the Lavobot"}].forEach(({building:r,offsetY:a,offsetX:l,offsetZ:u,info:d})=>{const p=r.getMesh().position,f=this.createLogo();f.position.set(p.x+l,p.y+a,p.z+u),f.userData.initialY=p.y+a,f.userData.info=d,this.logos.push(f),this.scene.add(f)})}showLearningPopup(e){const n=document.createElement("div");n.style.position="fixed",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.backgroundColor="rgba(0, 180, 216, 0.95)",n.style.padding="20px",n.style.borderRadius="10px",n.style.boxShadow="0 0 20px rgba(0,0,0,0.3)",n.style.color="white",n.style.fontSize="18px",n.style.fontFamily="Arial, sans-serif",n.style.textAlign="center",n.style.maxWidth="400px",n.style.zIndex="1000",n.style.animation="fadeIn 0.3s ease-in-out";const t=document.createElement("style");t.textContent="\n            @keyframes fadeIn {\n                from { opacity: 0; transform: translate(-50%, -60%); }\n                to { opacity: 1; transform: translate(-50%, -50%); }\n            }\n        ",document.head.appendChild(t);const s=document.createElement("img");s.src="/drone-game/logo.png",s.style.width="100px",s.style.marginBottom="15px",n.appendChild(s);const o=document.createElement("p");o.textContent=e,o.style.margin="0",o.style.lineHeight="1.5",n.appendChild(o);const i=document.createElement("button");i.textContent="Continue",i.style.marginTop="15px",i.style.padding="8px 20px",i.style.fontSize="16px",i.style.backgroundColor="white",i.style.color="#00B4D8",i.style.border="none",i.style.borderRadius="5px",i.style.cursor="pointer",i.style.transition="transform 0.2s",i.onmouseover=()=>i.style.transform="scale(1.05)",i.onmouseout=()=>i.style.transform="scale(1)",i.onclick=()=>document.body.removeChild(n),n.appendChild(i),document.body.appendChild(n)}}new ps;export{gs as __vite_legacy_guard};
//# sourceMappingURL=index-e9d777ce.js.map
