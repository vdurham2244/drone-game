{"version":3,"file":"index-legacy-bafc9a50.js","sources":["../../node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../../node_modules/three/examples/jsm/loaders/DRACOLoader.js","../../node_modules/three/examples/jsm/controls/OrbitControls.js","../../src/buildings/Building.ts","../../src/buildings/ResidentialBuilding.ts","../../src/buildings/ChurchBuilding.ts","../../src/buildings/IndustrialTank.ts","../../src/buildings/HighriseBuilding.ts","../../src/buildings/WaterTower.ts","../../src/main.ts"],"sourcesContent":["import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tarray.set( attributes[ i ].array, offset );\n\n\t\toffset += attributes[ i ].array.length;\n\n\t}\n\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute}\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new BufferAttribute(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttr = geometry.morphAttributes[ name ];\n\t\tif ( morphAttr ) {\n\n\t\t\ttmpMorphAttributes[ name ] = new BufferAttribute(\n\t\t\t\tnew morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize ),\n\t\t\t\tmorphAttr.itemSize,\n\t\t\t\tmorphAttr.normalized\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttr = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newarray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewarray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttr ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttr.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttr[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new BufferAttribute(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new BufferAttribute(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nfunction mergeBufferGeometries( geometries, useGroups = false ) {\n\n\tconsole.warn( 'THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries().' ); // @deprecated, r151\n\treturn mergeGeometries( geometries, useGroups );\n\n}\n\nfunction mergeBufferAttributes( attributes ) {\n\n\tconsole.warn( 'THREE.BufferGeometryUtils: mergeBufferAttributes() has been renamed to mergeAttributes().' ); // @deprecated, r151\n\treturn mergeAttributes( attributes );\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeBufferGeometries,\n\tmergeAttributes,\n\tmergeBufferAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetDDSLoader() {\n\n\t\tthrow new Error(\n\n\t\t\t'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".'\n\n\t\t);\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( navigator.userAgent ) === true;\n\t\t\tisFirefox = navigator.userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? navigator.userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || isSafari || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tFileLoader,\n\tLoader,\n\tLinearSRGBColorSpace,\n\tSRGBColorSpace\n} from 'three';\n\nconst _taskCache = new WeakMap();\n\nclass DRACOLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.decoderPath = '';\n\t\tthis.decoderConfig = {};\n\t\tthis.decoderBinary = null;\n\t\tthis.decoderPending = null;\n\n\t\tthis.workerLimit = 4;\n\t\tthis.workerPool = [];\n\t\tthis.workerNextTaskID = 1;\n\t\tthis.workerSourceURL = '';\n\n\t\tthis.defaultAttributeIDs = {\n\t\t\tposition: 'POSITION',\n\t\t\tnormal: 'NORMAL',\n\t\t\tcolor: 'COLOR',\n\t\t\tuv: 'TEX_COORD'\n\t\t};\n\t\tthis.defaultAttributeTypes = {\n\t\t\tposition: 'Float32Array',\n\t\t\tnormal: 'Float32Array',\n\t\t\tcolor: 'Float32Array',\n\t\t\tuv: 'Float32Array'\n\t\t};\n\n\t}\n\n\tsetDecoderPath( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t}\n\n\tsetDecoderConfig( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t}\n\n\tsetWorkerLimit( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis.parse( buffer, onLoad, onError );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( buffer, onLoad, onError ) {\n\n\t\tthis.decodeDracoFile( buffer, onLoad, null, null, SRGBColorSpace ).catch( onError );\n\n\t}\n\n\tdecodeDracoFile( buffer, callback, attributeIDs, attributeTypes, vertexColorSpace = LinearSRGBColorSpace ) {\n\n\t\tconst taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs,\n\t\t\tvertexColorSpace: vertexColorSpace,\n\t\t};\n\n\t\treturn this.decodeGeometry( buffer, taskConfig ).then( callback );\n\n\t}\n\n\tdecodeGeometry( buffer, taskConfig ) {\n\n\t\tconst taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( _taskCache.has( buffer ) ) {\n\n\t\t\tconst cachedTask = _taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet worker;\n\t\tconst taskID = this.workerNextTaskID ++;\n\t\tconst taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tconst geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\t// Note: replaced '.finally()' with '.catch().then()' block - iOS 11 support (#19416)\n\t\tgeometryPending\n\t\t\t.catch( () => true )\n\t\t\t.then( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\t_taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t}\n\n\t_createGeometry( geometryData ) {\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tconst result = geometryData.attributes[ i ];\n\t\t\tconst name = result.name;\n\t\t\tconst array = result.array;\n\t\t\tconst itemSize = result.itemSize;\n\n\t\t\tconst attribute = new BufferAttribute( array, itemSize );\n\n\t\t\tif ( name === 'color' ) {\n\n\t\t\t\tthis._assignVertexColorSpace( attribute, result.vertexColorSpace );\n\n\t\t\t\tattribute.normalized = ( array instanceof Float32Array ) === false;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( name, attribute );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n\t_assignVertexColorSpace( attribute, inputColorSpace ) {\n\n\t\t// While .drc files do not specify colorspace, the only 'official' tooling\n\t\t// is PLY and OBJ converters, which use sRGB. We'll assume sRGB when a .drc\n\t\t// file is passed into .load() or .parse(). GLTFLoader uses internal APIs\n\t\t// to decode geometry, and vertex colors are already Linear-sRGB in there.\n\n\t\tif ( inputColorSpace !== SRGBColorSpace ) return;\n\n\t\tconst _color = new Color();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\t_color.fromBufferAttribute( attribute, i ).convertSRGBToLinear();\n\t\t\tattribute.setXYZ( i, _color.r, _color.g, _color.b );\n\n\t\t}\n\n\t}\n\n\t_loadLibrary( url, responseType ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t}\n\n\tpreload() {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t}\n\n\t_initDecoder() {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tconst useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tconst librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tconst jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tconst fn = DRACOWorker.toString();\n\n\t\t\t\tconst body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t}\n\n\t_getWorker( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tconst worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tconst message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t}\n\n\t_releaseTask( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t}\n\n\tdebug() {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\tif ( this.workerSourceURL !== '' ) {\n\n\t\t\tURL.revokeObjectURL( this.workerSourceURL );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/* WEB WORKER */\n\nfunction DRACOWorker() {\n\n\tlet decoderConfig;\n\tlet decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tconst message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig ); // eslint-disable-line no-undef\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tconst buffer = message.buffer;\n\t\t\t\tconst taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tconst draco = module.draco;\n\t\t\t\t\tconst decoder = new draco.Decoder();\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tconst geometry = decodeGeometry( draco, decoder, new Int8Array( buffer ), taskConfig );\n\n\t\t\t\t\t\tconst buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, array, taskConfig ) {\n\n\t\tconst attributeIDs = taskConfig.attributeIDs;\n\t\tconst attributeTypes = taskConfig.attributeTypes;\n\n\t\tlet dracoGeometry;\n\t\tlet decodingStatus;\n\n\t\tconst geometryType = decoder.GetEncodedGeometryType( array );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeArrayToMesh( array, array.byteLength, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeArrayToPointCloud( array, array.byteLength, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tconst geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( const attributeName in attributeIDs ) {\n\n\t\t\tconst attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tlet attribute;\n\t\t\tlet attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tconst attributeResult = decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute );\n\n\t\t\tif ( attributeName === 'color' ) {\n\n\t\t\t\tattributeResult.vertexColorSpace = taskConfig.vertexColorSpace;\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( attributeResult );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tgeometry.index = decodeIndex( draco, decoder, dracoGeometry );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeIndex( draco, decoder, dracoGeometry ) {\n\n\t\tconst numFaces = dracoGeometry.num_faces();\n\t\tconst numIndices = numFaces * 3;\n\t\tconst byteLength = numIndices * 4;\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetTrianglesUInt32Array( dracoGeometry, byteLength, ptr );\n\t\tconst index = new Uint32Array( draco.HEAPF32.buffer, ptr, numIndices ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn { array: index, itemSize: 1 };\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tconst numComponents = attribute.num_components();\n\t\tconst numPoints = dracoGeometry.num_points();\n\t\tconst numValues = numPoints * numComponents;\n\t\tconst byteLength = numValues * attributeType.BYTES_PER_ELEMENT;\n\t\tconst dataType = getDracoDataType( draco, attributeType );\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetAttributeDataArrayForAllPoints( dracoGeometry, attribute, dataType, byteLength, ptr );\n\t\tconst array = new attributeType( draco.HEAPF32.buffer, ptr, numValues ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n\tfunction getDracoDataType( draco, attributeType ) {\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array: return draco.DT_FLOAT32;\n\t\t\tcase Int8Array: return draco.DT_INT8;\n\t\t\tcase Int16Array: return draco.DT_INT16;\n\t\t\tcase Int32Array: return draco.DT_INT32;\n\t\t\tcase Uint8Array: return draco.DT_UINT8;\n\t\t\tcase Uint16Array: return draco.DT_UINT16;\n\t\t\tcase Uint32Array: return draco.DT_UINT32;\n\n\t\t}\n\n\t}\n\n}\n\nexport { DRACOLoader };\n","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3,\n\tPlane,\n\tRay,\n\tMathUtils\n} from 'three';\n\n// OrbitControls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\nconst _ray = new Ray();\nconst _plane = new Plane();\nconst TILT_LIMIT = Math.cos( 70 * MathUtils.DEG2RAD );\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// Sets the 3D cursor (similar to Blender), from which the maxTargetRadius takes effect\n\t\tthis.cursor = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// Limit camera target within a spherical area around the cursor\n\t\tthis.minTargetRadius = 0;\n\t\tthis.maxTargetRadius = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\t\tthis.zoomToCursor = false;\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.getDistance = function () {\n\n\t\t\treturn this.object.position.distanceTo( this.target );\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.stopListenToKeyEvents = function () {\n\n\t\t\tthis._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = null;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\t\t\tconst lastTargetPosition = new Vector3();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update( deltaTime = null ) {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle( deltaTime ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\t// Limit the target distance from the cursor to create a sphere around the center of interest\n\t\t\t\tscope.target.sub( scope.cursor );\n\t\t\t\tscope.target.clampLength( scope.minTargetRadius, scope.maxTargetRadius );\n\t\t\t\tscope.target.add( scope.cursor );\n\n\t\t\t\t// adjust the camera position based on zoom only if we're not zooming to the cursor or if it's an ortho camera\n\t\t\t\t// we adjust zoom later in these cases\n\t\t\t\tif ( scope.zoomToCursor && performCursorZoom || scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\tspherical.radius = clampDistance( spherical.radius );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.radius = clampDistance( spherical.radius * scale );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\t// adjust camera position\n\t\t\t\tlet zoomChanged = false;\n\t\t\t\tif ( scope.zoomToCursor && performCursorZoom ) {\n\n\t\t\t\t\tlet newRadius = null;\n\t\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t\t// move the camera down the pointer ray\n\t\t\t\t\t\t// this method avoids floating point error\n\t\t\t\t\t\tconst prevRadius = offset.length();\n\t\t\t\t\t\tnewRadius = clampDistance( prevRadius * scale );\n\n\t\t\t\t\t\tconst radiusDelta = prevRadius - newRadius;\n\t\t\t\t\t\tscope.object.position.addScaledVector( dollyDirection, radiusDelta );\n\t\t\t\t\t\tscope.object.updateMatrixWorld();\n\n\t\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t\t// adjust the ortho camera position based on zoom changes\n\t\t\t\t\t\tconst mouseBefore = new Vector3( mouse.x, mouse.y, 0 );\n\t\t\t\t\t\tmouseBefore.unproject( scope.object );\n\n\t\t\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / scale ) );\n\t\t\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\t\t\tzoomChanged = true;\n\n\t\t\t\t\t\tconst mouseAfter = new Vector3( mouse.x, mouse.y, 0 );\n\t\t\t\t\t\tmouseAfter.unproject( scope.object );\n\n\t\t\t\t\t\tscope.object.position.sub( mouseAfter ).add( mouseBefore );\n\t\t\t\t\t\tscope.object.updateMatrixWorld();\n\n\t\t\t\t\t\tnewRadius = offset.length();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled.' );\n\t\t\t\t\t\tscope.zoomToCursor = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// handle the placement of the target\n\t\t\t\t\tif ( newRadius !== null ) {\n\n\t\t\t\t\t\tif ( this.screenSpacePanning ) {\n\n\t\t\t\t\t\t\t// position the orbit target in front of the new camera position\n\t\t\t\t\t\t\tscope.target.set( 0, 0, - 1 )\n\t\t\t\t\t\t\t\t.transformDirection( scope.object.matrix )\n\t\t\t\t\t\t\t\t.multiplyScalar( newRadius )\n\t\t\t\t\t\t\t\t.add( scope.object.position );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// get the ray and translation plane to compute target\n\t\t\t\t\t\t\t_ray.origin.copy( scope.object.position );\n\t\t\t\t\t\t\t_ray.direction.set( 0, 0, - 1 ).transformDirection( scope.object.matrix );\n\n\t\t\t\t\t\t\t// if the camera is 20 degrees above the horizon then don't adjust the focus target to avoid\n\t\t\t\t\t\t\t// extremely large values\n\t\t\t\t\t\t\tif ( Math.abs( scope.object.up.dot( _ray.direction ) ) < TILT_LIMIT ) {\n\n\t\t\t\t\t\t\t\tobject.lookAt( scope.target );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( scope.object.up, scope.target );\n\t\t\t\t\t\t\t\t_ray.intersectPlane( _plane, scope.target );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / scale ) );\n\t\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\t\tzoomChanged = true;\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\t\t\t\tperformCursorZoom = false;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ||\n\t\t\t\t\tlastTargetPosition.distanceToSquared( scope.target ) > 0 ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tlastTargetPosition.copy( scope.target );\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerUp );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\t\t\t\tscope._domElementKeyEvents = null;\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst dollyDirection = new Vector3();\n\t\tconst mouse = new Vector2();\n\t\tlet performCursorZoom = false;\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle( deltaTime ) {\n\n\t\t\tif ( deltaTime !== null ) {\n\n\t\t\t\treturn ( 2 * Math.PI / 60 * scope.autoRotateSpeed ) * deltaTime;\n\n\t\t\t} else {\n\n\t\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera || scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera || scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction updateMouseParameters( event ) {\n\n\t\t\tif ( ! scope.zoomToCursor ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tperformCursorZoom = true;\n\n\t\t\tconst rect = scope.domElement.getBoundingClientRect();\n\t\t\tconst x = event.clientX - rect.left;\n\t\t\tconst y = event.clientY - rect.top;\n\t\t\tconst w = rect.width;\n\t\t\tconst h = rect.height;\n\n\t\t\tmouse.x = ( x / w ) * 2 - 1;\n\t\t\tmouse.y = - ( y / h ) * 2 + 1;\n\n\t\t\tdollyDirection.set( mouse.x, mouse.y, 1 ).unproject( scope.object ).sub( scope.object.position ).normalize();\n\n\t\t}\n\n\t\tfunction clampDistance( dist ) {\n\n\t\t\treturn Math.max( scope.minDistance, Math.min( scope.maxDistance, dist ) );\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tupdateMouseParameters( event );\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tupdateMouseParameters( event );\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateUp( 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateUp( - 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateLeft( 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateLeft( - 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.releasePointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerUp );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\nexport { OrbitControls };\n","import * as THREE from 'three';\r\n\r\nexport abstract class Building {\r\n    protected mesh!: THREE.Object3D;\r\n    protected dirtyLevel: number = 100;\r\n    protected position: THREE.Vector3;\r\n\r\n    constructor(position: THREE.Vector3) {\r\n        this.position = position;\r\n    }\r\n\r\n    abstract createMesh(): void;\r\n\r\n    getMesh(): THREE.Object3D {\r\n        return this.mesh;\r\n    }\r\n\r\n    clean(amount: number): void {\r\n        this.dirtyLevel = Math.max(0, this.dirtyLevel - amount);\r\n        // Update material opacity based on dirt level\r\n        this.mesh.traverse((child) => {\r\n            if (child instanceof THREE.Mesh && child.material instanceof THREE.Material) {\r\n                if (child.material.transparent) {\r\n                    child.material.opacity = 0.3 + (this.dirtyLevel / 100) * 0.7;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    getDirtLevel(): number {\r\n        return this.dirtyLevel;\r\n    }\r\n\r\n    isClean(): boolean {\r\n        return this.dirtyLevel === 0;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { Building } from './Building';\r\n\r\nexport class ResidentialBuilding extends Building {\r\n    createMesh(): void {\r\n        const mansion = new THREE.Group();\r\n        \r\n        // Main building body\r\n        const mainBody = new THREE.Mesh(\r\n            new THREE.BoxGeometry(20, 15, 15),\r\n            new THREE.MeshPhongMaterial({ \r\n                color: 0xF5E6D3,\r\n                transparent: false,\r\n                opacity: 1\r\n            })\r\n        );\r\n\r\n        // Stone foundation\r\n        const foundation = new THREE.Mesh(\r\n            new THREE.BoxGeometry(21, 1, 16),\r\n            new THREE.MeshPhongMaterial({ \r\n                color: 0x7B7B7B\r\n            })\r\n        );\r\n        foundation.position.y = -7.5;\r\n\r\n        // Side wings\r\n        const leftWing = new THREE.Mesh(\r\n            new THREE.BoxGeometry(8, 8, 12),\r\n            new THREE.MeshPhongMaterial({ \r\n                color: 0xF5E6D3,\r\n                transparent: false,\r\n                opacity: 1\r\n            })\r\n        );\r\n        leftWing.position.set(-14, -2, 0);\r\n\r\n        const rightWing = leftWing.clone();\r\n        rightWing.position.set(14, -2, 0);\r\n\r\n        // Flat black roof with thicker height\r\n        const mainRoof = new THREE.Mesh(\r\n            new THREE.BoxGeometry(21, 2, 16),  // Increased height to 2\r\n            new THREE.MeshPhongMaterial({ \r\n                color: 0x000000,\r\n                transparent: false,\r\n                opacity: 1\r\n            })\r\n        );\r\n        mainRoof.position.y = 7.5;\r\n\r\n        // Create VWD text using box geometries\r\n        const letterMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0xFFFFFF,\r\n            transparent: false,\r\n            opacity: 1\r\n        });\r\n\r\n        // V\r\n        const vLeft = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 2, 0.5),\r\n            letterMaterial\r\n        );\r\n        vLeft.position.set(-3, 7, 8.1);\r\n        vLeft.rotation.z = Math.PI * 0.1;\r\n        \r\n        const vRight = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 2, 0.5),\r\n            letterMaterial\r\n        );\r\n        vRight.position.set(-2, 7, 8.1);\r\n        vRight.rotation.z = -Math.PI * 0.1;\r\n\r\n        // W\r\n        const w1 = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 2.5, 0.5),  // Taller outer stroke\r\n            letterMaterial\r\n        );\r\n        w1.position.set(-0.8, 7, 8.1);\r\n        w1.rotation.z = Math.PI * 0.1;\r\n\r\n        const w2 = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 1.5, 0.5),  // Shorter inner stroke\r\n            letterMaterial\r\n        );\r\n        w2.position.set(0.2, 6.5, 8.1);  // Lowered position\r\n        w2.rotation.z = -Math.PI * 0.1;\r\n\r\n        const w3 = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 1.5, 0.5),  // Shorter inner stroke\r\n            letterMaterial\r\n        );\r\n        w3.position.set(1.2, 6.5, 8.1);  // Lowered position\r\n        w3.rotation.z = Math.PI * 0.1;\r\n\r\n        const w4 = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 2.5, 0.5),  // Taller outer stroke\r\n            letterMaterial\r\n        );\r\n        w4.position.set(2.2, 7, 8.1);\r\n        w4.rotation.z = -Math.PI * 0.1;\r\n\r\n        // D\r\n        const dStem = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.8, 2.5, 0.5),\r\n            letterMaterial\r\n        );\r\n        dStem.position.set(3.8, 7, 8.1);\r\n\r\n        const dCurve = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(1, 1.5, 0.5, 16, 1, false, -Math.PI/2, Math.PI),\r\n            letterMaterial\r\n        );\r\n        dCurve.rotation.x = Math.PI/2;\r\n        dCurve.rotation.y = Math.PI/2;\r\n        dCurve.position.set(3.8, 7, 8.1);\r\n\r\n        // Wing roofs (flat black and thicker)\r\n        const wingRoofGeometry = new THREE.BoxGeometry(9, 2, 13);  // Increased height to 2\r\n        const wingRoofMaterial = new THREE.MeshPhongMaterial({ color: 0x000000 });\r\n        const leftWingRoof = new THREE.Mesh(wingRoofGeometry, wingRoofMaterial);\r\n        leftWingRoof.position.set(-14, 2, 0);\r\n\r\n        const rightWingRoof = leftWingRoof.clone();\r\n        rightWingRoof.position.set(14, 2, 0);\r\n\r\n        // Windows\r\n        const windowGeometry = new THREE.BoxGeometry(2.5, 4, 0.2);\r\n        const windowMaterial = new THREE.MeshPhongMaterial({ \r\n            color: 0xADD8E6,\r\n            transparent: true,\r\n            opacity: 0.7\r\n        });\r\n\r\n        // Window frames\r\n        const frameGeometry = new THREE.BoxGeometry(3, 4.5, 0.3);\r\n        const frameMaterial = new THREE.MeshPhongMaterial({ color: 0xFFFFFF });\r\n\r\n        // Window positions\r\n        const windowPositions = [\r\n            // Front windows\r\n            [-7, 0, 7.6], [-2.3, 0, 7.6], [2.3, 0, 7.6], [7, 0, 7.6],\r\n            // Second floor front\r\n            [-7, 5, 7.6], [-2.3, 5, 7.6], [2.3, 5, 7.6], [7, 5, 7.6],\r\n            // Side windows\r\n            [-10.1, 0, 0], [-10.1, 5, 0], [10.1, 0, 0], [10.1, 5, 0],\r\n            // Wing windows\r\n            [-14, 0, 4], [-14, 0, -4], [14, 0, 4], [14, 0, -4]\r\n        ];\r\n\r\n        windowPositions.forEach((pos, index) => {\r\n            const frame = new THREE.Mesh(frameGeometry, frameMaterial);\r\n            const window = new THREE.Mesh(windowGeometry, windowMaterial);\r\n            \r\n            frame.position.set(pos[0], pos[1], pos[2]);\r\n            window.position.set(pos[0], pos[1], pos[2] + 0.1);\r\n            \r\n            if (index >= 8 && index < 12) {\r\n                frame.rotation.y = Math.PI / 2;\r\n                window.rotation.y = Math.PI / 2;\r\n            }\r\n            \r\n            mansion.add(frame);\r\n            mansion.add(window);\r\n        });\r\n\r\n        // Simple entrance\r\n        const entrance = new THREE.Mesh(\r\n            new THREE.BoxGeometry(6, 8, 1),\r\n            new THREE.MeshPhongMaterial({ color: 0xFFFFFF })\r\n        );\r\n        entrance.position.set(0, -2, 7.6);\r\n\r\n        // Add all elements\r\n        mansion.add(mainBody);\r\n        mansion.add(foundation);\r\n        mansion.add(leftWing);\r\n        mansion.add(rightWing);\r\n        mansion.add(mainRoof);\r\n        mansion.add(leftWingRoof);\r\n        mansion.add(rightWingRoof);\r\n        mansion.add(entrance);\r\n        mansion.add(vLeft);\r\n        mansion.add(vRight);\r\n        mansion.add(w1);\r\n        mansion.add(w2);\r\n        mansion.add(w3);\r\n        mansion.add(w4);  // Added fourth stroke for W\r\n        mansion.add(dStem);\r\n        mansion.add(dCurve);\r\n\r\n        // Position the mansion\r\n        mansion.position.copy(this.position);\r\n\r\n        this.mesh = mansion;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { Building } from './Building';\r\n\r\nexport class ChurchBuilding extends Building {\r\n    createMesh(): void {\r\n        const church = new THREE.Group();\r\n\r\n        // Main church body (larger)\r\n        const body = new THREE.Mesh(\r\n            new THREE.BoxGeometry(10, 8, 16),\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0xF5F5DC, // Beige stone color\r\n                transparent: true,\r\n                opacity: 1\r\n            })\r\n        );\r\n\r\n        // Steeple base (taller)\r\n        const steepleBase = new THREE.Mesh(\r\n            new THREE.BoxGeometry(4, 12, 4),\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0xE8E8E8,\r\n                transparent: true,\r\n                opacity: 1\r\n            })\r\n        );\r\n        steepleBase.position.set(0, 10, -4);\r\n\r\n        // Steeple roof (taller pyramid)\r\n        const steepleRoofGeometry = new THREE.ConeGeometry(3, 6, 4);\r\n        const steepleRoof = new THREE.Mesh(\r\n            steepleRoofGeometry,\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0x8B4513,\r\n                transparent: true,\r\n                opacity: 1\r\n            })\r\n        );\r\n        steepleRoof.position.set(0, 19, -4);\r\n\r\n        // Larger cross\r\n        const crossVertical = new THREE.Mesh(\r\n            new THREE.BoxGeometry(0.4, 2, 0.4),\r\n            new THREE.MeshPhongMaterial({ color: 0xFFD700 })\r\n        );\r\n        const crossHorizontal = new THREE.Mesh(\r\n            new THREE.BoxGeometry(1.2, 0.4, 0.4),\r\n            new THREE.MeshPhongMaterial({ color: 0xFFD700 })\r\n        );\r\n        const cross = new THREE.Group();\r\n        cross.add(crossVertical);\r\n        cross.add(crossHorizontal);\r\n        cross.position.set(0, 23, -4);\r\n\r\n        // Larger, more ornate windows\r\n        const windowGeometry = new THREE.BoxGeometry(1.2, 4, 0.2);\r\n        const windowMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x87CEEB,\r\n            transparent: true,\r\n            opacity: 0.8\r\n        });\r\n\r\n        // Add windows on both sides\r\n        for (let i = -5; i <= 5; i += 5) {\r\n            const leftWindow = new THREE.Mesh(windowGeometry, windowMaterial);\r\n            leftWindow.position.set(-5.1, 0, i);\r\n            leftWindow.rotation.y = Math.PI / 2;\r\n            church.add(leftWindow);\r\n\r\n            const rightWindow = new THREE.Mesh(windowGeometry, windowMaterial);\r\n            rightWindow.position.set(5.1, 0, i);\r\n            rightWindow.rotation.y = Math.PI / 2;\r\n            church.add(rightWindow);\r\n        }\r\n\r\n        // Large front window (rose window)\r\n        const roseWindowGeometry = new THREE.CylinderGeometry(2, 2, 0.2, 16);\r\n        const roseWindow = new THREE.Mesh(\r\n            roseWindowGeometry,\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0x87CEEB,\r\n                transparent: true,\r\n                opacity: 0.8\r\n            })\r\n        );\r\n        roseWindow.rotation.x = Math.PI / 2;\r\n        roseWindow.position.set(0, 4, 8.1);\r\n\r\n        // Main door (larger, more ornate)\r\n        const doorFrame = new THREE.Mesh(\r\n            new THREE.BoxGeometry(4, 6, 0.5),\r\n            new THREE.MeshPhongMaterial({ color: 0x8B4513 })\r\n        );\r\n        doorFrame.position.set(0, -1, 8.1);\r\n\r\n        const door = new THREE.Mesh(\r\n            new THREE.BoxGeometry(3.6, 5.6, 0.2),\r\n            new THREE.MeshPhongMaterial({ color: 0x4A3520 })\r\n        );\r\n        door.position.set(0, -1, 8.3);\r\n\r\n        // Steps\r\n        const steps = new THREE.Mesh(\r\n            new THREE.BoxGeometry(6, 1, 2),\r\n            new THREE.MeshPhongMaterial({ color: 0x808080 })\r\n        );\r\n        steps.position.set(0, -4, 9);\r\n\r\n        // Roof details\r\n        const roofGeometry = new THREE.BoxGeometry(11, 0.5, 17);\r\n        const roof = new THREE.Mesh(\r\n            roofGeometry,\r\n            new THREE.MeshPhongMaterial({ color: 0x8B4513 })\r\n        );\r\n        roof.position.y = 4.25;\r\n\r\n        // Combine all elements\r\n        church.add(body);\r\n        church.add(steepleBase);\r\n        church.add(steepleRoof);\r\n        church.add(cross);\r\n        church.add(doorFrame);\r\n        church.add(door);\r\n        church.add(steps);\r\n        church.add(roof);\r\n        church.add(roseWindow);\r\n\r\n        // Position the church\r\n        church.position.copy(this.position);\r\n\r\n        this.mesh = church;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { Building } from './Building';\r\n\r\nexport class IndustrialTank extends Building {\r\n    createMesh(): void {\r\n        const silo = new THREE.Group();\r\n\r\n        // Main cylindrical body (taller and wider)\r\n        const cylinderGeometry = new THREE.CylinderGeometry(3, 3, 15, 32);\r\n        const siloBody = new THREE.Mesh(\r\n            cylinderGeometry,\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0xC0C0C0, // Lighter silver color\r\n                transparent: true,\r\n                opacity: 1,\r\n                shininess: 100\r\n            })\r\n        );\r\n\r\n        // Conical top\r\n        const coneGeometry = new THREE.ConeGeometry(3, 4, 32);\r\n        const cone = new THREE.Mesh(\r\n            coneGeometry,\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0xB8B8B8,\r\n                transparent: true,\r\n                opacity: 1,\r\n                shininess: 100\r\n            })\r\n        );\r\n        cone.position.y = 9.5;\r\n\r\n        // Base ring\r\n        const baseRingGeometry = new THREE.TorusGeometry(3.2, 0.3, 16, 32);\r\n        const baseRing = new THREE.Mesh(\r\n            baseRingGeometry,\r\n            new THREE.MeshPhongMaterial({ color: 0x808080 })\r\n        );\r\n        baseRing.rotation.x = Math.PI / 2;\r\n        baseRing.position.y = -7.5;\r\n\r\n        // Top ring\r\n        const topRing = baseRing.clone();\r\n        topRing.position.y = 7.5;\r\n\r\n        // Support structure\r\n        const supportGeometry = new THREE.CylinderGeometry(3.5, 4.5, 2, 8);\r\n        const support = new THREE.Mesh(\r\n            supportGeometry,\r\n            new THREE.MeshPhongMaterial({ color: 0x606060 })\r\n        );\r\n        support.position.y = -8;\r\n\r\n        // Add vertical detail lines\r\n        for (let i = 0; i < 8; i++) {\r\n            const angle = (i / 8) * Math.PI * 2;\r\n            const detailGeometry = new THREE.BoxGeometry(0.2, 15, 0.2);\r\n            const detail = new THREE.Mesh(\r\n                detailGeometry,\r\n                new THREE.MeshPhongMaterial({ color: 0xA8A8A8 })\r\n            );\r\n            detail.position.set(\r\n                Math.cos(angle) * 3.1,\r\n                0,\r\n                Math.sin(angle) * 3.1\r\n            );\r\n            silo.add(detail);\r\n        }\r\n\r\n        // Add all elements to the silo group\r\n        silo.add(siloBody);\r\n        silo.add(cone);\r\n        silo.add(baseRing);\r\n        silo.add(topRing);\r\n        silo.add(support);\r\n\r\n        // Position the silo\r\n        silo.position.copy(this.position);\r\n\r\n        this.mesh = silo;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { Building } from './Building';\r\n\r\nexport class HighriseBuilding extends Building {\r\n    createMesh(): void {\r\n        const building = new THREE.Group();\r\n\r\n        // Main building body\r\n        const bodyGeometry = new THREE.BoxGeometry(12, 40, 12);\r\n        const bodyMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x2F4F4F, // Dark slate gray\r\n            transparent: true,\r\n            opacity: 1,\r\n            shininess: 100\r\n        });\r\n        const body = new THREE.Mesh(bodyGeometry, bodyMaterial);\r\n\r\n        // Glass panels for modern look\r\n        const glassGeometry = new THREE.PlaneGeometry(11, 38);\r\n        const glassMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x4682B4, // Steel blue\r\n            transparent: true,\r\n            opacity: 0.6,\r\n            shininess: 100,\r\n            side: THREE.DoubleSide\r\n        });\r\n\r\n        // Add glass panels to all four sides\r\n        const frontGlass = new THREE.Mesh(glassGeometry, glassMaterial);\r\n        frontGlass.position.set(0, 0, 6.01);\r\n        \r\n        const backGlass = new THREE.Mesh(glassGeometry, glassMaterial);\r\n        backGlass.position.set(0, 0, -6.01);\r\n        backGlass.rotation.y = Math.PI;\r\n\r\n        const leftGlass = new THREE.Mesh(glassGeometry, glassMaterial);\r\n        leftGlass.position.set(-6.01, 0, 0);\r\n        leftGlass.rotation.y = -Math.PI / 2;\r\n\r\n        const rightGlass = new THREE.Mesh(glassGeometry, glassMaterial);\r\n        rightGlass.position.set(6.01, 0, 0);\r\n        rightGlass.rotation.y = Math.PI / 2;\r\n\r\n        // Add horizontal dividers for floors\r\n        const floorCount = 12;\r\n        const floorSpacing = 3;\r\n        for (let i = 0; i < floorCount; i++) {\r\n            const y = -18 + (i * floorSpacing);\r\n            const divider = new THREE.Mesh(\r\n                new THREE.BoxGeometry(12.1, 0.2, 12.1),\r\n                new THREE.MeshPhongMaterial({ color: 0x4A4A4A })\r\n            );\r\n            divider.position.y = y;\r\n            building.add(divider);\r\n        }\r\n\r\n        // Add vertical supports\r\n        const supportPositions = [\r\n            [-5.5, 0, 6], [5.5, 0, 6],    // Front\r\n            [-5.5, 0, -6], [5.5, 0, -6],  // Back\r\n            [-6, 0, -5.5], [-6, 0, 5.5],  // Left\r\n            [6, 0, -5.5], [6, 0, 5.5]     // Right\r\n        ];\r\n\r\n        supportPositions.forEach(pos => {\r\n            const support = new THREE.Mesh(\r\n                new THREE.BoxGeometry(0.3, 40, 0.3),\r\n                new THREE.MeshPhongMaterial({ color: 0x2F4F4F })\r\n            );\r\n            support.position.set(pos[0], 0, pos[1]);\r\n            building.add(support);\r\n        });\r\n\r\n        // Modern roof structure\r\n        const roofBase = new THREE.Mesh(\r\n            new THREE.BoxGeometry(13, 1, 13),\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0x4A4A4A,\r\n                shininess: 50\r\n            })\r\n        );\r\n        roofBase.position.y = 20.5;\r\n\r\n        // Roof details\r\n        const roofDetail = new THREE.Mesh(\r\n            new THREE.BoxGeometry(8, 3, 8),\r\n            new THREE.MeshPhongMaterial({ color: 0x2F4F4F })\r\n        );\r\n        roofDetail.position.y = 22;\r\n\r\n        // Modern entrance\r\n        const entranceBase = new THREE.Mesh(\r\n            new THREE.BoxGeometry(8, 4, 2),\r\n            new THREE.MeshPhongMaterial({ color: 0x4A4A4A })\r\n        );\r\n        entranceBase.position.set(0, -18, 7);\r\n\r\n        const entranceRoof = new THREE.Mesh(\r\n            new THREE.BoxGeometry(8, 0.3, 3),\r\n            new THREE.MeshPhongMaterial({ color: 0x2F4F4F })\r\n        );\r\n        entranceRoof.position.set(0, -16, 7.5);\r\n\r\n        // Glass door\r\n        const door = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(6, 3.5),\r\n            new THREE.MeshPhongMaterial({\r\n                color: 0x4682B4,\r\n                transparent: true,\r\n                opacity: 0.8,\r\n                side: THREE.DoubleSide\r\n            })\r\n        );\r\n        door.position.set(0, -18, 8.1);\r\n\r\n        // Combine all elements\r\n        building.add(body);\r\n        building.add(frontGlass);\r\n        building.add(backGlass);\r\n        building.add(leftGlass);\r\n        building.add(rightGlass);\r\n        building.add(roofBase);\r\n        building.add(roofDetail);\r\n        building.add(entranceBase);\r\n        building.add(entranceRoof);\r\n        building.add(door);\r\n\r\n        // Position the building\r\n        building.position.copy(this.position);\r\n\r\n        this.mesh = building;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { Building } from './Building';\r\n\r\nexport class WaterTower extends Building {\r\n    createMesh(): void {\r\n        const tower = new THREE.Group();\r\n\r\n        // Main tank (larger and more cylindrical)\r\n        const tankGeometry = new THREE.CylinderGeometry(4, 4, 6, 32);\r\n        const tankMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x505050, // Darker gray\r\n            transparent: true,\r\n            opacity: 1,\r\n            shininess: 60\r\n        });\r\n        const tank = new THREE.Mesh(tankGeometry, tankMaterial);\r\n        tank.position.y = 15;\r\n\r\n        // Bottom curved part of tank\r\n        const bottomCurveGeometry = new THREE.SphereGeometry(4, 32, 16, 0, Math.PI * 2, 0, Math.PI / 2);\r\n        const bottomCurve = new THREE.Mesh(bottomCurveGeometry, tankMaterial);\r\n        bottomCurve.position.y = 12;\r\n\r\n        // Top curved part of tank\r\n        const topCurveGeometry = new THREE.SphereGeometry(4, 32, 16, 0, Math.PI * 2, Math.PI / 2, Math.PI / 2);\r\n        const topCurve = new THREE.Mesh(topCurveGeometry, tankMaterial);\r\n        topCurve.position.y = 18;\r\n\r\n        // Conical roof with overhang\r\n        const roofGeometry = new THREE.ConeGeometry(4.5, 2.5, 32);\r\n        const roofMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x8B0000, // Dark red\r\n            shininess: 30\r\n        });\r\n        const roof = new THREE.Mesh(roofGeometry, roofMaterial);\r\n        roof.position.y = 19.5;\r\n\r\n        // Central support column\r\n        const centralColumnGeometry = new THREE.CylinderGeometry(0.8, 0.8, 24, 12);\r\n        const supportMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x2F2F2F,\r\n            shininess: 30\r\n        });\r\n        const centralColumn = new THREE.Mesh(centralColumnGeometry, supportMaterial);\r\n        centralColumn.position.y = 0;\r\n\r\n        // Main support beams (thicker and more detailed)\r\n        const mainSupportPositions = [\r\n            [-2.5, 0, -2.5],\r\n            [2.5, 0, -2.5],\r\n            [-2.5, 0, 2.5],\r\n            [2.5, 0, 2.5]\r\n        ];\r\n\r\n        mainSupportPositions.forEach(pos => {\r\n            const support = new THREE.Mesh(\r\n                new THREE.CylinderGeometry(0.4, 0.4, 24, 8),\r\n                supportMaterial\r\n            );\r\n            support.position.set(pos[0], 0, pos[1]);\r\n            tower.add(support);\r\n        });\r\n\r\n        // Add horizontal support rings at different heights\r\n        const ringHeights = [-6, -2, 2, 6, 10];\r\n        ringHeights.forEach(height => {\r\n            const ring = new THREE.Mesh(\r\n                new THREE.TorusGeometry(3.5, 0.2, 16, 32),\r\n                supportMaterial\r\n            );\r\n            ring.rotation.x = Math.PI / 2;\r\n            ring.position.y = height;\r\n            tower.add(ring);\r\n        });\r\n\r\n        // Add diagonal cross braces\r\n        const braceGeometry = new THREE.CylinderGeometry(0.15, 0.15, 7.5, 8);\r\n        const braceHeights = [-4, 0, 4, 8];\r\n        \r\n        braceHeights.forEach(height => {\r\n            // Create X-shaped braces on all four sides\r\n            for (let rotation = 0; rotation < Math.PI * 2; rotation += Math.PI/2) {\r\n                const brace1 = new THREE.Mesh(braceGeometry, supportMaterial);\r\n                brace1.position.y = height;\r\n                brace1.rotation.z = Math.PI / 4;\r\n                brace1.rotation.y = rotation;\r\n                tower.add(brace1);\r\n\r\n                const brace2 = new THREE.Mesh(braceGeometry, supportMaterial);\r\n                brace2.position.y = height;\r\n                brace2.rotation.z = -Math.PI / 4;\r\n                brace2.rotation.y = rotation;\r\n                tower.add(brace2);\r\n            }\r\n        });\r\n\r\n        // Add maintenance platform\r\n        const platformGeometry = new THREE.CylinderGeometry(4.5, 4.5, 0.3, 32);\r\n        const platform = new THREE.Mesh(platformGeometry, supportMaterial);\r\n        platform.position.y = 11;\r\n\r\n        // Add railing to the platform\r\n        const railingGeometry = new THREE.TorusGeometry(4.5, 0.05, 8, 32);\r\n        const railing = new THREE.Mesh(railingGeometry, supportMaterial);\r\n        railing.rotation.x = Math.PI / 2;\r\n        railing.position.y = 12;\r\n\r\n        // Add vertical railing supports\r\n        for (let angle = 0; angle < Math.PI * 2; angle += Math.PI / 8) {\r\n            const railSupport = new THREE.Mesh(\r\n                new THREE.CylinderGeometry(0.05, 0.05, 1, 4),\r\n                supportMaterial\r\n            );\r\n            railSupport.position.set(\r\n                4.5 * Math.cos(angle),\r\n                11.5,\r\n                4.5 * Math.sin(angle)\r\n            );\r\n            tower.add(railSupport);\r\n        }\r\n\r\n        // Add access ladder\r\n        const ladderHeight = 24;\r\n        const ladderWidth = 0.6;\r\n        const rungSpacing = 1;\r\n\r\n        // Ladder side rails\r\n        const sideRailGeometry = new THREE.CylinderGeometry(0.05, 0.05, ladderHeight, 4);\r\n        const leftRail = new THREE.Mesh(sideRailGeometry, supportMaterial);\r\n        const rightRail = new THREE.Mesh(sideRailGeometry, supportMaterial);\r\n        leftRail.position.set(-ladderWidth/2, ladderHeight/2 - 12, 4.2);\r\n        rightRail.position.set(ladderWidth/2, ladderHeight/2 - 12, 4.2);\r\n        tower.add(leftRail);\r\n        tower.add(rightRail);\r\n\r\n        // Ladder rungs\r\n        for (let i = 0; i < ladderHeight; i += rungSpacing) {\r\n            const rung = new THREE.Mesh(\r\n                new THREE.CylinderGeometry(0.025, 0.025, ladderWidth, 4),\r\n                supportMaterial\r\n            );\r\n            rung.rotation.x = Math.PI / 2;\r\n            rung.position.set(0, i - 12, 4.2);\r\n            tower.add(rung);\r\n        }\r\n\r\n        // Add all main elements\r\n        tower.add(tank);\r\n        tower.add(bottomCurve);\r\n        tower.add(topCurve);\r\n        tower.add(roof);\r\n        tower.add(centralColumn);\r\n        tower.add(platform);\r\n        tower.add(railing);\r\n\r\n        // Position the tower\r\n        tower.position.copy(this.position);\r\n\r\n        this.mesh = tower;\r\n    }\r\n} ","import * as THREE from 'three';\r\nimport { GLTF, GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\r\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport { ResidentialBuilding } from './buildings/ResidentialBuilding';\r\nimport { ChurchBuilding } from './buildings/ChurchBuilding';\r\nimport { IndustrialTank } from './buildings/IndustrialTank';\r\nimport { HighriseBuilding } from './buildings/HighriseBuilding';\r\nimport { Building } from './buildings/Building';\r\nimport { WaterTower } from './buildings/WaterTower';\r\n\r\nclass Game {\r\n    private scene: THREE.Scene;\r\n    private camera: THREE.PerspectiveCamera;\r\n    private fpvCamera: THREE.PerspectiveCamera;\r\n    private followCamera: THREE.PerspectiveCamera;\r\n    private activeCamera: THREE.PerspectiveCamera;\r\n    private renderer: THREE.WebGLRenderer;\r\n    private drone: THREE.Object3D | null = null;\r\n    private buildings: Building[] = [];\r\n    private controls: OrbitControls;\r\n    private cleaningRadius = 2;\r\n    private cleaningPower = 1;\r\n    private isSprayOn: boolean = false;\r\n    private spraySystem: THREE.Points | null = null;\r\n    private propellers: THREE.Object3D[] = [];\r\n    private propellerSpeed = 1.1;\r\n    private warningTimeout: number | null = null;\r\n    private cameraMode: 'orbit' | 'fpv' | 'follow' = 'follow';\r\n    private keysPressed: { [key: string]: boolean } = {};\r\n    private lastFrameTime: number = performance.now();\r\n    private logos: THREE.Mesh[] = [];\r\n    private score: number = 0;\r\n    private hasWon: boolean = false;\r\n    private gameStarted: boolean = false;\r\n    private gameMode: 'learning' | 'speed' | null = null;\r\n    private startScreenContainer: HTMLDivElement | null = null;\r\n\r\n    constructor() {\r\n        // Scene setup\r\n        this.scene = new THREE.Scene();\r\n        this.scene.background = new THREE.Color(0x87ceeb); // Sky blue\r\n\r\n        // Orbit camera\r\n        this.camera = new THREE.PerspectiveCamera(\r\n            75,\r\n            window.innerWidth / window.innerHeight,\r\n            0.1,\r\n            1000\r\n        );\r\n        this.camera.position.set(0, 15, 30);\r\n\r\n        // FPV camera\r\n        this.fpvCamera = new THREE.PerspectiveCamera(\r\n            90,\r\n            window.innerWidth / window.innerHeight,\r\n            0.1,\r\n            1000\r\n        );\r\n\r\n        // Follow camera\r\n        this.followCamera = new THREE.PerspectiveCamera(\r\n            75,\r\n            window.innerWidth / window.innerHeight,\r\n            0.1,\r\n            1000\r\n        );\r\n        this.activeCamera = this.followCamera;\r\n\r\n        // Renderer setup\r\n        this.renderer = new THREE.WebGLRenderer({ \r\n            antialias: true,\r\n            alpha: true,\r\n            powerPreference: \"default\"\r\n        });\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n        this.renderer.setPixelRatio(window.devicePixelRatio);\r\n        this.renderer.shadowMap.enabled = true;\r\n        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        this.renderer.outputColorSpace = THREE.SRGBColorSpace;\r\n        this.renderer.toneMapping = THREE.ACESFilmicToneMapping;\r\n        this.renderer.toneMappingExposure = 1.0;\r\n        document.body.appendChild(this.renderer.domElement);\r\n\r\n        // Create and show start screen immediately\r\n        this.createStartScreen();\r\n\r\n        // Orbit controls (disabled initially in follow mode)\r\n        this.controls = new OrbitControls(this.camera, this.renderer.domElement);\r\n        this.controls.enableDamping = true;\r\n        this.controls.dampingFactor = 0.05;\r\n        this.controls.maxPolarAngle = Math.PI / 2;\r\n        this.controls.minDistance = 5;\r\n        this.controls.maxDistance = 100;\r\n        this.controls.enabled = false;\r\n\r\n        // Start animation loop\r\n        this.animate();\r\n    }\r\n\r\n    private createStartScreen(): void {\r\n        // Create container\r\n        this.startScreenContainer = document.createElement('div');\r\n        this.startScreenContainer.style.position = 'fixed';\r\n        this.startScreenContainer.style.top = '0';\r\n        this.startScreenContainer.style.left = '0';\r\n        this.startScreenContainer.style.width = '100%';\r\n        this.startScreenContainer.style.height = '100%';\r\n        this.startScreenContainer.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.startScreenContainer.style.display = 'flex';\r\n        this.startScreenContainer.style.flexDirection = 'column';\r\n        this.startScreenContainer.style.alignItems = 'center';\r\n        this.startScreenContainer.style.justifyContent = 'center';\r\n        this.startScreenContainer.style.zIndex = '1000';\r\n\r\n        // Add logo\r\n        const logo = document.createElement('img');\r\n        logo.src = import.meta.env.BASE_URL + 'start.png';\r\n        logo.style.width = '400px';\r\n        logo.style.marginBottom = '40px';\r\n        this.startScreenContainer.appendChild(logo);\r\n\r\n        // Create mode buttons container\r\n        const buttonsContainer = document.createElement('div');\r\n        buttonsContainer.style.display = 'flex';\r\n        buttonsContainer.style.flexDirection = 'column';\r\n        buttonsContainer.style.gap = '20px';\r\n\r\n        // Learning Mode Button\r\n        const learningButton = this.createModeButton(\r\n            'Learning Mode',\r\n            'Learn about Lucid Bots while flying the drone',\r\n            'learning'\r\n        );\r\n        buttonsContainer.appendChild(learningButton);\r\n\r\n        // Speed Mode Button\r\n        const speedButton = this.createModeButton(\r\n            'Speed Mode',\r\n            'Test your drone piloting skills',\r\n            'speed'\r\n        );\r\n        buttonsContainer.appendChild(speedButton);\r\n\r\n        this.startScreenContainer.appendChild(buttonsContainer);\r\n        document.body.appendChild(this.startScreenContainer);\r\n    }\r\n\r\n    private createModeButton(title: string, description: string, mode: 'learning' | 'speed'): HTMLDivElement {\r\n        const button = document.createElement('div');\r\n        button.style.backgroundColor = '#00B4D8';\r\n        button.style.padding = '20px 40px';\r\n        button.style.borderRadius = '10px';\r\n        button.style.cursor = 'pointer';\r\n        button.style.textAlign = 'center';\r\n        button.style.transition = 'transform 0.2s, background-color 0.2s';\r\n        button.style.width = '400px';\r\n\r\n        const titleElement = document.createElement('h2');\r\n        titleElement.textContent = title;\r\n        titleElement.style.color = 'white';\r\n        titleElement.style.margin = '0 0 10px 0';\r\n        titleElement.style.fontFamily = 'Arial, sans-serif';\r\n\r\n        const descElement = document.createElement('p');\r\n        descElement.textContent = description;\r\n        descElement.style.color = 'white';\r\n        descElement.style.margin = '0';\r\n        descElement.style.fontFamily = 'Arial, sans-serif';\r\n\r\n        button.appendChild(titleElement);\r\n        button.appendChild(descElement);\r\n\r\n        // Hover effects\r\n        button.onmouseover = () => {\r\n            button.style.backgroundColor = '#0096B4';\r\n            button.style.transform = 'scale(1.05)';\r\n        };\r\n        button.onmouseout = () => {\r\n            button.style.backgroundColor = '#00B4D8';\r\n            button.style.transform = 'scale(1)';\r\n        };\r\n\r\n        // Click handler\r\n        button.onclick = () => this.startGame(mode);\r\n\r\n        return button;\r\n    }\r\n\r\n    private startGame(mode: 'learning' | 'speed'): void {\r\n        this.gameMode = mode;\r\n        this.gameStarted = true;\r\n        \r\n        // Remove start screen\r\n        if (this.startScreenContainer) {\r\n            document.body.removeChild(this.startScreenContainer);\r\n            this.startScreenContainer = null;\r\n        }\r\n\r\n        // Initialize game components\r\n        this.setupLighting();\r\n        this.setupControlsUI();\r\n        this.loadDroneModel();\r\n        this.addBuildings();\r\n        this.addGround();\r\n        this.addLogos();\r\n        this.updateScoreDisplay();\r\n        this.createWarningPopup();\r\n\r\n        // Add event listeners\r\n        window.addEventListener('resize', this.onWindowResize.bind(this));\r\n        document.addEventListener('keydown', this.onKeyDown.bind(this));\r\n        document.addEventListener('keyup', this.onKeyUp.bind(this));\r\n\r\n        // Update UI based on game mode\r\n        this.updateUIForGameMode();\r\n    }\r\n\r\n    private updateUIForGameMode(): void {\r\n        const infoElement = document.getElementById('info');\r\n        if (!infoElement) return;\r\n\r\n        if (this.gameMode === 'learning') {\r\n            infoElement.innerHTML += `\r\n                <div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px solid white;\">\r\n                    <p style=\"margin: 0;\">Learning Mode: Collect logos to learn about Lucid Bots!</p>\r\n                </div>\r\n            `;\r\n        } else {\r\n            infoElement.innerHTML += `\r\n                <div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px solid white;\">\r\n                    <p style=\"margin: 0;\">Speed Mode: Collect all logos as fast as you can!</p>\r\n                    <p id=\"timer\" style=\"margin: 5px 0 0 0;\">Time: 0:00</p>\r\n                </div>\r\n            `;\r\n            this.startSpeedModeTimer();\r\n        }\r\n    }\r\n\r\n    private startSpeedModeTimer(): void {\r\n        if (this.gameMode !== 'speed') return;\r\n        \r\n        const startTime = Date.now();\r\n        const timerElement = document.getElementById('timer');\r\n        \r\n        const updateTimer = () => {\r\n            if (!this.hasWon && timerElement) {\r\n                const elapsed = Math.floor((Date.now() - startTime) / 1000);\r\n                const minutes = Math.floor(elapsed / 60);\r\n                const seconds = elapsed % 60;\r\n                timerElement.textContent = `Time: ${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n                requestAnimationFrame(updateTimer);\r\n            }\r\n        };\r\n        \r\n        updateTimer();\r\n    }\r\n\r\n    private setupLighting(): void {\r\n        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);\r\n        this.scene.add(ambientLight);\r\n\r\n        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);\r\n        directionalLight.position.set(50, 50, 50);\r\n        directionalLight.castShadow = true;\r\n        directionalLight.shadow.mapSize.width = 2048;\r\n        directionalLight.shadow.mapSize.height = 2048;\r\n        directionalLight.shadow.camera.near = 0.5;\r\n        directionalLight.shadow.camera.far = 500;\r\n        this.scene.add(directionalLight);\r\n\r\n        const hemisphereLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);\r\n        this.scene.add(hemisphereLight);\r\n    }\r\n\r\n    // Creates a fixed, styled UI panel for game controls and score.\r\n    private setupControlsUI(): void {\r\n        let infoElement = document.getElementById('info');\r\n        if (!infoElement) {\r\n            infoElement = document.createElement('div');\r\n            infoElement.id = 'info';\r\n            document.body.appendChild(infoElement);\r\n        }\r\n        infoElement.style.position = 'fixed';\r\n        infoElement.style.top = '10px';\r\n        infoElement.style.right = '10px';\r\n        infoElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';\r\n        infoElement.style.color = 'white';\r\n        infoElement.style.padding = '10px';\r\n        infoElement.style.borderRadius = '8px';\r\n        infoElement.style.fontFamily = 'Arial, sans-serif';\r\n        infoElement.innerHTML = `\r\n            <h3 style=\"margin:0; font-size:18px;\">Game Controls</h3>\r\n            <ul style=\"list-style:none; padding:0; margin:5px 0;\">\r\n                <li>Arrow Keys: Move Drone</li>\r\n                <li>A/D: Yaw Left/Right</li>\r\n                <li>W/S: Up/Down</li>\r\n                <li>Space: Toggle Sprayer</li>\r\n                <li>C: Clean (when sprayer is on)</li>\r\n                <li>V: Toggle Camera</li>\r\n                <li>Mouse: Orbit Camera (if enabled)</li>\r\n            </ul>\r\n            <p id=\"score-display\" style=\"margin:0; font-weight:bold;\">Score: 0/5 Logos Collected!</p>\r\n        `;\r\n    }\r\n\r\n    private loadDroneModel(): void {\r\n        const dracoLoader = new DRACOLoader();\r\n        dracoLoader.setDecoderPath('https://www.gstatic.com/draco/versioned/decoders/1.5.6/');\r\n        const loader = new GLTFLoader();\r\n        loader.setDRACOLoader(dracoLoader);\r\n\r\n        console.log('Attempting to load drone model...');\r\n        loader.load(import.meta.env.BASE_URL + 'sherpaModel.glb', (gltf: GLTF) => {\r\n            console.log('Drone model loaded successfully:', gltf);\r\n            if (gltf.scene) {\r\n                const droneHolder = new THREE.Object3D();\r\n                const droneModel = gltf.scene;\r\n                // Rotate so it faces forward\r\n                droneModel.rotation.x = -Math.PI / 2;\r\n                droneModel.scale.set(0.5, 0.5, 0.5);\r\n                \r\n                // Traverse to set shadow properties and find propellers\r\n                droneModel.traverse((child) => {\r\n                    if (child instanceof THREE.Mesh) {\r\n                        child.castShadow = true;\r\n                        child.receiveShadow = true;\r\n                        if (child.material && child.material.transparent) {\r\n                            child.material.opacity = 0.9;\r\n                            child.material.side = THREE.DoubleSide;\r\n                        }\r\n                        if (child.name.toLowerCase().includes('propeller') || \r\n                            child.name.toLowerCase().includes('prop') || \r\n                            child.name.toLowerCase().includes('rotor')) {\r\n                            console.log('Found propeller:', child.name);\r\n                            this.propellers.push(child);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                droneHolder.add(droneModel);\r\n                droneHolder.position.set(0, 5, 0);\r\n\r\n                // Add drone lights\r\n                const droneSpotLight = new THREE.SpotLight(0xffffff, 1);\r\n                droneSpotLight.position.set(0, 0.5, 0);\r\n                droneSpotLight.angle = Math.PI / 6;\r\n                droneSpotLight.penumbra = 0.5;\r\n                droneSpotLight.decay = 2;\r\n                droneSpotLight.distance = 10;\r\n                droneHolder.add(droneSpotLight);\r\n                const dronePointLight = new THREE.PointLight(0xffffff, 0.5, 5);\r\n                droneHolder.add(dronePointLight);\r\n\r\n                this.drone = droneHolder;\r\n                this.scene.add(this.drone);\r\n                console.log('Drone added to scene at position:', this.drone.position);\r\n\r\n                dracoLoader.dispose();\r\n            } else {\r\n                console.error('No scene found in the loaded model');\r\n            }\r\n        },\r\n        (progress) => {\r\n            const percentComplete = Math.round((progress.loaded / progress.total) * 100);\r\n            console.log(`Loading progress: ${percentComplete}%`);\r\n        },\r\n        (error) => {\r\n            console.error('Error loading drone model:', error);\r\n            const droneHolder = new THREE.Object3D();\r\n            const geometry = new THREE.BoxGeometry(2, 1, 2);\r\n            const material = new THREE.MeshPhongMaterial({\r\n                color: 0x3366ff,\r\n                transparent: true,\r\n                opacity: 0.8\r\n            });\r\n            const fallbackCube = new THREE.Mesh(geometry, material);\r\n            droneHolder.add(fallbackCube);\r\n            droneHolder.position.set(0, 5, 0);\r\n            const droneLight = new THREE.PointLight(0xffffff, 0.5, 10);\r\n            droneHolder.add(droneLight);\r\n            this.drone = droneHolder;\r\n            this.scene.add(this.drone);\r\n            console.log('Fallback drone cube added to scene');\r\n        });\r\n    }\r\n\r\n    private addBuildings(): void {\r\n        const house = new ResidentialBuilding(new THREE.Vector3(-20, 3, -15));\r\n        house.createMesh();\r\n        this.scene.add(house.getMesh());\r\n        this.buildings.push(house);\r\n\r\n        const church = new ChurchBuilding(new THREE.Vector3(20, 4, -15));\r\n        church.createMesh();\r\n        this.scene.add(church.getMesh());\r\n        this.buildings.push(church);\r\n\r\n        const tank = new IndustrialTank(new THREE.Vector3(-20, 8, 15));\r\n        tank.createMesh();\r\n        this.scene.add(tank.getMesh());\r\n        this.buildings.push(tank);\r\n\r\n        const highrise = new HighriseBuilding(new THREE.Vector3(20, 20, 15));\r\n        highrise.createMesh();\r\n        this.scene.add(highrise.getMesh());\r\n        this.buildings.push(highrise);\r\n\r\n        const waterTower = new WaterTower(new THREE.Vector3(-40, 12, -35));\r\n        waterTower.createMesh();\r\n        this.scene.add(waterTower.getMesh());\r\n        this.buildings.push(waterTower);\r\n    }\r\n\r\n    private addGround(): void {\r\n        const groundGeometry = new THREE.PlaneGeometry(100, 100);\r\n        const groundMaterial = new THREE.MeshPhongMaterial({\r\n            color: 0x90EE90,\r\n            side: THREE.DoubleSide\r\n        });\r\n        const ground = new THREE.Mesh(groundGeometry, groundMaterial);\r\n        ground.rotation.x = -Math.PI / 2;\r\n        ground.receiveShadow = true;\r\n        this.scene.add(ground);\r\n    }\r\n\r\n    private onWindowResize(): void {\r\n        this.camera.aspect = window.innerWidth / window.innerHeight;\r\n        this.camera.updateProjectionMatrix();\r\n        this.fpvCamera.aspect = window.innerWidth / window.innerHeight;\r\n        this.fpvCamera.updateProjectionMatrix();\r\n        this.followCamera.aspect = window.innerWidth / window.innerHeight;\r\n        this.followCamera.updateProjectionMatrix();\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    }\r\n\r\n    private onKeyDown(event: KeyboardEvent): void {\r\n        this.keysPressed[event.key.toLowerCase()] = true;\r\n        switch (event.key.toLowerCase()) {\r\n            case ' ':\r\n                // Toggle the sprayer\r\n                this.isSprayOn = !this.isSprayOn;\r\n                if (this.isSprayOn && !this.spraySystem) {\r\n                    this.createSpraySystem();\r\n                }\r\n                break;\r\n            case 'c':\r\n                if (this.isSprayOn) {\r\n                    this.clean();\r\n                }\r\n                break;\r\n            case 'v':\r\n                this.toggleCamera();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onKeyUp(event: KeyboardEvent): void {\r\n        this.keysPressed[event.key.toLowerCase()] = false;\r\n    }\r\n\r\n    // Drone movement using a smaller bounding sphere for collision.\r\n    private updateDroneMovement(delta: number): void {\r\n        if (!this.drone) return;\r\n\r\n        const translationSpeed = 5;\r\n        const rotationSpeed = 1.5;\r\n        const droneRadius = 0.8;\r\n\r\n        // Yaw rotation (A/D)\r\n        if (this.keysPressed['a']) {\r\n            this.drone.rotation.y += rotationSpeed * delta;\r\n        }\r\n        if (this.keysPressed['d']) {\r\n            this.drone.rotation.y -= rotationSpeed * delta;\r\n        }\r\n\r\n        // Horizontal movement (arrow keys and Q/E for strafing)\r\n        let moveX = 0, moveZ = 0;\r\n        if (this.keysPressed['arrowdown']) moveZ -= 1;\r\n        if (this.keysPressed['arrowup']) moveZ += 1;\r\n        if (this.keysPressed['arrowleft']) moveX += 1;\r\n        if (this.keysPressed['arrowright']) moveX -= 1;\r\n        if (this.keysPressed['q']) moveX -= 1;\r\n        if (this.keysPressed['e']) moveX += 1;\r\n\r\n        // Vertical movement (W/S)\r\n        let moveY = 0;\r\n        if (this.keysPressed['w']) moveY += 1;\r\n        if (this.keysPressed['s']) moveY -= 1;\r\n\r\n        const horizontalMovement = new THREE.Vector3(moveX, 0, moveZ);\r\n        if (horizontalMovement.length() > 0) {\r\n            horizontalMovement.normalize();\r\n            horizontalMovement.multiplyScalar(translationSpeed * delta);\r\n            horizontalMovement.applyEuler(new THREE.Euler(0, this.drone.rotation.y, 0));\r\n        }\r\n        const verticalMovement = moveY * translationSpeed * delta;\r\n\r\n        const newPosition = this.drone.position.clone();\r\n        newPosition.add(horizontalMovement);\r\n        newPosition.y = Math.max(2, newPosition.y + verticalMovement);\r\n\r\n        // Collision detection with buildings.\r\n        const droneSphere = new THREE.Sphere(newPosition, droneRadius);\r\n        let willCollide = false;\r\n        for (const building of this.buildings) {\r\n            const buildingMesh = building.getMesh();\r\n            const buildingBox = new THREE.Box3().setFromObject(buildingMesh);\r\n            if (buildingBox.intersectsSphere(droneSphere)) {\r\n                willCollide = true;\r\n                this.showCollisionWarning();\r\n                break;\r\n            }\r\n        }\r\n        if (!willCollide) {\r\n            this.drone.position.copy(newPosition);\r\n        }\r\n    }\r\n\r\n    private createSpraySystem(): void {\r\n        if (!this.drone) return;\r\n        const particleCount = 1500;\r\n        const particles = new Float32Array(particleCount * 3);\r\n        const particleGeometry = new THREE.BufferGeometry();\r\n        const spriteMaterial = new THREE.PointsMaterial({\r\n            color: 0x0088ff,\r\n            size: 0.12,\r\n            transparent: true,\r\n            opacity: 0.8,\r\n            blending: THREE.AdditiveBlending\r\n        });\r\n        \r\n        // Initialize particles in a wide cone.\r\n        for (let i = 0; i < particleCount; i++) {\r\n            const i3 = i * 3;\r\n            const progress = (i / particleCount) * 25;\r\n            particles[i3] = (Math.random() - 0.5) * (0.4 + progress * 0.15);\r\n            particles[i3 + 1] = (Math.random() - 0.5) * (0.4 + progress * 0.15);\r\n            particles[i3 + 2] = -progress;\r\n        }\r\n        \r\n        particleGeometry.setAttribute('position', new THREE.BufferAttribute(particles, 3));\r\n        this.spraySystem = new THREE.Points(particleGeometry, spriteMaterial);\r\n        const sprayContainer = new THREE.Object3D();\r\n        sprayContainer.rotation.x = -Math.PI;\r\n        sprayContainer.add(this.spraySystem);\r\n        this.drone.add(sprayContainer);\r\n        this.spraySystem.position.set(-0.15, 0, 0);\r\n    }\r\n\r\n    // Update spray system; if sprayer is off, remove it.\r\n    private updateSpraySystem(): void {\r\n        if (!this.spraySystem) return;\r\n\r\n        if (!this.isSprayOn) {\r\n            if (this.spraySystem.parent) {\r\n                this.drone?.remove(this.spraySystem.parent);\r\n            }\r\n            this.spraySystem.geometry.dispose();\r\n            (this.spraySystem.material as THREE.PointsMaterial).dispose();\r\n            this.spraySystem = null;\r\n            return;\r\n        }\r\n\r\n        const positions = this.spraySystem.geometry.attributes.position.array as Float32Array;\r\n        const particleCount = positions.length / 3;\r\n        \r\n        for (let i = 0; i < particleCount; i++) {\r\n            const i3 = i * 3;\r\n            positions[i3 + 2] -= 0.3;\r\n            if (positions[i3 + 2] < -10) {\r\n                positions[i3] = (Math.random() - 0.5) * 0.05;\r\n                positions[i3 + 1] = (Math.random() - 0.5) * 0.05;\r\n                positions[i3 + 2] = 0;\r\n            }\r\n            positions[i3] *= 0.99;\r\n            positions[i3 + 1] *= 0.99;\r\n        }\r\n        this.spraySystem.geometry.attributes.position.needsUpdate = true;\r\n    }\r\n\r\n    private updateCameras(): void {\r\n        if (!this.drone) return;\r\n        if (this.cameraMode === 'fpv') {\r\n            const dronePosition = new THREE.Vector3();\r\n            this.drone.getWorldPosition(dronePosition);\r\n            this.fpvCamera.position.copy(dronePosition);\r\n            const offset = new THREE.Vector3(-0.15, 0.20, 0.15);\r\n            offset.applyQuaternion(this.drone.quaternion);\r\n            this.fpvCamera.position.add(offset);\r\n            this.fpvCamera.rotation.set(0, this.drone.rotation.y + Math.PI, 0);\r\n        }\r\n        if (this.cameraMode === 'follow') {\r\n            const dronePosition = new THREE.Vector3();\r\n            this.drone.getWorldPosition(dronePosition);\r\n            const offset = new THREE.Vector3(0, 1.5, -2);\r\n            offset.applyQuaternion(this.drone.quaternion);\r\n            this.followCamera.position.copy(dronePosition).add(offset);\r\n            const forward = new THREE.Vector3(0, 0, 1);\r\n            forward.applyQuaternion(this.drone.quaternion);\r\n            const target = dronePosition.clone().add(forward);\r\n            this.followCamera.lookAt(target);\r\n        }\r\n    }\r\n\r\n    // Added missing checkCollisions method.\r\n    private checkCollisions(): void {\r\n        if (!this.drone) return;\r\n        const dronePosition = new THREE.Vector3();\r\n        this.drone.getWorldPosition(dronePosition);\r\n        const droneSphere = new THREE.Sphere(dronePosition, 0.5);\r\n        for (const building of this.buildings) {\r\n            const buildingMesh = building.getMesh();\r\n            const buildingBox = new THREE.Box3().setFromObject(buildingMesh);\r\n            if (buildingBox.intersectsSphere(droneSphere)) {\r\n                this.showCollisionWarning();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private animate(): void {\r\n        requestAnimationFrame(this.animate.bind(this));\r\n        \r\n        if (!this.gameStarted) {\r\n            // Just render the scene with the start screen\r\n            this.renderer.render(this.scene, this.camera);\r\n            return;\r\n        }\r\n\r\n        const currentTime = performance.now();\r\n        const delta = (currentTime - this.lastFrameTime) / 1000;\r\n        this.lastFrameTime = currentTime;\r\n        \r\n        // Animate propellers.\r\n        if (this.propellers.length > 0) {\r\n            this.propellers.forEach((propeller, index) => {\r\n                const direction = index % 2 === 0 ? 1 : -1;\r\n                propeller.rotation.y += this.propellerSpeed * direction;\r\n            });\r\n        }\r\n        \r\n        // Update systems.\r\n        this.updateDroneMovement(delta);\r\n        if (this.spraySystem) {\r\n            this.updateSpraySystem();\r\n        }\r\n        this.updateCameras();\r\n        this.checkCollisions();\r\n        this.checkLogoCollection();\r\n        \r\n        // Animate logos (rotate and float).\r\n        this.logos.forEach(logo => {\r\n            if (!logo.userData.collected) {\r\n                logo.quaternion.copy(this.activeCamera.quaternion);\r\n                logo.rotateZ(logo.userData.rotationSpeed);\r\n                const floatOffset = Math.sin(currentTime * 0.002) * 0.5;\r\n                logo.position.y = logo.userData.initialY + floatOffset;\r\n            }\r\n        });\r\n        \r\n        this.controls.update();\r\n        this.renderer.render(this.scene, this.activeCamera);\r\n    }\r\n\r\n    private clean(): void {\r\n        if (!this.drone || !this.isSprayOn) return;\r\n        this.buildings.forEach(building => {\r\n            const buildingPos = building.getMesh().position;\r\n            const dronePos = this.drone!.position;\r\n            const distance = new THREE.Vector3(buildingPos.x, buildingPos.y, buildingPos.z).distanceTo(dronePos);\r\n            if (distance < this.cleaningRadius) {\r\n                building.clean(this.cleaningPower);\r\n            }\r\n        });\r\n    }\r\n\r\n    private toggleCamera(): void {\r\n        switch (this.cameraMode) {\r\n            case 'orbit':\r\n                this.cameraMode = 'fpv';\r\n                this.activeCamera = this.fpvCamera;\r\n                this.controls.enabled = false;\r\n                break;\r\n            case 'fpv':\r\n                this.cameraMode = 'follow';\r\n                this.activeCamera = this.followCamera;\r\n                this.controls.enabled = false;\r\n                break;\r\n            case 'follow':\r\n                this.cameraMode = 'orbit';\r\n                this.activeCamera = this.camera;\r\n                this.controls.enabled = true;\r\n                break;\r\n        }\r\n    }\r\n\r\n    private createWarningPopup(): void {\r\n        if (!document.getElementById('warning-popup')) {\r\n            const warningElement = document.createElement('div');\r\n            warningElement.id = 'warning-popup';\r\n            warningElement.style.position = 'fixed';\r\n            warningElement.style.top = '50%';\r\n            warningElement.style.left = '50%';\r\n            warningElement.style.transform = 'translate(-50%, -50%)';\r\n            warningElement.style.backgroundColor = 'rgba(255, 200, 200, 0.95)';\r\n            warningElement.style.padding = '20px';\r\n            warningElement.style.borderRadius = '10px';\r\n            warningElement.style.boxShadow = '0 0 10px rgba(0,0,0,0.5)';\r\n            warningElement.style.display = 'none';\r\n            warningElement.style.zIndex = '1000';\r\n            warningElement.style.fontFamily = 'Arial, sans-serif';\r\n            warningElement.style.fontSize = '16px';\r\n            warningElement.style.color = '#333';\r\n            warningElement.style.border = '2px solid #ff6b6b';\r\n            warningElement.style.maxWidth = '400px';\r\n            warningElement.style.textAlign = 'center';\r\n            document.body.appendChild(warningElement);\r\n        }\r\n    }\r\n\r\n    private showCollisionWarning(): void {\r\n        const warningElement = document.getElementById('warning-popup');\r\n        if (warningElement && warningElement.style.display !== 'block') {\r\n            warningElement.textContent = \"The Sherpa drone is built with a forward facing collision radar to prevent the drone from drifting into buildings\";\r\n            warningElement.style.display = 'block';\r\n            if (this.warningTimeout !== null) {\r\n                window.clearTimeout(this.warningTimeout);\r\n            }\r\n            this.warningTimeout = window.setTimeout(() => {\r\n                if (warningElement) {\r\n                    warningElement.style.display = 'none';\r\n                }\r\n                this.warningTimeout = null;\r\n            }, 3000);\r\n        }\r\n    }\r\n\r\n    // New coin collection: check if any spray particle hits a coin.\r\n    private checkLogoCollection(): void {\r\n        if (!this.drone || !this.spraySystem || !this.isSprayOn || this.hasWon) return;\r\n\r\n        const sprayContainer = this.spraySystem.parent;\r\n        if (!sprayContainer) return;\r\n        sprayContainer.updateMatrixWorld();\r\n        const matrixWorld = sprayContainer.matrixWorld;\r\n\r\n        const positions = this.spraySystem.geometry.attributes.position.array as Float32Array;\r\n        const particleCount = positions.length / 3;\r\n        const collisionThreshold = 0.5;\r\n\r\n        this.logos.forEach((logo) => {\r\n            if (!logo.userData.collected) {\r\n                const coinPos = logo.position.clone();\r\n                for (let i = 0; i < particleCount; i++) {\r\n                    const i3 = i * 3;\r\n                    const localParticlePos = new THREE.Vector3(\r\n                        positions[i3],\r\n                        positions[i3 + 1],\r\n                        positions[i3 + 2]\r\n                    );\r\n                    const worldParticlePos = localParticlePos.applyMatrix4(matrixWorld);\r\n                    if (worldParticlePos.distanceTo(coinPos) < collisionThreshold) {\r\n                        logo.userData.collected = true;\r\n                        this.scene.remove(logo);\r\n                        logo.geometry.dispose();\r\n                        if (logo.material instanceof THREE.Material) {\r\n                            logo.material.dispose();\r\n                        }\r\n                        this.score++;\r\n                        this.playCollectionEffect(logo.position.clone());\r\n                        this.updateScoreDisplay();\r\n                        \r\n                        // Show learning popup in learning mode\r\n                        if (this.gameMode === 'learning' && logo.userData.info) {\r\n                            this.showLearningPopup(logo.userData.info);\r\n                        }\r\n                        \r\n                        if (this.score >= 5) {\r\n                            this.showWinMessage();\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private playCollectionEffect(position: THREE.Vector3): void {\r\n        const sparkleCount = 50;\r\n        const sparkleGeometry = new THREE.BufferGeometry();\r\n        const sparklePositions = new Float32Array(sparkleCount * 3);\r\n        const sparkleVelocities: THREE.Vector3[] = [];\r\n\r\n        for (let i = 0; i < sparkleCount; i++) {\r\n            const i3 = i * 3;\r\n            sparklePositions[i3] = position.x;\r\n            sparklePositions[i3 + 1] = position.y;\r\n            sparklePositions[i3 + 2] = position.z;\r\n            sparkleVelocities.push(new THREE.Vector3(\r\n                (Math.random() - 0.5) * 2,\r\n                Math.random() * 2,\r\n                (Math.random() - 0.5) * 2\r\n            ));\r\n        }\r\n        sparkleGeometry.setAttribute('position', new THREE.BufferAttribute(sparklePositions, 3));\r\n        const sparkleMaterial = new THREE.PointsMaterial({\r\n            color: 0xffff00,\r\n            size: 0.1,\r\n            transparent: true,\r\n            opacity: 1,\r\n            blending: THREE.AdditiveBlending\r\n        });\r\n        const sparkles = new THREE.Points(sparkleGeometry, sparkleMaterial);\r\n        this.scene.add(sparkles);\r\n\r\n        let lifetime = 0;\r\n        const animateSparkles = () => {\r\n            if (lifetime > 1) {\r\n                this.scene.remove(sparkles);\r\n                sparkleGeometry.dispose();\r\n                sparkleMaterial.dispose();\r\n                return;\r\n            }\r\n            const positions = sparkleGeometry.attributes.position.array as Float32Array;\r\n            for (let i = 0; i < sparkleCount; i++) {\r\n                const i3 = i * 3;\r\n                positions[i3] += sparkleVelocities[i].x * 0.1;\r\n                positions[i3 + 1] += sparkleVelocities[i].y * 0.1;\r\n                positions[i3 + 2] += sparkleVelocities[i].z * 0.1;\r\n            }\r\n            sparkleGeometry.attributes.position.needsUpdate = true;\r\n            sparkleMaterial.opacity = 1 - lifetime;\r\n            lifetime += 0.05;\r\n            requestAnimationFrame(animateSparkles);\r\n        };\r\n        animateSparkles();\r\n    }\r\n\r\n    private updateScoreDisplay(): void {\r\n        const scoreElement = document.getElementById('score-display');\r\n        if (scoreElement) {\r\n            scoreElement.textContent = `Score: ${this.score}/5 Logos Collected!`;\r\n        }\r\n    }\r\n\r\n    private showWinMessage(): void {\r\n        this.hasWon = true;\r\n        const winElement = document.createElement('div');\r\n        winElement.style.position = 'fixed';\r\n        winElement.style.top = '50%';\r\n        winElement.style.left = '50%';\r\n        winElement.style.transform = 'translate(-50%, -50%)';\r\n        winElement.style.backgroundColor = '#00B4D8'; // Lucid Bots blue\r\n        winElement.style.padding = '30px';\r\n        winElement.style.borderRadius = '15px';\r\n        winElement.style.color = 'white';\r\n        winElement.style.fontSize = '24px';\r\n        winElement.style.fontWeight = 'bold';\r\n        winElement.style.textAlign = 'center';\r\n        winElement.style.zIndex = '1000';\r\n        winElement.style.maxWidth = '500px';\r\n\r\n        // Add logo image at the top\r\n        const logoImg = document.createElement('img');\r\n        logoImg.src = import.meta.env.BASE_URL + 'logo.png';\r\n        logoImg.style.width = '120px';\r\n        logoImg.style.marginBottom = '20px';\r\n        winElement.appendChild(logoImg);\r\n\r\n        // Create message container\r\n        const messageDiv = document.createElement('div');\r\n        messageDiv.style.marginBottom = '20px';\r\n        \r\n        let message = 'Congratulations! You\\'ve collected all logos!';\r\n        if (this.gameMode === 'speed') {\r\n            const timerElement = document.getElementById('timer');\r\n            const finalTime = timerElement ? timerElement.textContent?.replace('Time: ', '') : '0:00';\r\n            message += `\\nYour time: ${finalTime}`;\r\n        } else if (this.gameMode === 'learning') {\r\n            // Add the final learning message\r\n            message += '\\n\\nRemember:';\r\n            messageDiv.innerHTML = message + '<br><br>' + \r\n                '\"We believe in responsible robotics, paving the way to better lives for everyone.';\r\n        }\r\n        \r\n        messageDiv.style.lineHeight = '1.4';\r\n        if (this.gameMode === 'speed') {\r\n            messageDiv.textContent = message;\r\n        }\r\n        winElement.appendChild(messageDiv);\r\n\r\n        // Add website link\r\n        const linkDiv = document.createElement('div');\r\n        linkDiv.style.fontSize = '18px';\r\n        linkDiv.style.marginTop = '20px';\r\n        const link = document.createElement('a');\r\n        link.href = 'https://lucidbots.com';\r\n        link.textContent = 'Visit lucidbots.com to learn more!';\r\n        link.style.color = 'white';\r\n        link.style.textDecoration = 'underline';\r\n        link.target = '_blank';\r\n        linkDiv.appendChild(link);\r\n        winElement.appendChild(linkDiv);\r\n\r\n        // Add \"Play Again\" button\r\n        const playAgainButton = document.createElement('button');\r\n        playAgainButton.textContent = 'Play Again';\r\n        playAgainButton.style.marginTop = '20px';\r\n        playAgainButton.style.padding = '10px 20px';\r\n        playAgainButton.style.fontSize = '18px';\r\n        playAgainButton.style.borderRadius = '5px';\r\n        playAgainButton.style.border = 'none';\r\n        playAgainButton.style.backgroundColor = 'white';\r\n        playAgainButton.style.color = '#00B4D8';\r\n        playAgainButton.style.cursor = 'pointer';\r\n        playAgainButton.style.transition = 'transform 0.2s';\r\n        playAgainButton.onmouseover = () => playAgainButton.style.transform = 'scale(1.05)';\r\n        playAgainButton.onmouseout = () => playAgainButton.style.transform = 'scale(1)';\r\n        playAgainButton.onclick = () => window.location.reload();\r\n        winElement.appendChild(playAgainButton);\r\n\r\n        document.body.appendChild(winElement);\r\n\r\n        setTimeout(() => {\r\n            document.body.removeChild(winElement);\r\n        }, 10000);\r\n    }\r\n\r\n    // Create a coin (logo) with glow effect.\r\n    private createLogo(): THREE.Mesh {\r\n        const logoGeometry = new THREE.CircleGeometry(1.5, 32);\r\n        const textureLoader = new THREE.TextureLoader();\r\n        const logoTexture = textureLoader.load(import.meta.env.BASE_URL + 'logo.png');\r\n        logoTexture.minFilter = THREE.LinearFilter;\r\n        logoTexture.magFilter = THREE.LinearFilter;\r\n        \r\n        const logoMaterial = new THREE.MeshStandardMaterial({\r\n            map: logoTexture,\r\n            side: THREE.DoubleSide,\r\n            transparent: true,\r\n            opacity: 1,\r\n            emissive: 0xffffff,\r\n            emissiveMap: logoTexture,\r\n            emissiveIntensity: 0.8\r\n        });\r\n        \r\n        const logo = new THREE.Mesh(logoGeometry, logoMaterial);\r\n        const logoLight = new THREE.PointLight(0xffffff, 1, 5);\r\n        logoLight.position.set(0, 0, 0.1);\r\n        logo.add(logoLight);\r\n        const backLight = new THREE.PointLight(0xffffff, 1, 5);\r\n        backLight.position.set(0, 0, -0.1);\r\n        logo.add(backLight);\r\n        \r\n        logo.userData = { \r\n            collected: false,\r\n            initialY: 0,\r\n            rotationSpeed: 0.02\r\n        };\r\n        return logo;\r\n    }\r\n\r\n    private addLogos(): void {\r\n        const house = this.buildings[0];\r\n        const church = this.buildings[1];\r\n        const tank = this.buildings[2];\r\n        const highrise = this.buildings[3];\r\n        const waterTower = this.buildings[4];\r\n\r\n        const logoPositions = [\r\n            // Lower the house logo position for better visibility\r\n            { building: house, offsetY: 18, offsetX: 0, offsetZ: 0, info: \"Lucid Bots Inc. is an AI robotics company that builds productive and responsible robots for the exterior cleaning, concrete, and construction industries.\" },\r\n            // Church steeple\r\n            { building: church, offsetY: 25, offsetX: 0, offsetZ: 0, info: \"Our drones use advanced AI to learn and navigate complex environments safely.\" },\r\n            // Above silo\r\n            { building: tank, offsetY: 16, offsetX: 0, offsetZ: 0, info: \"Lucid Bots' Sherpa drone could clean any of these buildings in reality as well!\" },\r\n            // Highrise\r\n            { building: highrise, offsetY: 30, offsetX: 0, offsetZ: 4, info: \"Our mission at Lucid Bots is to elevate efficiency, safety, and humanity by creating the world's most productive drones.\" },\r\n            // Water tower\r\n            { building: waterTower, offsetY: 22, offsetX: 0, offsetZ: 0, info: \"We also have a surface cleaning robot, known as the Lavobot\" }\r\n        ];\r\n\r\n        logoPositions.forEach(({ building, offsetY, offsetX, offsetZ, info }) => {\r\n            const buildingPos = building.getMesh().position;\r\n            const logo = this.createLogo();\r\n            logo.position.set(\r\n                buildingPos.x + offsetX,\r\n                buildingPos.y + offsetY,\r\n                buildingPos.z + offsetZ\r\n            );\r\n            logo.userData.initialY = buildingPos.y + offsetY;\r\n            logo.userData.info = info; // Store the info message\r\n            this.logos.push(logo);\r\n            this.scene.add(logo);\r\n        });\r\n    }\r\n\r\n    private showLearningPopup(info: string): void {\r\n        const popupElement = document.createElement('div');\r\n        popupElement.style.position = 'fixed';\r\n        popupElement.style.top = '50%';\r\n        popupElement.style.left = '50%';\r\n        popupElement.style.transform = 'translate(-50%, -50%)';\r\n        popupElement.style.backgroundColor = 'rgba(0, 180, 216, 0.95)'; // Lucid Bots blue\r\n        popupElement.style.padding = '20px';\r\n        popupElement.style.borderRadius = '10px';\r\n        popupElement.style.boxShadow = '0 0 20px rgba(0,0,0,0.3)';\r\n        popupElement.style.color = 'white';\r\n        popupElement.style.fontSize = '18px';\r\n        popupElement.style.fontFamily = 'Arial, sans-serif';\r\n        popupElement.style.textAlign = 'center';\r\n        popupElement.style.maxWidth = '400px';\r\n        popupElement.style.zIndex = '1000';\r\n        popupElement.style.animation = 'fadeIn 0.3s ease-in-out';\r\n\r\n        // Add CSS animation\r\n        const style = document.createElement('style');\r\n        style.textContent = `\r\n            @keyframes fadeIn {\r\n                from { opacity: 0; transform: translate(-50%, -60%); }\r\n                to { opacity: 1; transform: translate(-50%, -50%); }\r\n            }\r\n        `;\r\n        document.head.appendChild(style);\r\n\r\n        // Add logo image\r\n        const logoImg = document.createElement('img');\r\n        logoImg.src = import.meta.env.BASE_URL + 'logo.png';\r\n        logoImg.style.width = '100px';\r\n        logoImg.style.marginBottom = '15px';\r\n        popupElement.appendChild(logoImg);\r\n\r\n        // Add info text\r\n        const textElement = document.createElement('p');\r\n        textElement.textContent = info;\r\n        textElement.style.margin = '0';\r\n        textElement.style.lineHeight = '1.5';\r\n        popupElement.appendChild(textElement);\r\n\r\n        // Add continue button\r\n        const button = document.createElement('button');\r\n        button.textContent = 'Continue';\r\n        button.style.marginTop = '15px';\r\n        button.style.padding = '8px 20px';\r\n        button.style.fontSize = '16px';\r\n        button.style.backgroundColor = 'white';\r\n        button.style.color = '#00B4D8';\r\n        button.style.border = 'none';\r\n        button.style.borderRadius = '5px';\r\n        button.style.cursor = 'pointer';\r\n        button.style.transition = 'transform 0.2s';\r\n        button.onmouseover = () => button.style.transform = 'scale(1.05)';\r\n        button.onmouseout = () => button.style.transform = 'scale(1)';\r\n        button.onclick = () => document.body.removeChild(popupElement);\r\n        popupElement.appendChild(button);\r\n\r\n        document.body.appendChild(popupElement);\r\n    }\r\n}\r\n\r\n// Start the game\r\nnew Game();"],"names":["toTrianglesDrawMode","geometry","drawMode","TrianglesDrawMode","console","warn","TriangleFanDrawMode","TriangleStripDrawMode","index","getIndex","indices","position","getAttribute","undefined","error","i","count","push","setIndex","numberOfTriangles","newIndices","getX","length","newGeometry","clone","clearGroups","GLTFLoader","_Loader","manager","_this","_classCallCheck","this","_callSuper","dracoLoader","ktx2Loader","meshoptDecoder","pluginCallbacks","register","parser","GLTFMaterialsClearcoatExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","_inherits","_createClass","key","value","url","onLoad","onProgress","onError","resourcePath","scope","path","relativeUrl","LoaderUtils","extractUrlBase","resolveURL","itemStart","_onError","e","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","data","parse","gltf","Error","callback","indexOf","splice","json","extensions","plugins","textDecoder","TextDecoder","JSON","ArrayBuffer","decode","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","content","asset","version","GLTFParser","crossOrigin","fileLoader","plugin","name","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","Promise","resolve","reject","Loader","GLTFRegistry","objects","get","add","object","remove","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_IOR","KHR_MATERIALS_SHEEN","KHR_MATERIALS_SPECULAR","KHR_MATERIALS_TRANSMISSION","KHR_MATERIALS_IRIDESCENCE","KHR_MATERIALS_ANISOTROPY","KHR_MATERIALS_VOLUME","KHR_TEXTURE_BASISU","KHR_MATERIALS_EMISSIVE_STRENGTH","EXT_MATERIALS_BUMP","EXT_TEXTURE_WEBP","EXT_TEXTURE_AVIF","EXT_MESHOPT_COMPRESSION","EXT_MESH_GPU_INSTANCING","cache","refs","uses","nodeDefs","nodes","nodeIndex","nodeLength","nodeDef","light","_addNodeRef","lightIndex","cacheKey","dependency","lightNode","lightDef","lights","color","Color","setRGB","LinearSRGBColorSpace","range","type","DirectionalLight","target","set","PointLight","distance","SpotLight","spot","innerConeAngle","outerConeAngle","Math","PI","angle","penumbra","decay","assignExtrasToUserData","intensity","createUniqueName","_loadLight","self","then","_getNodeRef","MeshBasicMaterial","materialParams","materialDef","pending","opacity","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","assignTexture","SRGBColorSpace","all","materialIndex","materials","emissiveStrength","emissiveIntensity","MeshPhysicalMaterial","extension","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","scale","clearcoatNormalScale","Vector2","iridescenceFactor","iridescence","iridescenceTexture","iridescenceIor","iridescenceIOR","iridescenceThicknessRange","iridescenceThicknessMinimum","iridescenceThicknessMaximum","iridescenceThicknessTexture","sheenColor","sheenRoughness","sheen","sheenColorFactor","colorFactor","sheenRoughnessFactor","sheenColorTexture","sheenRoughnessTexture","transmissionFactor","transmission","transmissionTexture","thickness","thicknessFactor","thicknessTexture","attenuationDistance","Infinity","colorArray","attenuationColor","ior","specularIntensity","specularFactor","specularTexture","specularColorFactor","specularColor","specularColorTexture","bumpScale","bumpFactor","bumpTexture","anisotropyStrength","anisotropy","anisotropyRotation","anisotropyTexture","textureIndex","textureDef","textures","options","loadTextureImage","source","isSupported","images","textureLoader","uri","handler","getHandler","detectSupport","loadTexture","image","Image","src","onload","onerror","height","bufferView","bufferViews","extensionDef","buffer","getDependency","decoder","supported","res","byteOffset","byteLength","stride","byteStride","decodeGltfBufferAsync","mode","filter","ready","result","decodeGltfBuffer","_this2","mesh","_step4","_iterator4","_createForOfIteratorHelper","meshes","primitives","s","n","done","primitive","WEBGL_CONSTANTS","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","err","f","attributesDef","attributes","_loop","accessor","createNodeMesh","results","_step5","nodeObject","pop","isGroup","children","instancedMeshes","_iterator5","m","Matrix4","p","Vector3","q","Quaternion","instancedMesh","InstancedMesh","material","TRANSLATION","fromBufferAttribute","ROTATION","SCALE","setMatrixAt","compose","attributeName","attr","instanceColor","InstancedBufferAttribute","itemSize","normalized","setAttribute","Object3D","prototype","copy","call","assignFinalMaterial","clear","apply","BINARY_EXTENSION_CHUNK_TYPES","body","headerView","DataView","header","magic","slice","getUint32","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","decodeDracoFile","attribute","texture","transform","texCoord","channel","offset","rotation","fromArray","repeat","needsUpdate","GLTFCubicSplineInterpolant","_Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","values","valueSize","i1","t0","t","t1","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","Interpolant","_q","GLTFCubicSplineQuaternionInterpolant","_GLTFCubicSplineInter","arguments","_superPropGet","normalize","toArray","FLOAT","FLOAT_MAT3","FLOAT_MAT4","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","LINEAR","REPEAT","SAMPLER_2D","POINTS","LINES","LINE_LOOP","LINE_STRIP","UNSIGNED_BYTE","UNSIGNED_SHORT","Int8Array","Int16Array","Uint16Array","Uint32Array","Float32Array","WEBGL_FILTERS","NearestFilter","LinearFilter","NearestMipmapNearestFilter","LinearMipmapNearestFilter","NearestMipmapLinearFilter","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","TEXCOORD_2","TEXCOORD_3","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","gltfDef","extras","Object","assign","updateMorphTargets","meshDef","il","morphTargetInfluences","targetNames","morphTargetDictionary","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","targets","attributesKey","keys","sort","getNormalizedComponentScale","constructor","_identityMatrix","associations","Map","primitiveCache","nodeCache","meshCache","cameraCache","lightCache","sourceCache","textureCache","nodeNamesUsed","isSafari","isFirefox","firefoxVersion","navigator","test","userAgent","match","createImageBitmap","TextureLoader","ImageBitmapLoader","setCrossOrigin","_invokeAll","ext","_markDefs","beforeRoot","getDependencies","dependencies","scene","scenes","animations","cameras","afterRoot","catch","skinDefs","skins","meshDefs","skinIndex","skinLength","joints","isBone","skin","isSkinnedMesh","camera","_this3","ref","updateMappings","original","mappings","_step6","_iterator6","entries","_step6$value","_slicedToArray","child","func","unshift","loadScene","_invokeOne","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","map","def","bufferIndex","bufferDef","buffers","bufferViewDef","accessorIndex","sparse","TypedArray","BufferAttribute","pendingBufferViews","bufferAttribute","elementBytes","BYTES_PER_ELEMENT","itemBytes","ibSlice","floor","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setX","setY","setZ","setW","sourceIndex","sourceDef","sampler","promise","loadImageSource","flipY","startsWith","samplers","magFilter","minFilter","wrapS","wrapT","URL","webkitURL","sourceURI","isObjectURL","blob","Blob","mimeType","createObjectURL","isImageBitmapLoader","imageBitmap","Texture","revokeObjectURL","search","mapName","mapDef","colorSpace","gltfReference","extendTexture","useDerivativeTangents","tangent","useVertexColors","useFlatShading","normal","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","LineBasicMaterial","cachedMaterial","vertexColors","flatShading","normalScale","y","MeshStandardMaterial","materialType","kmuExtension","getMaterialType","extendParams","metalness","metallicFactor","roughness","roughnessFactor","metallicRoughnessTexture","extendMaterialParams","doubleSided","side","DoubleSide","alphaMode","transparent","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","aoMapIntensity","emissiveFactor","emissive","emissiveTexture","originalName","sanitizedName","PropertyBinding","sanitizeNodeName","createDracoPrimitive","decodePrimitive","addPrimitiveAttributes","cached","geometryPromise","BufferGeometry","meshIndex","depthTest","FrontSide","loadGeometries","geometries","SkinnedMesh","Mesh","normalizeSkinWeights","LineSegments","Line","LineLoop","Points","morphAttributes","group","Group","cameraIndex","cameraDef","params","PerspectiveCamera","MathUtils","radToDeg","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","_loadNodeShallow","inverseBindMatrices","jointNodes","bones","boneInverses","jointNode","mat","Skeleton","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","node","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","updateMatrix","createdTracks","_createAnimationTracks","k","AnimationClip","traverse","o","isMesh","nodePending","childPending","childrenDef","skeletonPending","skeleton","bind","nodeName","meshPromise","createNodeAttachment","forEach","Bone","matrix","applyMatrix4","quaternion","has","sceneIndex","sceneDef","nodeIds","_step7","reducedAssociations","_iterator7","_step7$value","reduceAssociations","TypedKeyframeTrack","targetName","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","interpolation","outputArray","_getArrayFromAccessor","j","jl","track","_createCubicSplineTrackInterpolant","scaled","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","assignAttributeAccessor","gltfAttributeName","ColorManagement","workingColorSpace","box","Box3","min","max","boxScale","multiplyScalar","maxDisplacement","vector","abs","expandByVector","boundingBox","sphere","Sphere","getCenter","center","radius","distanceTo","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","hasMorphColor","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","morphPositions","morphNormals","morphColors","morphTargetsRelative","addMorphTargets","_taskCache","WeakMap","DRACOLoader","_Loader2","_this4","decoderPath","decoderConfig","decoderBinary","decoderPending","workerLimit","workerPool","workerNextTaskID","workerSourceURL","defaultAttributeIDs","uv","defaultAttributeTypes","config","_this5","attributeIDs","attributeTypes","vertexColorSpace","taskConfig","useUniqueIDs","decodeGeometry","_this6","worker","taskKey","stringify","cachedTask","taskID","taskCost","geometryPending","_getWorker","_worker","_callbacks","postMessage","id","message","_createGeometry","_releaseTask","geometryData","_assignVertexColorSpace","inputColorSpace","_color","convertSRGBToLinear","setXYZ","r","g","b","responseType","_initDecoder","_this7","useJS","WebAssembly","librariesPending","_loadLibrary","libraries","jsContent","wasmBinary","fn","DRACOWorker","toString","substring","lastIndexOf","join","_this8","Worker","_taskCosts","_taskLoad","onmessage","a","log","terminate","decodeAttribute","draco","dracoGeometry","attributeType","numComponents","num_components","numValues","num_points","dataType","DT_FLOAT32","DT_INT8","DT_INT16","Int32Array","DT_INT32","DT_UINT8","DT_UINT16","DT_UINT32","getDracoDataType","ptr","_malloc","GetAttributeDataArrayForAllPoints","HEAPF32","_free","onModuleLoaded","DracoDecoderModule","module","Decoder","decodingStatus","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","DecodeArrayToMesh","POINT_CLOUD","PointCloud","DecodeArrayToPointCloud","ok","error_msg","attributeID","GetAttributeByUniqueId","GetAttributeId","GetAttribute","attributeResult","numFaces","num_faces","numIndices","GetTrianglesUInt32Array","decodeIndex","destroy","_changeEvent","_startEvent","_endEvent","_ray","Ray","_plane","Plane","TILT_LIMIT","cos","DEG2RAD","OrbitControls","_EventDispatcher","domElement","_this9","quat","quatInverse","lastPosition","lastQuaternion","lastTargetPosition","twoPI","style","touchAction","enabled","cursor","minDistance","maxDistance","minZoom","maxZoom","minTargetRadius","maxTargetRadius","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","zoomToCursor","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TOUCH","TWO","DOLLY_PAN","target0","position0","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","getDistance","listenToKeyEvents","addEventListener","onKeyDown","stopListenToKeyEvents","removeEventListener","saveState","reset","updateProjectionMatrix","dispatchEvent","update","state","STATE","NONE","setFromUnitVectors","up","invert","deltaTime","sub","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","isFinite","makeSafe","addScaledVector","panOffset","clampLength","performCursorZoom","isOrthographicCamera","clampDistance","setFromSpherical","lookAt","zoomChanged","newRadius","isPerspectiveCamera","prevRadius","radiusDelta","dollyDirection","updateMatrixWorld","mouseBefore","mouse","x","unproject","mouseAfter","transformDirection","origin","direction","dot","setFromNormalAndCoplanarPoint","intersectPlane","distanceToSquared","EPS","dispose","onContextMenu","onPointerDown","onPointerUp","onMouseWheel","onPointerMove","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","pow","rotateUp","v","panLeft","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","targetDistance","tan","fov","clientHeight","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","updateMouseParameters","event","rect","getBoundingClientRect","clientX","clientY","w","width","h","dist","handleMouseDownRotate","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchMoveRotate","getSecondPointerPosition","subVectors","handleTouchMovePan","handleTouchMoveDolly","setPointerCapture","pointerId","addPointer","pointerType","trackPointer","DOLLY_ROTATE","onTouchStart","mouseAction","button","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","onMouseDown","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","onTouchMove","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","onMouseMove","removePointer","releasePointerCapture","preventDefault","handleMouseWheel","code","handleKeyDown","pointer","passive","EventDispatcher","Building","_defineProperty","amount","_this10","dirtyLevel","THREE","ResidentialBuilding","mansion","mainBody","BoxGeometry","MeshPhongMaterial","foundation","leftWing","rightWing","mainRoof","letterMaterial","vLeft","z","vRight","w1","w2","w3","w4","dStem","dCurve","CylinderGeometry","wingRoofGeometry","wingRoofMaterial","leftWingRoof","rightWingRoof","windowGeometry","windowMaterial","frameGeometry","frameMaterial","pos","frame","window","entrance","ChurchBuilding","church","steepleBase","steepleRoofGeometry","ConeGeometry","steepleRoof","crossVertical","crossHorizontal","cross","leftWindow","rightWindow","roseWindowGeometry","roseWindow","doorFrame","door","steps","roofGeometry","roof","IndustrialTank","silo","cylinderGeometry","siloBody","shininess","coneGeometry","cone","baseRingGeometry","TorusGeometry","baseRing","topRing","supportGeometry","support","detailGeometry","detail","sin","HighriseBuilding","building","bodyGeometry","bodyMaterial","glassGeometry","PlaneGeometry","glassMaterial","frontGlass","backGlass","leftGlass","rightGlass","divider","roofBase","roofDetail","entranceBase","entranceRoof","WaterTower","tower","tankGeometry","tankMaterial","tank","bottomCurveGeometry","SphereGeometry","bottomCurve","topCurveGeometry","topCurve","roofMaterial","centralColumnGeometry","supportMaterial","centralColumn","ring","braceGeometry","brace1","brace2","platformGeometry","platform","railingGeometry","railing","railSupport","sideRailGeometry","leftRail","rightRail","ladderHeight","ladderWidth","rung","Game","performance","now","Scene","background","innerWidth","innerHeight","fpvCamera","followCamera","activeCamera","renderer","WebGLRenderer","antialias","alpha","powerPreference","setSize","setPixelRatio","devicePixelRatio","shadowMap","PCFSoftShadowMap","outputColorSpace","toneMapping","ACESFilmicToneMapping","toneMappingExposure","document","appendChild","createStartScreen","controls","animate","startScreenContainer","createElement","backgroundColor","display","flexDirection","alignItems","justifyContent","zIndex","logo","marginBottom","buttonsContainer","gap","learningButton","createModeButton","speedButton","title","description","_this11","padding","borderRadius","textAlign","transition","titleElement","textContent","margin","fontFamily","descElement","onmouseover","onmouseout","onclick","startGame","gameMode","gameStarted","removeChild","setupLighting","setupControlsUI","loadDroneModel","addBuildings","addGround","addLogos","updateScoreDisplay","createWarningPopup","onWindowResize","onKeyUp","updateUIForGameMode","infoElement","getElementById","innerHTML","startSpeedModeTimer","_this12","startTime","Date","timerElement","updateTimer","hasWon","elapsed","minutes","seconds","padStart","requestAnimationFrame","ambientLight","AmbientLight","directionalLight","castShadow","shadow","mapSize","near","far","hemisphereLight","HemisphereLight","_this13","setDecoderPath","setDRACOLoader","droneHolder","droneModel","receiveShadow","includes","propellers","droneSpotLight","dronePointLight","drone","progress","percentComplete","round","loaded","total","fallbackCube","droneLight","house","createMesh","getMesh","buildings","highrise","waterTower","groundGeometry","groundMaterial","ground","aspect","keysPressed","isSprayOn","spraySystem","createSpraySystem","clean","toggleCamera","delta","moveX","moveZ","moveY","horizontalMovement","applyEuler","Euler","verticalMovement","newPosition","_step8","droneSphere","willCollide","_iterator8","buildingMesh","setFromObject","intersectsSphere","showCollisionWarning","particleCount","particles","particleGeometry","spriteMaterial","size","blending","AdditiveBlending","i3","random","sprayContainer","_this$drone","parent","positions","cameraMode","dronePosition","getWorldPosition","forward","_step9","_iterator9","_this14","currentTime","lastFrameTime","propeller","propellerSpeed","updateDroneMovement","updateSpraySystem","updateCameras","checkCollisions","checkLogoCollection","logos","collected","rotateZ","rotationSpeed","floatOffset","initialY","render","_this15","buildingPos","dronePos","cleaningRadius","cleaningPower","warningElement","boxShadow","fontSize","border","maxWidth","_this16","warningTimeout","clearTimeout","setTimeout","_this17","matrixWorld","coinPos","score","playCollectionEffect","info","showLearningPopup","showWinMessage","_this18","sparkleGeometry","sparklePositions","sparkleCount","sparkleVelocities","sparkleMaterial","sparkles","lifetime","animateSparkles","scoreElement","winElement","fontWeight","logoImg","messageDiv","_timerElement$textCon","replace","lineHeight","linkDiv","marginTop","link","href","textDecoration","playAgainButton","location","reload","logoGeometry","CircleGeometry","logoTexture","logoMaterial","emissiveMap","logoLight","backLight","_this19","offsetY","offsetX","offsetZ","_ref","createLogo","popupElement","animation","head","textElement"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}